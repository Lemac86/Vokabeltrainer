(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function Tu(t,e){const n=Object.create(null),s=t.split(",");for(let r=0;r<s.length;r++)n[s[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const ag="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ug=Tu(ag);function td(t){return!!t||t===""}function _u(t){if(U(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=Re(s)?hg(s):_u(s);if(r)for(const i in r)e[i]=r[i]}return e}else{if(Re(t))return t;if(De(t))return t}}const cg=/;(?![^(]*\))/g,lg=/:(.+)/;function hg(t){const e={};return t.split(cg).forEach(n=>{if(n){const s=n.split(lg);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Bs(t){let e="";if(Re(t))e=t;else if(U(t))for(let n=0;n<t.length;n++){const s=Bs(t[n]);s&&(e+=s+" ")}else if(De(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const $e=t=>Re(t)?t:t==null?"":U(t)||De(t)&&(t.toString===id||!J(t.toString))?JSON.stringify(t,nd,2):String(t),nd=(t,e)=>e&&e.__v_isRef?nd(t,e.value):_s(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r])=>(n[`${s} =>`]=r,n),{})}:sd(e)?{[`Set(${e.size})`]:[...e.values()]}:De(e)&&!U(e)&&!od(e)?String(e):e,fe={},Ts=[],xt=()=>{},dg=()=>!1,fg=/^on[^a-z]/,co=t=>fg.test(t),xu=t=>t.startsWith("onUpdate:"),He=Object.assign,Cu=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},pg=Object.prototype.hasOwnProperty,ne=(t,e)=>pg.call(t,e),U=Array.isArray,_s=t=>lo(t)==="[object Map]",sd=t=>lo(t)==="[object Set]",J=t=>typeof t=="function",Re=t=>typeof t=="string",Su=t=>typeof t=="symbol",De=t=>t!==null&&typeof t=="object",rd=t=>De(t)&&J(t.then)&&J(t.catch),id=Object.prototype.toString,lo=t=>id.call(t),mg=t=>lo(t).slice(8,-1),od=t=>lo(t)==="[object Object]",Du=t=>Re(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Ti=Tu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ho=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},gg=/-(\w)/g,Ns=ho(t=>t.replace(gg,(e,n)=>n?n.toUpperCase():"")),yg=/\B([A-Z])/g,$s=ho(t=>t.replace(yg,"-$1").toLowerCase()),ad=ho(t=>t.charAt(0).toUpperCase()+t.slice(1)),ra=ho(t=>t?`on${ad(t)}`:""),Er=(t,e)=>!Object.is(t,e),_i=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Pi=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},Fi=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Zc;const vg=()=>Zc||(Zc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Mt;class wg{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Mt&&(this.parent=Mt,this.index=(Mt.scopes||(Mt.scopes=[])).push(this)-1)}run(e){if(this.active){const n=Mt;try{return Mt=this,e()}finally{Mt=n}}}on(){Mt=this}off(){Mt=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function bg(t,e=Mt){e&&e.active&&e.effects.push(t)}const Au=t=>{const e=new Set(t);return e.w=0,e.n=0,e},ud=t=>(t.w&hn)>0,cd=t=>(t.n&hn)>0,Ig=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=hn},Eg=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const r=e[s];ud(r)&&!cd(r)?r.delete(t):e[n++]=r,r.w&=~hn,r.n&=~hn}e.length=n}},Ca=new WeakMap;let or=0,hn=1;const Sa=30;let Et;const Kn=Symbol(""),Da=Symbol("");class Nu{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,bg(this,s)}run(){if(!this.active)return this.fn();let e=Et,n=on;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Et,Et=this,on=!0,hn=1<<++or,or<=Sa?Ig(this):el(this),this.fn()}finally{or<=Sa&&Eg(this),hn=1<<--or,Et=this.parent,on=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Et===this?this.deferStop=!0:this.active&&(el(this),this.onStop&&this.onStop(),this.active=!1)}}function el(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let on=!0;const ld=[];function Us(){ld.push(on),on=!1}function qs(){const t=ld.pop();on=t===void 0?!0:t}function dt(t,e,n){if(on&&Et){let s=Ca.get(t);s||Ca.set(t,s=new Map);let r=s.get(n);r||s.set(n,r=Au()),hd(r)}}function hd(t,e){let n=!1;or<=Sa?cd(t)||(t.n|=hn,n=!ud(t)):n=!t.has(Et),n&&(t.add(Et),Et.deps.push(t))}function Kt(t,e,n,s,r,i){const o=Ca.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&U(t))o.forEach((u,c)=>{(c==="length"||c>=s)&&a.push(u)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":U(t)?Du(n)&&a.push(o.get("length")):(a.push(o.get(Kn)),_s(t)&&a.push(o.get(Da)));break;case"delete":U(t)||(a.push(o.get(Kn)),_s(t)&&a.push(o.get(Da)));break;case"set":_s(t)&&a.push(o.get(Kn));break}if(a.length===1)a[0]&&Aa(a[0]);else{const u=[];for(const c of a)c&&u.push(...c);Aa(Au(u))}}function Aa(t,e){const n=U(t)?t:[...t];for(const s of n)s.computed&&tl(s);for(const s of n)s.computed||tl(s)}function tl(t,e){(t!==Et||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const Tg=Tu("__proto__,__v_isRef,__isVue"),dd=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Su)),_g=ku(),xg=ku(!1,!0),Cg=ku(!0),nl=Sg();function Sg(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=oe(this);for(let i=0,o=this.length;i<o;i++)dt(s,"get",i+"");const r=s[e](...n);return r===-1||r===!1?s[e](...n.map(oe)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Us();const s=oe(this)[e].apply(this,n);return qs(),s}}),t}function ku(t=!1,e=!1){return function(s,r,i){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&i===(t?e?jg:yd:e?gd:md).get(s))return s;const o=U(s);if(!t&&o&&ne(nl,r))return Reflect.get(nl,r,i);const a=Reflect.get(s,r,i);return(Su(r)?dd.has(r):Tg(r))||(t||dt(s,"get",r),e)?a:je(a)?o&&Du(r)?a:a.value:De(a)?t?vd(a):Ru(a):a}}const Dg=fd(),Ag=fd(!0);function fd(t=!1){return function(n,s,r,i){let o=n[s];if(Tr(o)&&je(o)&&!je(r))return!1;if(!t&&!Tr(r)&&(Na(r)||(r=oe(r),o=oe(o)),!U(n)&&je(o)&&!je(r)))return o.value=r,!0;const a=U(n)&&Du(s)?Number(s)<n.length:ne(n,s),u=Reflect.set(n,s,r,i);return n===oe(i)&&(a?Er(r,o)&&Kt(n,"set",s,r):Kt(n,"add",s,r)),u}}function Ng(t,e){const n=ne(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&Kt(t,"delete",e,void 0),s}function kg(t,e){const n=Reflect.has(t,e);return(!Su(e)||!dd.has(e))&&dt(t,"has",e),n}function Mg(t){return dt(t,"iterate",U(t)?"length":Kn),Reflect.ownKeys(t)}const pd={get:_g,set:Dg,deleteProperty:Ng,has:kg,ownKeys:Mg},Og={get:Cg,set(t,e){return!0},deleteProperty(t,e){return!0}},Rg=He({},pd,{get:xg,set:Ag}),Mu=t=>t,fo=t=>Reflect.getPrototypeOf(t);function ui(t,e,n=!1,s=!1){t=t.__v_raw;const r=oe(t),i=oe(e);n||(e!==i&&dt(r,"get",e),dt(r,"get",i));const{has:o}=fo(r),a=s?Mu:n?Pu:_r;if(o.call(r,e))return a(t.get(e));if(o.call(r,i))return a(t.get(i));t!==r&&t.get(e)}function ci(t,e=!1){const n=this.__v_raw,s=oe(n),r=oe(t);return e||(t!==r&&dt(s,"has",t),dt(s,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function li(t,e=!1){return t=t.__v_raw,!e&&dt(oe(t),"iterate",Kn),Reflect.get(t,"size",t)}function sl(t){t=oe(t);const e=oe(this);return fo(e).has.call(e,t)||(e.add(t),Kt(e,"add",t,t)),this}function rl(t,e){e=oe(e);const n=oe(this),{has:s,get:r}=fo(n);let i=s.call(n,t);i||(t=oe(t),i=s.call(n,t));const o=r.call(n,t);return n.set(t,e),i?Er(e,o)&&Kt(n,"set",t,e):Kt(n,"add",t,e),this}function il(t){const e=oe(this),{has:n,get:s}=fo(e);let r=n.call(e,t);r||(t=oe(t),r=n.call(e,t)),s&&s.call(e,t);const i=e.delete(t);return r&&Kt(e,"delete",t,void 0),i}function ol(){const t=oe(this),e=t.size!==0,n=t.clear();return e&&Kt(t,"clear",void 0,void 0),n}function hi(t,e){return function(s,r){const i=this,o=i.__v_raw,a=oe(o),u=e?Mu:t?Pu:_r;return!t&&dt(a,"iterate",Kn),o.forEach((c,l)=>s.call(r,u(c),u(l),i))}}function di(t,e,n){return function(...s){const r=this.__v_raw,i=oe(r),o=_s(i),a=t==="entries"||t===Symbol.iterator&&o,u=t==="keys"&&o,c=r[t](...s),l=n?Mu:e?Pu:_r;return!e&&dt(i,"iterate",u?Da:Kn),{next(){const{value:h,done:f}=c.next();return f?{value:h,done:f}:{value:a?[l(h[0]),l(h[1])]:l(h),done:f}},[Symbol.iterator](){return this}}}}function Yt(t){return function(...e){return t==="delete"?!1:this}}function Lg(){const t={get(i){return ui(this,i)},get size(){return li(this)},has:ci,add:sl,set:rl,delete:il,clear:ol,forEach:hi(!1,!1)},e={get(i){return ui(this,i,!1,!0)},get size(){return li(this)},has:ci,add:sl,set:rl,delete:il,clear:ol,forEach:hi(!1,!0)},n={get(i){return ui(this,i,!0)},get size(){return li(this,!0)},has(i){return ci.call(this,i,!0)},add:Yt("add"),set:Yt("set"),delete:Yt("delete"),clear:Yt("clear"),forEach:hi(!0,!1)},s={get(i){return ui(this,i,!0,!0)},get size(){return li(this,!0)},has(i){return ci.call(this,i,!0)},add:Yt("add"),set:Yt("set"),delete:Yt("delete"),clear:Yt("clear"),forEach:hi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=di(i,!1,!1),n[i]=di(i,!0,!1),e[i]=di(i,!1,!0),s[i]=di(i,!0,!0)}),[t,n,e,s]}const[Pg,Fg,Vg,Bg]=Lg();function Ou(t,e){const n=e?t?Bg:Vg:t?Fg:Pg;return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(ne(n,r)&&r in s?n:s,r,i)}const $g={get:Ou(!1,!1)},Ug={get:Ou(!1,!0)},qg={get:Ou(!0,!1)},md=new WeakMap,gd=new WeakMap,yd=new WeakMap,jg=new WeakMap;function Kg(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Hg(t){return t.__v_skip||!Object.isExtensible(t)?0:Kg(mg(t))}function Ru(t){return Tr(t)?t:Lu(t,!1,pd,$g,md)}function Gg(t){return Lu(t,!1,Rg,Ug,gd)}function vd(t){return Lu(t,!0,Og,qg,yd)}function Lu(t,e,n,s,r){if(!De(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=r.get(t);if(i)return i;const o=Hg(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return r.set(t,a),a}function xs(t){return Tr(t)?xs(t.__v_raw):!!(t&&t.__v_isReactive)}function Tr(t){return!!(t&&t.__v_isReadonly)}function Na(t){return!!(t&&t.__v_isShallow)}function wd(t){return xs(t)||Tr(t)}function oe(t){const e=t&&t.__v_raw;return e?oe(e):t}function bd(t){return Pi(t,"__v_skip",!0),t}const _r=t=>De(t)?Ru(t):t,Pu=t=>De(t)?vd(t):t;function Id(t){on&&Et&&(t=oe(t),hd(t.dep||(t.dep=Au())))}function Ed(t,e){t=oe(t),t.dep&&Aa(t.dep)}function je(t){return!!(t&&t.__v_isRef===!0)}function ue(t){return zg(t,!1)}function zg(t,e){return je(t)?t:new Wg(t,e)}class Wg{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:oe(e),this._value=n?e:_r(e)}get value(){return Id(this),this._value}set value(e){e=this.__v_isShallow?e:oe(e),Er(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:_r(e),Ed(this))}}function j(t){return je(t)?t.value:t}const Qg={get:(t,e,n)=>j(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return je(r)&&!je(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function Td(t){return xs(t)?t:new Proxy(t,Qg)}function _d(t){const e=U(t)?new Array(t.length):{};for(const n in t)e[n]=Xg(t,n);return e}class Yg{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function Xg(t,e,n){const s=t[e];return je(s)?s:new Yg(t,e,n)}class Jg{constructor(e,n,s,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Nu(e,()=>{this._dirty||(this._dirty=!0,Ed(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=s}get value(){const e=oe(this);return Id(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function Kr(t,e,n=!1){let s,r;const i=J(t);return i?(s=t,r=xt):(s=t.get,r=t.set),new Jg(s,r,i||!r,n)}function an(t,e,n,s){let r;try{r=s?t(...s):t()}catch(i){po(i,e,n)}return r}function bt(t,e,n,s){if(J(t)){const i=an(t,e,n,s);return i&&rd(i)&&i.catch(o=>{po(o,e,n)}),i}const r=[];for(let i=0;i<t.length;i++)r.push(bt(t[i],e,n,s));return r}function po(t,e,n,s=!0){const r=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const c=i.ec;if(c){for(let l=0;l<c.length;l++)if(c[l](t,o,a)===!1)return}i=i.parent}const u=e.appContext.config.errorHandler;if(u){an(u,null,10,[t,o,a]);return}}Zg(t,n,r,s)}function Zg(t,e,n,s=!0){console.error(t)}let Vi=!1,ka=!1;const ot=[];let Ut=0;const fr=[];let ar=null,ys=0;const pr=[];let en=null,vs=0;const xd=Promise.resolve();let Fu=null,Ma=null;function ey(t){const e=Fu||xd;return t?e.then(this?t.bind(this):t):e}function ty(t){let e=Ut+1,n=ot.length;for(;e<n;){const s=e+n>>>1;xr(ot[s])<t?e=s+1:n=s}return e}function Cd(t){(!ot.length||!ot.includes(t,Vi&&t.allowRecurse?Ut+1:Ut))&&t!==Ma&&(t.id==null?ot.push(t):ot.splice(ty(t.id),0,t),Sd())}function Sd(){!Vi&&!ka&&(ka=!0,Fu=xd.then(Nd))}function ny(t){const e=ot.indexOf(t);e>Ut&&ot.splice(e,1)}function Dd(t,e,n,s){U(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&n.push(t),Sd()}function sy(t){Dd(t,ar,fr,ys)}function ry(t){Dd(t,en,pr,vs)}function mo(t,e=null){if(fr.length){for(Ma=e,ar=[...new Set(fr)],fr.length=0,ys=0;ys<ar.length;ys++)ar[ys]();ar=null,ys=0,Ma=null,mo(t,e)}}function Ad(t){if(mo(),pr.length){const e=[...new Set(pr)];if(pr.length=0,en){en.push(...e);return}for(en=e,en.sort((n,s)=>xr(n)-xr(s)),vs=0;vs<en.length;vs++)en[vs]();en=null,vs=0}}const xr=t=>t.id==null?1/0:t.id;function Nd(t){ka=!1,Vi=!0,mo(t),ot.sort((n,s)=>xr(n)-xr(s));const e=xt;try{for(Ut=0;Ut<ot.length;Ut++){const n=ot[Ut];n&&n.active!==!1&&an(n,null,14)}}finally{Ut=0,ot.length=0,Ad(),Vi=!1,Fu=null,(ot.length||fr.length||pr.length)&&Nd(t)}}function iy(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||fe;let r=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in s){const l=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:f}=s[l]||fe;f&&(r=n.map(m=>m.trim())),h&&(r=n.map(Fi))}let a,u=s[a=ra(e)]||s[a=ra(Ns(e))];!u&&i&&(u=s[a=ra($s(e))]),u&&bt(u,t,6,r);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,bt(c,t,6,r)}}function kd(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!J(t)){const u=c=>{const l=kd(c,e,!0);l&&(a=!0,He(o,l))};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}return!i&&!a?(s.set(t,null),null):(U(i)?i.forEach(u=>o[u]=null):He(o,i),s.set(t,o),o)}function go(t,e){return!t||!co(e)?!1:(e=e.slice(2).replace(/Once$/,""),ne(t,e[0].toLowerCase()+e.slice(1))||ne(t,$s(e))||ne(t,e))}let Tt=null,yo=null;function Bi(t){const e=Tt;return Tt=t,yo=t&&t.type.__scopeId||null,e}function yn(t){yo=t}function vn(){yo=null}function Md(t,e=Tt,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&gl(-1);const i=Bi(e),o=t(...r);return Bi(i),s._d&&gl(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function ia(t){const{type:e,vnode:n,proxy:s,withProxy:r,props:i,propsOptions:[o],slots:a,attrs:u,emit:c,render:l,renderCache:h,data:f,setupState:m,ctx:v,inheritAttrs:D}=t;let x,M;const W=Bi(t);try{if(n.shapeFlag&4){const Q=r||s;x=Ot(l.call(Q,Q,h,i,m,f,v)),M=u}else{const Q=e;x=Ot(Q.length>1?Q(i,{attrs:u,slots:a,emit:c}):Q(i,null)),M=e.props?u:oy(u)}}catch(Q){mr.length=0,po(Q,t,1),x=at(Ct)}let V=x;if(M&&D!==!1){const Q=Object.keys(M),{shapeFlag:ee}=V;Q.length&&ee&7&&(o&&Q.some(xu)&&(M=ay(M,o)),V=dn(V,M))}return n.dirs&&(V=dn(V),V.dirs=V.dirs?V.dirs.concat(n.dirs):n.dirs),n.transition&&(V.transition=n.transition),x=V,Bi(W),x}const oy=t=>{let e;for(const n in t)(n==="class"||n==="style"||co(n))&&((e||(e={}))[n]=t[n]);return e},ay=(t,e)=>{const n={};for(const s in t)(!xu(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function uy(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:u}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&u>=0){if(u&1024)return!0;if(u&16)return s?al(s,o,c):!!o;if(u&8){const l=e.dynamicProps;for(let h=0;h<l.length;h++){const f=l[h];if(o[f]!==s[f]&&!go(c,f))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?al(s,o,c):!0:!!o;return!1}function al(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!go(n,i))return!0}return!1}function cy({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const ly=t=>t.__isSuspense;function hy(t,e){e&&e.pendingBranch?U(t)?e.effects.push(...t):e.effects.push(t):ry(t)}function dy(t,e){if(qe){let n=qe.provides;const s=qe.parent&&qe.parent.provides;s===n&&(n=qe.provides=Object.create(s)),n[t]=e}}function oa(t,e,n=!1){const s=qe||Tt;if(s){const r=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&J(e)?e.call(s.proxy):e}}const ul={};function aa(t,e,n){return Od(t,e,n)}function Od(t,e,{immediate:n,deep:s,flush:r,onTrack:i,onTrigger:o}=fe){const a=qe;let u,c=!1,l=!1;if(je(t)?(u=()=>t.value,c=Na(t)):xs(t)?(u=()=>t,s=!0):U(t)?(l=!0,c=t.some(M=>xs(M)||Na(M)),u=()=>t.map(M=>{if(je(M))return M.value;if(xs(M))return Bn(M);if(J(M))return an(M,a,2)})):J(t)?e?u=()=>an(t,a,2):u=()=>{if(!(a&&a.isUnmounted))return h&&h(),bt(t,a,3,[f])}:u=xt,e&&s){const M=u;u=()=>Bn(M())}let h,f=M=>{h=x.onStop=()=>{an(M,a,4)}};if(Sr)return f=xt,e?n&&bt(e,a,3,[u(),l?[]:void 0,f]):u(),xt;let m=l?[]:ul;const v=()=>{if(!!x.active)if(e){const M=x.run();(s||c||(l?M.some((W,V)=>Er(W,m[V])):Er(M,m)))&&(h&&h(),bt(e,a,3,[M,m===ul?void 0:m,f]),m=M)}else x.run()};v.allowRecurse=!!e;let D;r==="sync"?D=v:r==="post"?D=()=>nt(v,a&&a.suspense):D=()=>sy(v);const x=new Nu(u,D);return e?n?v():m=x.run():r==="post"?nt(x.run.bind(x),a&&a.suspense):x.run(),()=>{x.stop(),a&&a.scope&&Cu(a.scope.effects,x)}}function fy(t,e,n){const s=this.proxy,r=Re(t)?t.includes(".")?Rd(s,t):()=>s[t]:t.bind(s,s);let i;J(e)?i=e:(i=e.handler,n=e);const o=qe;ks(this);const a=Od(r,i.bind(s),n);return o?ks(o):Hn(),a}function Rd(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}function Bn(t,e){if(!De(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),je(t))Bn(t.value,e);else if(U(t))for(let n=0;n<t.length;n++)Bn(t[n],e);else if(sd(t)||_s(t))t.forEach(n=>{Bn(n,e)});else if(od(t))for(const n in t)Bn(t[n],e);return t}function py(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Bd(()=>{t.isMounted=!0}),$d(()=>{t.isUnmounting=!0}),t}const gt=[Function,Array],my={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:gt,onEnter:gt,onAfterEnter:gt,onEnterCancelled:gt,onBeforeLeave:gt,onLeave:gt,onAfterLeave:gt,onLeaveCancelled:gt,onBeforeAppear:gt,onAppear:gt,onAfterAppear:gt,onAppearCancelled:gt},setup(t,{slots:e}){const n=Xy(),s=py();let r;return()=>{const i=e.default&&Fd(e.default(),!0);if(!i||!i.length)return;let o=i[0];if(i.length>1){for(const D of i)if(D.type!==Ct){o=D;break}}const a=oe(t),{mode:u}=a;if(s.isLeaving)return ua(o);const c=cl(o);if(!c)return ua(o);const l=Oa(c,a,s,n);Ra(c,l);const h=n.subTree,f=h&&cl(h);let m=!1;const{getTransitionKey:v}=c.type;if(v){const D=v();r===void 0?r=D:D!==r&&(r=D,m=!0)}if(f&&f.type!==Ct&&(!On(c,f)||m)){const D=Oa(f,a,s,n);if(Ra(f,D),u==="out-in")return s.isLeaving=!0,D.afterLeave=()=>{s.isLeaving=!1,n.update()},ua(o);u==="in-out"&&c.type!==Ct&&(D.delayLeave=(x,M,W)=>{const V=Pd(s,f);V[String(f.key)]=f,x._leaveCb=()=>{M(),x._leaveCb=void 0,delete l.delayedLeave},l.delayedLeave=W})}return o}}},Ld=my;function Pd(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function Oa(t,e,n,s){const{appear:r,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:u,onAfterEnter:c,onEnterCancelled:l,onBeforeLeave:h,onLeave:f,onAfterLeave:m,onLeaveCancelled:v,onBeforeAppear:D,onAppear:x,onAfterAppear:M,onAppearCancelled:W}=e,V=String(t.key),Q=Pd(n,t),ee=(Y,pe)=>{Y&&bt(Y,s,9,pe)},ae=(Y,pe)=>{const be=pe[1];ee(Y,pe),U(Y)?Y.every(Ve=>Ve.length<=1)&&be():Y.length<=1&&be()},ye={mode:i,persisted:o,beforeEnter(Y){let pe=a;if(!n.isMounted)if(r)pe=D||a;else return;Y._leaveCb&&Y._leaveCb(!0);const be=Q[V];be&&On(t,be)&&be.el._leaveCb&&be.el._leaveCb(),ee(pe,[Y])},enter(Y){let pe=u,be=c,Ve=l;if(!n.isMounted)if(r)pe=x||u,be=M||c,Ve=W||l;else return;let F=!1;const Ie=Y._enterCb=mt=>{F||(F=!0,mt?ee(Ve,[Y]):ee(be,[Y]),ye.delayedLeave&&ye.delayedLeave(),Y._enterCb=void 0)};pe?ae(pe,[Y,Ie]):Ie()},leave(Y,pe){const be=String(t.key);if(Y._enterCb&&Y._enterCb(!0),n.isUnmounting)return pe();ee(h,[Y]);let Ve=!1;const F=Y._leaveCb=Ie=>{Ve||(Ve=!0,pe(),Ie?ee(v,[Y]):ee(m,[Y]),Y._leaveCb=void 0,Q[be]===t&&delete Q[be])};Q[be]=t,f?ae(f,[Y,F]):F()},clone(Y){return Oa(Y,e,n,s)}};return ye}function ua(t){if(vo(t))return t=dn(t),t.children=null,t}function cl(t){return vo(t)?t.children?t.children[0]:void 0:t}function Ra(t,e){t.shapeFlag&6&&t.component?Ra(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Fd(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===ve?(o.patchFlag&128&&r++,s=s.concat(Fd(o.children,e,a))):(e||o.type!==Ct)&&s.push(a!=null?dn(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function Dt(t){return J(t)?{setup:t,name:t.name}:t}const xi=t=>!!t.type.__asyncLoader,vo=t=>t.type.__isKeepAlive;function gy(t,e){Vd(t,"a",e)}function yy(t,e){Vd(t,"da",e)}function Vd(t,e,n=qe){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(wo(e,s,n),n){let r=n.parent;for(;r&&r.parent;)vo(r.parent.vnode)&&vy(s,e,n,r),r=r.parent}}function vy(t,e,n,s){const r=wo(e,t,s,!0);Ud(()=>{Cu(s[e],r)},n)}function wo(t,e,n=qe,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Us(),ks(n);const a=bt(e,n,t,o);return Hn(),qs(),a});return s?r.unshift(i):r.push(i),i}}const Gt=t=>(e,n=qe)=>(!Sr||t==="sp")&&wo(t,e,n),wy=Gt("bm"),Bd=Gt("m"),by=Gt("bu"),Iy=Gt("u"),$d=Gt("bum"),Ud=Gt("um"),Ey=Gt("sp"),Ty=Gt("rtg"),_y=Gt("rtc");function xy(t,e=qe){wo("ec",t,e)}function $i(t,e){const n=Tt;if(n===null)return t;const s=Io(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,u,c=fe]=e[i];J(o)&&(o={mounted:o,updated:o}),o.deep&&Bn(a),r.push({dir:o,instance:s,value:a,oldValue:void 0,arg:u,modifiers:c})}return t}function Tn(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let u=a.dir[s];u&&(Us(),bt(u,n,8,[t.el,a,t,e]),qs())}}const Cy=Symbol();function Vu(t,e,n,s){let r;const i=n&&n[s];if(U(t)||Re(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,i&&i[o])}else if(De(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,u=o.length;a<u;a++){const c=o[a];r[a]=e(t[c],c,a,i&&i[a])}}else r=[];return n&&(n[s]=r),r}const La=t=>t?Zd(t)?Io(t)||t.proxy:La(t.parent):null,Ui=He(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>La(t.parent),$root:t=>La(t.root),$emit:t=>t.emit,$options:t=>jd(t),$forceUpdate:t=>t.f||(t.f=()=>Cd(t.update)),$nextTick:t=>t.n||(t.n=ey.bind(t.proxy)),$watch:t=>fy.bind(t)}),Sy={get({_:t},e){const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:u}=t;let c;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(s!==fe&&ne(s,e))return o[e]=1,s[e];if(r!==fe&&ne(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&ne(c,e))return o[e]=3,i[e];if(n!==fe&&ne(n,e))return o[e]=4,n[e];Pa&&(o[e]=0)}}const l=Ui[e];let h,f;if(l)return e==="$attrs"&&dt(t,"get",e),l(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==fe&&ne(n,e))return o[e]=4,n[e];if(f=u.config.globalProperties,ne(f,e))return f[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return r!==fe&&ne(r,e)?(r[e]=n,!0):s!==fe&&ne(s,e)?(s[e]=n,!0):ne(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==fe&&ne(t,o)||e!==fe&&ne(e,o)||(a=i[0])&&ne(a,o)||ne(s,o)||ne(Ui,o)||ne(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ne(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Pa=!0;function Dy(t){const e=jd(t),n=t.proxy,s=t.ctx;Pa=!1,e.beforeCreate&&ll(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:u,inject:c,created:l,beforeMount:h,mounted:f,beforeUpdate:m,updated:v,activated:D,deactivated:x,beforeDestroy:M,beforeUnmount:W,destroyed:V,unmounted:Q,render:ee,renderTracked:ae,renderTriggered:ye,errorCaptured:Y,serverPrefetch:pe,expose:be,inheritAttrs:Ve,components:F,directives:Ie,filters:mt}=e;if(c&&Ay(c,s,null,t.appContext.config.unwrapInjectedRef),o)for(const _e in o){const me=o[_e];J(me)&&(s[_e]=me.bind(n))}if(r){const _e=r.call(n,n);De(_e)&&(t.data=Ru(_e))}if(Pa=!0,i)for(const _e in i){const me=i[_e],Bt=J(me)?me.bind(n,n):J(me.get)?me.get.bind(n,n):xt,ta=!J(me)&&J(me.set)?me.set.bind(n):xt,Qs=$n({get:Bt,set:ta});Object.defineProperty(s,_e,{enumerable:!0,configurable:!0,get:()=>Qs.value,set:hs=>Qs.value=hs})}if(a)for(const _e in a)qd(a[_e],s,n,_e);if(u){const _e=J(u)?u.call(n):u;Reflect.ownKeys(_e).forEach(me=>{dy(me,_e[me])})}l&&ll(l,t,"c");function Be(_e,me){U(me)?me.forEach(Bt=>_e(Bt.bind(n))):me&&_e(me.bind(n))}if(Be(wy,h),Be(Bd,f),Be(by,m),Be(Iy,v),Be(gy,D),Be(yy,x),Be(xy,Y),Be(_y,ae),Be(Ty,ye),Be($d,W),Be(Ud,Q),Be(Ey,pe),U(be))if(be.length){const _e=t.exposed||(t.exposed={});be.forEach(me=>{Object.defineProperty(_e,me,{get:()=>n[me],set:Bt=>n[me]=Bt})})}else t.exposed||(t.exposed={});ee&&t.render===xt&&(t.render=ee),Ve!=null&&(t.inheritAttrs=Ve),F&&(t.components=F),Ie&&(t.directives=Ie)}function Ay(t,e,n=xt,s=!1){U(t)&&(t=Fa(t));for(const r in t){const i=t[r];let o;De(i)?"default"in i?o=oa(i.from||r,i.default,!0):o=oa(i.from||r):o=oa(i),je(o)&&s?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[r]=o}}function ll(t,e,n){bt(U(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function qd(t,e,n,s){const r=s.includes(".")?Rd(n,s):()=>n[s];if(Re(t)){const i=e[t];J(i)&&aa(r,i)}else if(J(t))aa(r,t.bind(n));else if(De(t))if(U(t))t.forEach(i=>qd(i,e,n,s));else{const i=J(t.handler)?t.handler.bind(n):e[t.handler];J(i)&&aa(r,i,t)}}function jd(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let u;return a?u=a:!r.length&&!n&&!s?u=e:(u={},r.length&&r.forEach(c=>qi(u,c,o,!0)),qi(u,e,o)),i.set(e,u),u}function qi(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&qi(t,i,n,!0),r&&r.forEach(o=>qi(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=Ny[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Ny={data:hl,props:An,emits:An,methods:An,computed:An,beforeCreate:Xe,created:Xe,beforeMount:Xe,mounted:Xe,beforeUpdate:Xe,updated:Xe,beforeDestroy:Xe,beforeUnmount:Xe,destroyed:Xe,unmounted:Xe,activated:Xe,deactivated:Xe,errorCaptured:Xe,serverPrefetch:Xe,components:An,directives:An,watch:My,provide:hl,inject:ky};function hl(t,e){return e?t?function(){return He(J(t)?t.call(this,this):t,J(e)?e.call(this,this):e)}:e:t}function ky(t,e){return An(Fa(t),Fa(e))}function Fa(t){if(U(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Xe(t,e){return t?[...new Set([].concat(t,e))]:e}function An(t,e){return t?He(He(Object.create(null),t),e):e}function My(t,e){if(!t)return e;if(!e)return t;const n=He(Object.create(null),t);for(const s in e)n[s]=Xe(t[s],e[s]);return n}function Oy(t,e,n,s=!1){const r={},i={};Pi(i,bo,1),t.propsDefaults=Object.create(null),Kd(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:Gg(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function Ry(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=oe(r),[u]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const l=t.vnode.dynamicProps;for(let h=0;h<l.length;h++){let f=l[h];if(go(t.emitsOptions,f))continue;const m=e[f];if(u)if(ne(i,f))m!==i[f]&&(i[f]=m,c=!0);else{const v=Ns(f);r[v]=Va(u,a,v,m,t,!1)}else m!==i[f]&&(i[f]=m,c=!0)}}}else{Kd(t,e,r,i)&&(c=!0);let l;for(const h in a)(!e||!ne(e,h)&&((l=$s(h))===h||!ne(e,l)))&&(u?n&&(n[h]!==void 0||n[l]!==void 0)&&(r[h]=Va(u,a,h,void 0,t,!0)):delete r[h]);if(i!==a)for(const h in i)(!e||!ne(e,h)&&!0)&&(delete i[h],c=!0)}c&&Kt(t,"set","$attrs")}function Kd(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let u in e){if(Ti(u))continue;const c=e[u];let l;r&&ne(r,l=Ns(u))?!i||!i.includes(l)?n[l]=c:(a||(a={}))[l]=c:go(t.emitsOptions,u)||(!(u in s)||c!==s[u])&&(s[u]=c,o=!0)}if(i){const u=oe(n),c=a||fe;for(let l=0;l<i.length;l++){const h=i[l];n[h]=Va(r,u,h,c[h],t,!ne(c,h))}}return o}function Va(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=ne(o,"default");if(a&&s===void 0){const u=o.default;if(o.type!==Function&&J(u)){const{propsDefaults:c}=r;n in c?s=c[n]:(ks(r),s=c[n]=u.call(null,e),Hn())}else s=u}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===$s(n))&&(s=!0))}return s}function Hd(t,e,n=!1){const s=e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let u=!1;if(!J(t)){const l=h=>{u=!0;const[f,m]=Hd(h,e,!0);He(o,f),m&&a.push(...m)};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}if(!i&&!u)return s.set(t,Ts),Ts;if(U(i))for(let l=0;l<i.length;l++){const h=Ns(i[l]);dl(h)&&(o[h]=fe)}else if(i)for(const l in i){const h=Ns(l);if(dl(h)){const f=i[l],m=o[h]=U(f)||J(f)?{type:f}:f;if(m){const v=ml(Boolean,m.type),D=ml(String,m.type);m[0]=v>-1,m[1]=D<0||v<D,(v>-1||ne(m,"default"))&&a.push(h)}}}const c=[o,a];return s.set(t,c),c}function dl(t){return t[0]!=="$"}function fl(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function pl(t,e){return fl(t)===fl(e)}function ml(t,e){return U(e)?e.findIndex(n=>pl(n,t)):J(e)&&pl(e,t)?0:-1}const Gd=t=>t[0]==="_"||t==="$stable",Bu=t=>U(t)?t.map(Ot):[Ot(t)],Ly=(t,e,n)=>{if(e._n)return e;const s=Md((...r)=>Bu(e(...r)),n);return s._c=!1,s},zd=(t,e,n)=>{const s=t._ctx;for(const r in t){if(Gd(r))continue;const i=t[r];if(J(i))e[r]=Ly(r,i,s);else if(i!=null){const o=Bu(i);e[r]=()=>o}}},Wd=(t,e)=>{const n=Bu(e);t.slots.default=()=>n},Py=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=oe(e),Pi(e,"_",n)):zd(e,t.slots={})}else t.slots={},e&&Wd(t,e);Pi(t.slots,bo,1)},Fy=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=fe;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(He(r,e),!n&&a===1&&delete r._):(i=!e.$stable,zd(e,r)),o=e}else e&&(Wd(t,e),o={default:1});if(i)for(const a in r)!Gd(a)&&!(a in o)&&delete r[a]};function Qd(){return{app:null,config:{isNativeTag:dg,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Vy=0;function By(t,e){return function(s,r=null){J(s)||(s=Object.assign({},s)),r!=null&&!De(r)&&(r=null);const i=Qd(),o=new Set;let a=!1;const u=i.app={_uid:Vy++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:sv,get config(){return i.config},set config(c){},use(c,...l){return o.has(c)||(c&&J(c.install)?(o.add(c),c.install(u,...l)):J(c)&&(o.add(c),c(u,...l))),u},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),u},component(c,l){return l?(i.components[c]=l,u):i.components[c]},directive(c,l){return l?(i.directives[c]=l,u):i.directives[c]},mount(c,l,h){if(!a){const f=at(s,r);return f.appContext=i,l&&e?e(f,c):t(f,c,h),a=!0,u._container=c,c.__vue_app__=u,Io(f.component)||f.component.proxy}},unmount(){a&&(t(null,u._container),delete u._container.__vue_app__)},provide(c,l){return i.provides[c]=l,u}};return u}}function Ba(t,e,n,s,r=!1){if(U(t)){t.forEach((f,m)=>Ba(f,e&&(U(e)?e[m]:e),n,s,r));return}if(xi(s)&&!r)return;const i=s.shapeFlag&4?Io(s.component)||s.component.proxy:s.el,o=r?null:i,{i:a,r:u}=t,c=e&&e.r,l=a.refs===fe?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==u&&(Re(c)?(l[c]=null,ne(h,c)&&(h[c]=null)):je(c)&&(c.value=null)),J(u))an(u,a,12,[o,l]);else{const f=Re(u),m=je(u);if(f||m){const v=()=>{if(t.f){const D=f?l[u]:u.value;r?U(D)&&Cu(D,i):U(D)?D.includes(i)||D.push(i):f?(l[u]=[i],ne(h,u)&&(h[u]=l[u])):(u.value=[i],t.k&&(l[t.k]=u.value))}else f?(l[u]=o,ne(h,u)&&(h[u]=o)):m&&(u.value=o,t.k&&(l[t.k]=o))};o?(v.id=-1,nt(v,n)):v()}}}const nt=hy;function $y(t){return Uy(t)}function Uy(t,e){const n=vg();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:u,setText:c,setElementText:l,parentNode:h,nextSibling:f,setScopeId:m=xt,cloneNode:v,insertStaticContent:D}=t,x=(d,p,y,I=null,b=null,S=null,k=!1,C=null,A=!!p.dynamicChildren)=>{if(d===p)return;d&&!On(d,p)&&(I=ai(d),Qt(d,b,S,!0),d=null),p.patchFlag===-2&&(A=!1,p.dynamicChildren=null);const{type:E,ref:B,shapeFlag:O}=p;switch(E){case $u:M(d,p,y,I);break;case Ct:W(d,p,y,I);break;case ca:d==null&&V(p,y,I,k);break;case ve:Ie(d,p,y,I,b,S,k,C,A);break;default:O&1?ae(d,p,y,I,b,S,k,C,A):O&6?mt(d,p,y,I,b,S,k,C,A):(O&64||O&128)&&E.process(d,p,y,I,b,S,k,C,A,ds)}B!=null&&b&&Ba(B,d&&d.ref,S,p||d,!p)},M=(d,p,y,I)=>{if(d==null)s(p.el=a(p.children),y,I);else{const b=p.el=d.el;p.children!==d.children&&c(b,p.children)}},W=(d,p,y,I)=>{d==null?s(p.el=u(p.children||""),y,I):p.el=d.el},V=(d,p,y,I)=>{[d.el,d.anchor]=D(d.children,p,y,I,d.el,d.anchor)},Q=({el:d,anchor:p},y,I)=>{let b;for(;d&&d!==p;)b=f(d),s(d,y,I),d=b;s(p,y,I)},ee=({el:d,anchor:p})=>{let y;for(;d&&d!==p;)y=f(d),r(d),d=y;r(p)},ae=(d,p,y,I,b,S,k,C,A)=>{k=k||p.type==="svg",d==null?ye(p,y,I,b,S,k,C,A):be(d,p,b,S,k,C,A)},ye=(d,p,y,I,b,S,k,C)=>{let A,E;const{type:B,props:O,shapeFlag:$,transition:H,patchFlag:se,dirs:he}=d;if(d.el&&v!==void 0&&se===-1)A=d.el=v(d.el);else{if(A=d.el=o(d.type,S,O&&O.is,O),$&8?l(A,d.children):$&16&&pe(d.children,A,null,I,b,S&&B!=="foreignObject",k,C),he&&Tn(d,null,I,"created"),O){for(const ge in O)ge!=="value"&&!Ti(ge)&&i(A,ge,null,O[ge],S,d.children,I,b,$t);"value"in O&&i(A,"value",null,O.value),(E=O.onVnodeBeforeMount)&&kt(E,I,d)}Y(A,d,d.scopeId,k,I)}he&&Tn(d,null,I,"beforeMount");const de=(!b||b&&!b.pendingBranch)&&H&&!H.persisted;de&&H.beforeEnter(A),s(A,p,y),((E=O&&O.onVnodeMounted)||de||he)&&nt(()=>{E&&kt(E,I,d),de&&H.enter(A),he&&Tn(d,null,I,"mounted")},b)},Y=(d,p,y,I,b)=>{if(y&&m(d,y),I)for(let S=0;S<I.length;S++)m(d,I[S]);if(b){let S=b.subTree;if(p===S){const k=b.vnode;Y(d,k,k.scopeId,k.slotScopeIds,b.parent)}}},pe=(d,p,y,I,b,S,k,C,A=0)=>{for(let E=A;E<d.length;E++){const B=d[E]=C?nn(d[E]):Ot(d[E]);x(null,B,p,y,I,b,S,k,C)}},be=(d,p,y,I,b,S,k)=>{const C=p.el=d.el;let{patchFlag:A,dynamicChildren:E,dirs:B}=p;A|=d.patchFlag&16;const O=d.props||fe,$=p.props||fe;let H;y&&_n(y,!1),(H=$.onVnodeBeforeUpdate)&&kt(H,y,p,d),B&&Tn(p,d,y,"beforeUpdate"),y&&_n(y,!0);const se=b&&p.type!=="foreignObject";if(E?Ve(d.dynamicChildren,E,C,y,I,se,S):k||Bt(d,p,C,null,y,I,se,S,!1),A>0){if(A&16)F(C,p,O,$,y,I,b);else if(A&2&&O.class!==$.class&&i(C,"class",null,$.class,b),A&4&&i(C,"style",O.style,$.style,b),A&8){const he=p.dynamicProps;for(let de=0;de<he.length;de++){const ge=he[de],It=O[ge],fs=$[ge];(fs!==It||ge==="value")&&i(C,ge,It,fs,b,d.children,y,I,$t)}}A&1&&d.children!==p.children&&l(C,p.children)}else!k&&E==null&&F(C,p,O,$,y,I,b);((H=$.onVnodeUpdated)||B)&&nt(()=>{H&&kt(H,y,p,d),B&&Tn(p,d,y,"updated")},I)},Ve=(d,p,y,I,b,S,k)=>{for(let C=0;C<p.length;C++){const A=d[C],E=p[C],B=A.el&&(A.type===ve||!On(A,E)||A.shapeFlag&70)?h(A.el):y;x(A,E,B,null,I,b,S,k,!0)}},F=(d,p,y,I,b,S,k)=>{if(y!==I){for(const C in I){if(Ti(C))continue;const A=I[C],E=y[C];A!==E&&C!=="value"&&i(d,C,E,A,k,p.children,b,S,$t)}if(y!==fe)for(const C in y)!Ti(C)&&!(C in I)&&i(d,C,y[C],null,k,p.children,b,S,$t);"value"in I&&i(d,"value",y.value,I.value)}},Ie=(d,p,y,I,b,S,k,C,A)=>{const E=p.el=d?d.el:a(""),B=p.anchor=d?d.anchor:a("");let{patchFlag:O,dynamicChildren:$,slotScopeIds:H}=p;H&&(C=C?C.concat(H):H),d==null?(s(E,y,I),s(B,y,I),pe(p.children,y,B,b,S,k,C,A)):O>0&&O&64&&$&&d.dynamicChildren?(Ve(d.dynamicChildren,$,y,b,S,k,C),(p.key!=null||b&&p===b.subTree)&&Yd(d,p,!0)):Bt(d,p,y,B,b,S,k,C,A)},mt=(d,p,y,I,b,S,k,C,A)=>{p.slotScopeIds=C,d==null?p.shapeFlag&512?b.ctx.activate(p,y,I,k,A):ls(p,y,I,b,S,k,A):Be(d,p,A)},ls=(d,p,y,I,b,S,k)=>{const C=d.component=Yy(d,I,b);if(vo(d)&&(C.ctx.renderer=ds),Jy(C),C.asyncDep){if(b&&b.registerDep(C,_e),!d.el){const A=C.subTree=at(Ct);W(null,A,p,y)}return}_e(C,d,p,y,b,S,k)},Be=(d,p,y)=>{const I=p.component=d.component;if(uy(d,p,y))if(I.asyncDep&&!I.asyncResolved){me(I,p,y);return}else I.next=p,ny(I.update),I.update();else p.el=d.el,I.vnode=p},_e=(d,p,y,I,b,S,k)=>{const C=()=>{if(d.isMounted){let{next:B,bu:O,u:$,parent:H,vnode:se}=d,he=B,de;_n(d,!1),B?(B.el=se.el,me(d,B,k)):B=se,O&&_i(O),(de=B.props&&B.props.onVnodeBeforeUpdate)&&kt(de,H,B,se),_n(d,!0);const ge=ia(d),It=d.subTree;d.subTree=ge,x(It,ge,h(It.el),ai(It),d,b,S),B.el=ge.el,he===null&&cy(d,ge.el),$&&nt($,b),(de=B.props&&B.props.onVnodeUpdated)&&nt(()=>kt(de,H,B,se),b)}else{let B;const{el:O,props:$}=p,{bm:H,m:se,parent:he}=d,de=xi(p);if(_n(d,!1),H&&_i(H),!de&&(B=$&&$.onVnodeBeforeMount)&&kt(B,he,p),_n(d,!0),O&&sa){const ge=()=>{d.subTree=ia(d),sa(O,d.subTree,d,b,null)};de?p.type.__asyncLoader().then(()=>!d.isUnmounted&&ge()):ge()}else{const ge=d.subTree=ia(d);x(null,ge,y,I,d,b,S),p.el=ge.el}if(se&&nt(se,b),!de&&(B=$&&$.onVnodeMounted)){const ge=p;nt(()=>kt(B,he,ge),b)}(p.shapeFlag&256||he&&xi(he.vnode)&&he.vnode.shapeFlag&256)&&d.a&&nt(d.a,b),d.isMounted=!0,p=y=I=null}},A=d.effect=new Nu(C,()=>Cd(E),d.scope),E=d.update=()=>A.run();E.id=d.uid,_n(d,!0),E()},me=(d,p,y)=>{p.component=d;const I=d.vnode.props;d.vnode=p,d.next=null,Ry(d,p.props,I,y),Fy(d,p.children,y),Us(),mo(void 0,d.update),qs()},Bt=(d,p,y,I,b,S,k,C,A=!1)=>{const E=d&&d.children,B=d?d.shapeFlag:0,O=p.children,{patchFlag:$,shapeFlag:H}=p;if($>0){if($&128){Qs(E,O,y,I,b,S,k,C,A);return}else if($&256){ta(E,O,y,I,b,S,k,C,A);return}}H&8?(B&16&&$t(E,b,S),O!==E&&l(y,O)):B&16?H&16?Qs(E,O,y,I,b,S,k,C,A):$t(E,b,S,!0):(B&8&&l(y,""),H&16&&pe(O,y,I,b,S,k,C,A))},ta=(d,p,y,I,b,S,k,C,A)=>{d=d||Ts,p=p||Ts;const E=d.length,B=p.length,O=Math.min(E,B);let $;for($=0;$<O;$++){const H=p[$]=A?nn(p[$]):Ot(p[$]);x(d[$],H,y,null,b,S,k,C,A)}E>B?$t(d,b,S,!0,!1,O):pe(p,y,I,b,S,k,C,A,O)},Qs=(d,p,y,I,b,S,k,C,A)=>{let E=0;const B=p.length;let O=d.length-1,$=B-1;for(;E<=O&&E<=$;){const H=d[E],se=p[E]=A?nn(p[E]):Ot(p[E]);if(On(H,se))x(H,se,y,null,b,S,k,C,A);else break;E++}for(;E<=O&&E<=$;){const H=d[O],se=p[$]=A?nn(p[$]):Ot(p[$]);if(On(H,se))x(H,se,y,null,b,S,k,C,A);else break;O--,$--}if(E>O){if(E<=$){const H=$+1,se=H<B?p[H].el:I;for(;E<=$;)x(null,p[E]=A?nn(p[E]):Ot(p[E]),y,se,b,S,k,C,A),E++}}else if(E>$)for(;E<=O;)Qt(d[E],b,S,!0),E++;else{const H=E,se=E,he=new Map;for(E=se;E<=$;E++){const it=p[E]=A?nn(p[E]):Ot(p[E]);it.key!=null&&he.set(it.key,E)}let de,ge=0;const It=$-se+1;let fs=!1,Yc=0;const Ys=new Array(It);for(E=0;E<It;E++)Ys[E]=0;for(E=H;E<=O;E++){const it=d[E];if(ge>=It){Qt(it,b,S,!0);continue}let Nt;if(it.key!=null)Nt=he.get(it.key);else for(de=se;de<=$;de++)if(Ys[de-se]===0&&On(it,p[de])){Nt=de;break}Nt===void 0?Qt(it,b,S,!0):(Ys[Nt-se]=E+1,Nt>=Yc?Yc=Nt:fs=!0,x(it,p[Nt],y,null,b,S,k,C,A),ge++)}const Xc=fs?qy(Ys):Ts;for(de=Xc.length-1,E=It-1;E>=0;E--){const it=se+E,Nt=p[it],Jc=it+1<B?p[it+1].el:I;Ys[E]===0?x(null,Nt,y,Jc,b,S,k,C,A):fs&&(de<0||E!==Xc[de]?hs(Nt,y,Jc,2):de--)}}},hs=(d,p,y,I,b=null)=>{const{el:S,type:k,transition:C,children:A,shapeFlag:E}=d;if(E&6){hs(d.component.subTree,p,y,I);return}if(E&128){d.suspense.move(p,y,I);return}if(E&64){k.move(d,p,y,ds);return}if(k===ve){s(S,p,y);for(let O=0;O<A.length;O++)hs(A[O],p,y,I);s(d.anchor,p,y);return}if(k===ca){Q(d,p,y);return}if(I!==2&&E&1&&C)if(I===0)C.beforeEnter(S),s(S,p,y),nt(()=>C.enter(S),b);else{const{leave:O,delayLeave:$,afterLeave:H}=C,se=()=>s(S,p,y),he=()=>{O(S,()=>{se(),H&&H()})};$?$(S,se,he):he()}else s(S,p,y)},Qt=(d,p,y,I=!1,b=!1)=>{const{type:S,props:k,ref:C,children:A,dynamicChildren:E,shapeFlag:B,patchFlag:O,dirs:$}=d;if(C!=null&&Ba(C,null,y,d,!0),B&256){p.ctx.deactivate(d);return}const H=B&1&&$,se=!xi(d);let he;if(se&&(he=k&&k.onVnodeBeforeUnmount)&&kt(he,p,d),B&6)og(d.component,y,I);else{if(B&128){d.suspense.unmount(y,I);return}H&&Tn(d,null,p,"beforeUnmount"),B&64?d.type.remove(d,p,y,b,ds,I):E&&(S!==ve||O>0&&O&64)?$t(E,p,y,!1,!0):(S===ve&&O&384||!b&&B&16)&&$t(A,p,y),I&&Wc(d)}(se&&(he=k&&k.onVnodeUnmounted)||H)&&nt(()=>{he&&kt(he,p,d),H&&Tn(d,null,p,"unmounted")},y)},Wc=d=>{const{type:p,el:y,anchor:I,transition:b}=d;if(p===ve){ig(y,I);return}if(p===ca){ee(d);return}const S=()=>{r(y),b&&!b.persisted&&b.afterLeave&&b.afterLeave()};if(d.shapeFlag&1&&b&&!b.persisted){const{leave:k,delayLeave:C}=b,A=()=>k(y,S);C?C(d.el,S,A):A()}else S()},ig=(d,p)=>{let y;for(;d!==p;)y=f(d),r(d),d=y;r(p)},og=(d,p,y)=>{const{bum:I,scope:b,update:S,subTree:k,um:C}=d;I&&_i(I),b.stop(),S&&(S.active=!1,Qt(k,d,p,y)),C&&nt(C,p),nt(()=>{d.isUnmounted=!0},p),p&&p.pendingBranch&&!p.isUnmounted&&d.asyncDep&&!d.asyncResolved&&d.suspenseId===p.pendingId&&(p.deps--,p.deps===0&&p.resolve())},$t=(d,p,y,I=!1,b=!1,S=0)=>{for(let k=S;k<d.length;k++)Qt(d[k],p,y,I,b)},ai=d=>d.shapeFlag&6?ai(d.component.subTree):d.shapeFlag&128?d.suspense.next():f(d.anchor||d.el),Qc=(d,p,y)=>{d==null?p._vnode&&Qt(p._vnode,null,null,!0):x(p._vnode||null,d,p,null,null,null,y),Ad(),p._vnode=d},ds={p:x,um:Qt,m:hs,r:Wc,mt:ls,mc:pe,pc:Bt,pbc:Ve,n:ai,o:t};let na,sa;return e&&([na,sa]=e(ds)),{render:Qc,hydrate:na,createApp:By(Qc,na)}}function _n({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Yd(t,e,n=!1){const s=t.children,r=e.children;if(U(s)&&U(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=nn(r[i]),a.el=o.el),n||Yd(o,a))}}function qy(t){const e=t.slice(),n=[0];let s,r,i,o,a;const u=t.length;for(s=0;s<u;s++){const c=t[s];if(c!==0){if(r=n[n.length-1],t[r]<c){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<c?i=a+1:o=a;c<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const jy=t=>t.__isTeleport,ve=Symbol(void 0),$u=Symbol(void 0),Ct=Symbol(void 0),ca=Symbol(void 0),mr=[];let _t=null;function ie(t=!1){mr.push(_t=t?null:[])}function Ky(){mr.pop(),_t=mr[mr.length-1]||null}let Cr=1;function gl(t){Cr+=t}function Xd(t){return t.dynamicChildren=Cr>0?_t||Ts:null,Ky(),Cr>0&&_t&&_t.push(t),t}function ke(t,e,n,s,r,i){return Xd(T(t,e,n,s,r,i,!0))}function yt(t,e,n,s,r){return Xd(at(t,e,n,s,r,!0))}function $a(t){return t?t.__v_isVNode===!0:!1}function On(t,e){return t.type===e.type&&t.key===e.key}const bo="__vInternal",Jd=({key:t})=>t!=null?t:null,Ci=({ref:t,ref_key:e,ref_for:n})=>t!=null?Re(t)||je(t)||J(t)?{i:Tt,r:t,k:e,f:!!n}:t:null;function T(t,e=null,n=null,s=0,r=null,i=t===ve?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Jd(e),ref:e&&Ci(e),scopeId:yo,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null};return a?(Uu(u,n),i&128&&t.normalize(u)):n&&(u.shapeFlag|=Re(n)?8:16),Cr>0&&!o&&_t&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&_t.push(u),u}const at=Hy;function Hy(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===Cy)&&(t=Ct),$a(t)){const a=dn(t,e,!0);return n&&Uu(a,n),Cr>0&&!i&&_t&&(a.shapeFlag&6?_t[_t.indexOf(t)]=a:_t.push(a)),a.patchFlag|=-2,a}if(nv(t)&&(t=t.__vccOpts),e){e=Gy(e);let{class:a,style:u}=e;a&&!Re(a)&&(e.class=Bs(a)),De(u)&&(wd(u)&&!U(u)&&(u=He({},u)),e.style=_u(u))}const o=Re(t)?1:ly(t)?128:jy(t)?64:De(t)?4:J(t)?2:0;return T(t,e,n,s,r,o,i,!0)}function Gy(t){return t?wd(t)||bo in t?He({},t):t:null}function dn(t,e,n=!1){const{props:s,ref:r,patchFlag:i,children:o}=t,a=e?zy(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&Jd(a),ref:e&&e.ref?n&&r?U(r)?r.concat(Ci(e)):[r,Ci(e)]:Ci(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ve?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&dn(t.ssContent),ssFallback:t.ssFallback&&dn(t.ssFallback),el:t.el,anchor:t.anchor}}function Si(t=" ",e=0){return at($u,null,t,e)}function vt(t="",e=!1){return e?(ie(),yt(Ct,null,t)):at(Ct,null,t)}function Ot(t){return t==null||typeof t=="boolean"?at(Ct):U(t)?at(ve,null,t.slice()):typeof t=="object"?nn(t):at($u,null,String(t))}function nn(t){return t.el===null||t.memo?t:dn(t)}function Uu(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(U(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),Uu(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(bo in e)?e._ctx=Tt:r===3&&Tt&&(Tt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else J(e)?(e={default:e,_ctx:Tt},n=32):(e=String(e),s&64?(n=16,e=[Si(e)]):n=8);t.children=e,t.shapeFlag|=n}function zy(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=Bs([e.class,s.class]));else if(r==="style")e.style=_u([e.style,s.style]);else if(co(r)){const i=e[r],o=s[r];o&&i!==o&&!(U(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function kt(t,e,n,s=null){bt(t,e,7,[n,s])}const Wy=Qd();let Qy=0;function Yy(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||Wy,i={uid:Qy++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new wg(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Hd(s,r),emitsOptions:kd(s,r),emit:null,emitted:null,propsDefaults:fe,inheritAttrs:s.inheritAttrs,ctx:fe,data:fe,props:fe,attrs:fe,slots:fe,refs:fe,setupState:fe,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=iy.bind(null,i),t.ce&&t.ce(i),i}let qe=null;const Xy=()=>qe||Tt,ks=t=>{qe=t,t.scope.on()},Hn=()=>{qe&&qe.scope.off(),qe=null};function Zd(t){return t.vnode.shapeFlag&4}let Sr=!1;function Jy(t,e=!1){Sr=e;const{props:n,children:s}=t.vnode,r=Zd(t);Oy(t,n,r,e),Py(t,s);const i=r?Zy(t,e):void 0;return Sr=!1,i}function Zy(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=bd(new Proxy(t.ctx,Sy));const{setup:s}=n;if(s){const r=t.setupContext=s.length>1?tv(t):null;ks(t),Us();const i=an(s,t,0,[t.props,r]);if(qs(),Hn(),rd(i)){if(i.then(Hn,Hn),e)return i.then(o=>{yl(t,o,e)}).catch(o=>{po(o,t,0)});t.asyncDep=i}else yl(t,i,e)}else ef(t,e)}function yl(t,e,n){J(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:De(e)&&(t.setupState=Td(e)),ef(t,n)}let vl;function ef(t,e,n){const s=t.type;if(!t.render){if(!e&&vl&&!s.render){const r=s.template;if(r){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:u}=s,c=He(He({isCustomElement:i,delimiters:a},o),u);s.render=vl(r,c)}}t.render=s.render||xt}ks(t),Us(),Dy(t),qs(),Hn()}function ev(t){return new Proxy(t.attrs,{get(e,n){return dt(t,"get","$attrs"),e[n]}})}function tv(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=ev(t))},slots:t.slots,emit:t.emit,expose:e}}function Io(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Td(bd(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Ui)return Ui[n](t)}}))}function nv(t){return J(t)&&"__vccOpts"in t}const $n=(t,e)=>Kr(t,e,Sr);function tf(t,e,n){const s=arguments.length;return s===2?De(e)&&!U(e)?$a(e)?at(t,null,[e]):at(t,e):at(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&$a(n)&&(n=[n]),at(t,e,n))}const sv="3.2.37",rv="http://www.w3.org/2000/svg",Rn=typeof document<"u"?document:null,wl=Rn&&Rn.createElement("template"),iv={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e?Rn.createElementNS(rv,t):Rn.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Rn.createTextNode(t),createComment:t=>Rn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Rn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{wl.innerHTML=s?`<svg>${t}</svg>`:t;const a=wl.content;if(s){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function ov(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function av(t,e,n){const s=t.style,r=Re(n);if(n&&!r){for(const i in n)Ua(s,i,n[i]);if(e&&!Re(e))for(const i in e)n[i]==null&&Ua(s,i,"")}else{const i=s.display;r?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=i)}}const bl=/\s*!important$/;function Ua(t,e,n){if(U(n))n.forEach(s=>Ua(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=uv(t,e);bl.test(n)?t.setProperty($s(s),n.replace(bl,""),"important"):t[s]=n}}const Il=["Webkit","Moz","ms"],la={};function uv(t,e){const n=la[e];if(n)return n;let s=Ns(e);if(s!=="filter"&&s in t)return la[e]=s;s=ad(s);for(let r=0;r<Il.length;r++){const i=Il[r]+s;if(i in t)return la[e]=i}return e}const El="http://www.w3.org/1999/xlink";function cv(t,e,n,s,r){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(El,e.slice(6,e.length)):t.setAttributeNS(El,e,n);else{const i=ug(e);n==null||i&&!td(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function lv(t,e,n,s,r,i,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,r,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const u=n==null?"":n;(t.value!==u||t.tagName==="OPTION")&&(t.value=u),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const u=typeof t[e];u==="boolean"?n=td(n):n==null&&u==="string"?(n="",a=!0):u==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[nf,hv]=(()=>{let t=Date.now,e=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let qa=0;const dv=Promise.resolve(),fv=()=>{qa=0},pv=()=>qa||(dv.then(fv),qa=nf());function ws(t,e,n,s){t.addEventListener(e,n,s)}function mv(t,e,n,s){t.removeEventListener(e,n,s)}function gv(t,e,n,s,r=null){const i=t._vei||(t._vei={}),o=i[e];if(s&&o)o.value=s;else{const[a,u]=yv(e);if(s){const c=i[e]=vv(s,r);ws(t,a,c,u)}else o&&(mv(t,a,o,u),i[e]=void 0)}}const Tl=/(?:Once|Passive|Capture)$/;function yv(t){let e;if(Tl.test(t)){e={};let n;for(;n=t.match(Tl);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[$s(t.slice(2)),e]}function vv(t,e){const n=s=>{const r=s.timeStamp||nf();(hv||r>=n.attached-1)&&bt(wv(s,n.value),e,5,[s])};return n.value=t,n.attached=pv(),n}function wv(t,e){if(U(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const _l=/^on[a-z]/,bv=(t,e,n,s,r=!1,i,o,a,u)=>{e==="class"?ov(t,s,r):e==="style"?av(t,n,s):co(e)?xu(e)||gv(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Iv(t,e,s,r))?lv(t,e,s,i,o,a,u):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),cv(t,e,s,r))};function Iv(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&_l.test(e)&&J(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||_l.test(e)&&Re(n)?!1:e in t}const Xt="transition",Xs="animation",qu=(t,{slots:e})=>tf(Ld,Ev(t),e);qu.displayName="Transition";const sf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};qu.props=He({},Ld.props,sf);const xn=(t,e=[])=>{U(t)?t.forEach(n=>n(...e)):t&&t(...e)},xl=t=>t?U(t)?t.some(e=>e.length>1):t.length>1:!1;function Ev(t){const e={};for(const F in t)F in sf||(e[F]=t[F]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:u=i,appearActiveClass:c=o,appearToClass:l=a,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:m=`${n}-leave-to`}=t,v=Tv(r),D=v&&v[0],x=v&&v[1],{onBeforeEnter:M,onEnter:W,onEnterCancelled:V,onLeave:Q,onLeaveCancelled:ee,onBeforeAppear:ae=M,onAppear:ye=W,onAppearCancelled:Y=V}=e,pe=(F,Ie,mt)=>{Cn(F,Ie?l:a),Cn(F,Ie?c:o),mt&&mt()},be=(F,Ie)=>{F._isLeaving=!1,Cn(F,h),Cn(F,m),Cn(F,f),Ie&&Ie()},Ve=F=>(Ie,mt)=>{const ls=F?ye:W,Be=()=>pe(Ie,F,mt);xn(ls,[Ie,Be]),Cl(()=>{Cn(Ie,F?u:i),Jt(Ie,F?l:a),xl(ls)||Sl(Ie,s,D,Be)})};return He(e,{onBeforeEnter(F){xn(M,[F]),Jt(F,i),Jt(F,o)},onBeforeAppear(F){xn(ae,[F]),Jt(F,u),Jt(F,c)},onEnter:Ve(!1),onAppear:Ve(!0),onLeave(F,Ie){F._isLeaving=!0;const mt=()=>be(F,Ie);Jt(F,h),Cv(),Jt(F,f),Cl(()=>{!F._isLeaving||(Cn(F,h),Jt(F,m),xl(Q)||Sl(F,s,x,mt))}),xn(Q,[F,mt])},onEnterCancelled(F){pe(F,!1),xn(V,[F])},onAppearCancelled(F){pe(F,!0),xn(Y,[F])},onLeaveCancelled(F){be(F),xn(ee,[F])}})}function Tv(t){if(t==null)return null;if(De(t))return[ha(t.enter),ha(t.leave)];{const e=ha(t);return[e,e]}}function ha(t){return Fi(t)}function Jt(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function Cn(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function Cl(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let _v=0;function Sl(t,e,n,s){const r=t._endId=++_v,i=()=>{r===t._endId&&s()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:u}=xv(t,e);if(!o)return s();const c=o+"end";let l=0;const h=()=>{t.removeEventListener(c,f),i()},f=m=>{m.target===t&&++l>=u&&h()};setTimeout(()=>{l<u&&h()},a+1),t.addEventListener(c,f)}function xv(t,e){const n=window.getComputedStyle(t),s=v=>(n[v]||"").split(", "),r=s(Xt+"Delay"),i=s(Xt+"Duration"),o=Dl(r,i),a=s(Xs+"Delay"),u=s(Xs+"Duration"),c=Dl(a,u);let l=null,h=0,f=0;e===Xt?o>0&&(l=Xt,h=o,f=i.length):e===Xs?c>0&&(l=Xs,h=c,f=u.length):(h=Math.max(o,c),l=h>0?o>c?Xt:Xs:null,f=l?l===Xt?i.length:u.length:0);const m=l===Xt&&/\b(transform|all)(,|$)/.test(n[Xt+"Property"]);return{type:l,timeout:h,propCount:f,hasTransform:m}}function Dl(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>Al(n)+Al(t[s])))}function Al(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function Cv(){return document.body.offsetHeight}const Nl=t=>{const e=t.props["onUpdate:modelValue"]||!1;return U(e)?n=>_i(e,n):e};function Sv(t){t.target.composing=!0}function kl(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ja={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t._assign=Nl(r);const i=s||r.props&&r.props.type==="number";ws(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=Fi(a)),t._assign(a)}),n&&ws(t,"change",()=>{t.value=t.value.trim()}),e||(ws(t,"compositionstart",Sv),ws(t,"compositionend",kl),ws(t,"change",kl))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:s,number:r}},i){if(t._assign=Nl(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||s&&t.value.trim()===e||(r||t.type==="number")&&Fi(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},Dv=["ctrl","shift","alt","meta"],Av={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Dv.some(n=>t[`${n}Key`]&&!e.includes(n))},Nv=(t,e)=>(n,...s)=>{for(let r=0;r<e.length;r++){const i=Av[e[r]];if(i&&i(n,e))return}return t(n,...s)},kv={beforeMount(t,{value:e},{transition:n}){t._vod=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):Js(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:s}){!e!=!n&&(s?e?(s.beforeEnter(t),Js(t,!0),s.enter(t)):s.leave(t,()=>{Js(t,!1)}):Js(t,e))},beforeUnmount(t,{value:e}){Js(t,e)}};function Js(t,e){t.style.display=e?t._vod:"none"}const Mv=He({patchProp:bv},iv);let Ml;function rf(){return Ml||(Ml=$y(Mv))}const Ol=(...t)=>{rf().render(...t)},Ov=(...t)=>{const e=rf().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=Rv(s);if(!r)return;const i=e._component;!J(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Rv(t){return Re(t)?document.querySelector(t):t}const tn=ue({route:"home"});function Un(t){setTimeout(()=>tn.value.route=t,500)}const Lv=t=>{typeof t.remove<"u"?t.remove():t.parentNode.removeChild(t)};class Pv{constructor(e,n){this.startedAt=Date.now(),this.callback=e,this.delay=n,this.timer=setTimeout(e,n)}pause(){this.stop(),this.delay-=Date.now()-this.startedAt}resume(){this.stop(),this.startedAt=Date.now(),this.timer=setTimeout(this.callback,this.delay)}stop(){clearTimeout(this.timer)}}const Nn={TOP_RIGHT:"top-right",TOP:"top",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom-left"},Rl=Object.freeze(Nn);function Ll(t,e,n){let s=null;switch(t){case Nn.TOP:case Nn.TOP_RIGHT:case Nn.TOP_LEFT:s=e;break;case Nn.BOTTOM:case Nn.BOTTOM_RIGHT:case Nn.BOTTOM_LEFT:s=n;break}return s}class Fv{constructor(){this.queue={}}$on(e,n){this.queue[e]=this.queue[e]||[],this.queue[e].push(n)}$off(e,n){if(this.queue[e]){for(var s=0;s<this.queue[e].length;s++)if(this.queue[e][s]===n){this.queue[e].splice(s,1);break}}}$emit(e,n){this.queue[e]&&this.queue[e].forEach(function(s){s(n)})}}const Ka=new Fv;const At=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n},Vv={name:"toast",props:{message:{type:String,required:!0},type:{type:String,default:"default"},position:{type:String,default:Rl.BOTTOM_RIGHT,validator(t){return Object.values(Rl).includes(t)}},maxToasts:{type:[Number,Boolean],default:!1},duration:{type:[Number,Boolean],default:4e3},dismissible:{type:Boolean,default:!0},queue:{type:Boolean,default:!1},pauseOnHover:{type:Boolean,default:!0},useDefaultCss:{type:Boolean,default:!0},onClose:{type:Function,default:()=>{}},onClick:{type:Function,default:()=>{}}},data(){return{isActive:!1,parentTop:null,parentBottom:null,isHovered:!1,timer:null}},beforeMount(){this.createParents(),this.setDefaultCss(),this.setupContainer()},mounted(){this.showNotice(),Ka.$on("toast-clear",this.close)},methods:{createParents(){this.parentTop=document.querySelector(".c-toast-container--top"),this.parentBottom=document.querySelector(".c-toast-container--bottom"),!(this.parentTop&&this.parentBottom)&&(this.parentTop||(this.parentTop=document.createElement("div"),this.parentTop.className="c-toast-container c-toast-container--top"),this.parentBottom||(this.parentBottom=document.createElement("div"),this.parentBottom.className="c-toast-container c-toast-container--bottom"))},setDefaultCss(){const t=this.useDefaultCss?"add":"remove";this.parentTop.classList[t]("v--default-css"),this.parentBottom.classList[t]("v--default-css")},setupContainer(){const t=document.body;t.appendChild(this.parentTop),t.appendChild(this.parentBottom)},shouldQueue(){return!this.queue&&this.maxToasts===!1?!1:this.maxToasts!==!1?this.maxToasts<=this.parentTop.childElementCount+this.parentBottom.childElementCount:this.parentTop.childElementCount>0||this.parentBottom.childElementCount>0},showNotice(){if(this.shouldQueue()){this.queueTimer=setTimeout(this.showNotice,250);return}this.correctParent.insertAdjacentElement("afterbegin",this.$el),this.isActive=!0,this.timer=this.duration!==!1?new Pv(this.close,this.duration):null},click(){this.onClick.apply(null,arguments),this.dismissible&&this.close()},toggleTimer(t){this.timer&&this.pauseOnHover&&(t?this.timer.pause():this.timer.resume())},stopTimer(){this.timer&&this.timer.stop(),clearTimeout(this.queueTimer)},close(){this.stopTimer(),this.isActive=!1,setTimeout(()=>{this.onClose.apply(null,arguments),Lv(this.$el)},150)}},computed:{correctParent(){return Ll(this.position,this.parentTop,this.parentBottom)},transition(){return Ll(this.position,{enter:"fadeInDown",leave:"fadeOut"},{enter:"fadeInUp",leave:"fadeOut"})}},beforeUnmount(){Ka.$off("toast-clear",this.close)}},Bv=["innerHTML"];function $v(t,e,n,s,r,i){return ie(),yt(qu,{"enter-active-class":i.transition.enter,"leave-active-class":i.transition.leave},{default:Md(()=>[$i(T("div",{class:Bs(["c-toast",`c-toast--${n.type}`,`c-toast--${n.position}`]),onMouseover:e[0]||(e[0]=o=>i.toggleTimer(!0)),onMouseleave:e[1]||(e[1]=o=>i.toggleTimer(!1)),onClick:e[2]||(e[2]=(...o)=>i.click&&i.click(...o)),role:"alert",innerHTML:n.message},null,42,Bv),[[kv,r.isActive]])]),_:1},8,["enter-active-class","leave-active-class"])}const of=At(Vv,[["render",$v]]),Uv=()=>typeof document<"u"&&document.createElement("div"),qv=(t,{props:e,children:n,element:s,app:r}={})=>{let i=s||Uv(),o=tf(t,e,n);return r&&r._context&&(o.appContext=r._context),Ol(o,i),{vNode:o,destroy:()=>{i&&Ol(null,i),i=null,o=null},el:i}},ju=(t={})=>({show(e,n={}){let s={message:e,...n};return qv(of,{props:{...t,...s}})},clear(){Ka.$emit("toast-clear")},success(e,n={}){return n.type="success",this.show(e,n)},error(e,n={}){return n.type="error",this.show(e,n)},info(e,n={}){return n.type="info",this.show(e,n)},warning(e,n={}){return n.type="warning",this.show(e,n)}}),jv=(t,e={})=>{let n=ju(e);t.$toast=n,t.config.globalProperties.$toast=n};of.install=jv;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Kv=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],u=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(u>>10)),e[s++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Hv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,u=r+2<t.length,c=u?t[r+2]:0,l=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;u||(m=64,o||(f=64)),s.push(n[l],n[h],n[f],n[m])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(af(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Kv(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const c=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||c==null||h==null)throw Error();const f=i<<2|a>>4;if(s.push(f),c!==64){const m=a<<4&240|c>>2;if(s.push(m),h!==64){const v=c<<6&192|h;s.push(v)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Gv=function(t){const e=af(t);return Hv.encodeByteArray(e,!0)},uf=function(t){return Gv(t).replace(/\./g,"")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ha(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Wv(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Qv(){return!Wv()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cf(){return typeof indexedDB=="object"}function Yv(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv="FirebaseError";class js extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=Xv,Object.setPrototypeOf(this,js.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lf.prototype.create)}}class lf{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?Jv(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new js(r,a,s)}}function Jv(t,e){return t.replace(Zv,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const Zv=/\{\$([^}]+)}/g;function Ga(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(Pl(i)&&Pl(o)){if(!Ga(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Pl(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(t){return t&&t._delegate?t._delegate:t}class Dr{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new zv;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(nw(e))try{this.getOrInitializeService({instanceIdentifier:kn})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kn){return this.instances.has(e)}getOptions(e=kn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(!!s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:tw(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=kn){return this.component?this.component.multipleInstances?e:kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tw(t){return t===kn?void 0:t}function nw(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ew(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(re||(re={}));const rw={debug:re.DEBUG,verbose:re.VERBOSE,info:re.INFO,warn:re.WARN,error:re.ERROR,silent:re.SILENT},iw=re.INFO,ow={[re.DEBUG]:"log",[re.VERBOSE]:"log",[re.INFO]:"info",[re.WARN]:"warn",[re.ERROR]:"error"},aw=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=ow[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hf{constructor(e){this.name=e,this._logLevel=iw,this._logHandler=aw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,re.DEBUG,...e),this._logHandler(this,re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,re.VERBOSE,...e),this._logHandler(this,re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,re.INFO,...e),this._logHandler(this,re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,re.WARN,...e),this._logHandler(this,re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,re.ERROR,...e),this._logHandler(this,re.ERROR,...e)}}const uw=(t,e)=>e.some(n=>t instanceof n);let Fl,Vl;function cw(){return Fl||(Fl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lw(){return Vl||(Vl=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const df=new WeakMap,za=new WeakMap,ff=new WeakMap,da=new WeakMap,Ku=new WeakMap;function hw(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(un(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&df.set(n,t)}).catch(()=>{}),Ku.set(e,t),e}function dw(t){if(za.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});za.set(t,e)}let Wa={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return za.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ff.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return un(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function fw(t){Wa=t(Wa)}function pw(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(fa(this),e,...n);return ff.set(s,e.sort?e.sort():[e]),un(s)}:lw().includes(t)?function(...e){return t.apply(fa(this),e),un(df.get(this))}:function(...e){return un(t.apply(fa(this),e))}}function mw(t){return typeof t=="function"?pw(t):(t instanceof IDBTransaction&&dw(t),uw(t,cw())?new Proxy(t,Wa):t)}function un(t){if(t instanceof IDBRequest)return hw(t);if(da.has(t))return da.get(t);const e=mw(t);return e!==t&&(da.set(t,e),Ku.set(e,t)),e}const fa=t=>Ku.get(t);function gw(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=un(o);return s&&o.addEventListener("upgradeneeded",u=>{s(un(o.result),u.oldVersion,u.newVersion,un(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(u=>{i&&u.addEventListener("close",()=>i()),r&&u.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}const yw=["get","getKey","getAll","getAllKeys","count"],vw=["put","add","delete","clear"],pa=new Map;function Bl(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(pa.get(e))return pa.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=vw.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||yw.includes(n)))return;const i=async function(o,...a){const u=this.transaction(o,r?"readwrite":"readonly");let c=u.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),r&&u.done]))[0]};return pa.set(e,i),i}fw(t=>({...t,get:(e,n,s)=>Bl(e,n)||t.get(e,n,s),has:(e,n)=>!!Bl(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(bw(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function bw(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qa="@firebase/app",$l="0.7.33";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn=new hf("@firebase/app"),Iw="@firebase/app-compat",Ew="@firebase/analytics-compat",Tw="@firebase/analytics",_w="@firebase/app-check-compat",xw="@firebase/app-check",Cw="@firebase/auth",Sw="@firebase/auth-compat",Dw="@firebase/database",Aw="@firebase/database-compat",Nw="@firebase/functions",kw="@firebase/functions-compat",Mw="@firebase/installations",Ow="@firebase/installations-compat",Rw="@firebase/messaging",Lw="@firebase/messaging-compat",Pw="@firebase/performance",Fw="@firebase/performance-compat",Vw="@firebase/remote-config",Bw="@firebase/remote-config-compat",$w="@firebase/storage",Uw="@firebase/storage-compat",qw="@firebase/firestore",jw="@firebase/firestore-compat",Kw="firebase",Hw="9.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="[DEFAULT]",Gw={[Qa]:"fire-core",[Iw]:"fire-core-compat",[Tw]:"fire-analytics",[Ew]:"fire-analytics-compat",[xw]:"fire-app-check",[_w]:"fire-app-check-compat",[Cw]:"fire-auth",[Sw]:"fire-auth-compat",[Dw]:"fire-rtdb",[Aw]:"fire-rtdb-compat",[Nw]:"fire-fn",[kw]:"fire-fn-compat",[Mw]:"fire-iid",[Ow]:"fire-iid-compat",[Rw]:"fire-fcm",[Lw]:"fire-fcm-compat",[Pw]:"fire-perf",[Fw]:"fire-perf-compat",[Vw]:"fire-rc",[Bw]:"fire-rc-compat",[$w]:"fire-gcs",[Uw]:"fire-gcs-compat",[qw]:"fire-fst",[jw]:"fire-fst-compat","fire-js":"fire-js",[Kw]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new Map,Ya=new Map;function zw(t,e){try{t.container.addComponent(e)}catch(n){Wn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ki(t){const e=t.name;if(Ya.has(e))return Wn.debug(`There were multiple attempts to register component ${e}.`),!1;Ya.set(e,t);for(const n of ji.values())zw(n,t);return!0}function Ww(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Qn=new lf("app","Firebase",Qw);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Dr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xw=Hw;function Jw(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:pf,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Qn.create("bad-app-name",{appName:String(s)});const r=ji.get(s);if(r){if(Ga(t,r.options)&&Ga(n,r.config))return r;throw Qn.create("duplicate-app",{appName:s})}const i=new sw(s);for(const a of Ya.values())i.addComponent(a);const o=new Yw(t,n,i);return ji.set(s,o),o}function Zw(t=pf){const e=ji.get(t);if(!e)throw Qn.create("no-app",{appName:t});return e}function Cs(t,e,n){var s;let r=(s=Gw[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wn.warn(a.join(" "));return}Ki(new Dr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb="firebase-heartbeat-database",tb=1,Ar="firebase-heartbeat-store";let ma=null;function mf(){return ma||(ma=gw(eb,tb,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ar)}}}).catch(t=>{throw Qn.create("idb-open",{originalErrorMessage:t.message})})),ma}async function nb(t){var e;try{return(await mf()).transaction(Ar).objectStore(Ar).get(gf(t))}catch(n){if(n instanceof js)Wn.warn(n.message);else{const s=Qn.create("idb-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message});Wn.warn(s.message)}}}async function Ul(t,e){var n;try{const r=(await mf()).transaction(Ar,"readwrite");return await r.objectStore(Ar).put(e,gf(t)),r.done}catch(s){if(s instanceof js)Wn.warn(s.message);else{const r=Qn.create("idb-set",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message});Wn.warn(r.message)}}}function gf(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb=1024,rb=30*24*60*60*1e3;class ib{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ab(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ql();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const i=new Date(r.date).valueOf();return Date.now()-i<=rb}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ql(),{heartbeatsToSend:n,unsentEntries:s}=ob(this._heartbeatsCache.heartbeats),r=uf(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function ql(){return new Date().toISOString().substring(0,10)}function ob(t,e=sb){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),jl(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),jl(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class ab{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cf()?Yv().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await nb(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return Ul(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return Ul(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function jl(t){return uf(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ub(t){Ki(new Dr("platform-logger",e=>new ww(e),"PRIVATE")),Ki(new Dr("heartbeat",e=>new ib(e),"PRIVATE")),Cs(Qa,$l,t),Cs(Qa,$l,"esm2017"),Cs("fire-js","")}ub("");var cb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L,Hu=Hu||{},K=cb||self;function Hi(){}function Eo(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Hr(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function lb(t){return Object.prototype.hasOwnProperty.call(t,ga)&&t[ga]||(t[ga]=++hb)}var ga="closure_uid_"+(1e9*Math.random()>>>0),hb=0;function db(t,e,n){return t.call.apply(t.bind,arguments)}function fb(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Qe(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Qe=db:Qe=fb,Qe.apply(null,arguments)}function fi(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var s=n.slice();return s.push.apply(s,arguments),t.apply(this,s)}}function Ge(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function wn(){this.s=this.s,this.o=this.o}var pb=0;wn.prototype.s=!1;wn.prototype.na=function(){!this.s&&(this.s=!0,this.M(),pb!=0)&&lb(this)};wn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const yf=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Gu(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function Kl(t,e){for(let n=1;n<arguments.length;n++){const s=arguments[n];if(Eo(s)){const r=t.length||0,i=s.length||0;t.length=r+i;for(let o=0;o<i;o++)t[r+o]=s[o]}else t.push(s)}}function Ye(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Ye.prototype.h=function(){this.defaultPrevented=!0};var mb=function(){if(!K.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{K.addEventListener("test",Hi,e),K.removeEventListener("test",Hi,e)}catch{}return t}();function Gi(t){return/^[\s\xa0]*$/.test(t)}var Hl=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ya(t,e){return t<e?-1:t>e?1:0}function To(){var t=K.navigator;return t&&(t=t.userAgent)?t:""}function Rt(t){return To().indexOf(t)!=-1}function zu(t){return zu[" "](t),t}zu[" "]=Hi;function gb(t){var e=wb;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var yb=Rt("Opera"),Ms=Rt("Trident")||Rt("MSIE"),vf=Rt("Edge"),Xa=vf||Ms,wf=Rt("Gecko")&&!(To().toLowerCase().indexOf("webkit")!=-1&&!Rt("Edge"))&&!(Rt("Trident")||Rt("MSIE"))&&!Rt("Edge"),vb=To().toLowerCase().indexOf("webkit")!=-1&&!Rt("Edge");function bf(){var t=K.document;return t?t.documentMode:void 0}var zi;e:{var va="",wa=function(){var t=To();if(wf)return/rv:([^\);]+)(\)|;)/.exec(t);if(vf)return/Edge\/([\d\.]+)/.exec(t);if(Ms)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(vb)return/WebKit\/(\S+)/.exec(t);if(yb)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(wa&&(va=wa?wa[1]:""),Ms){var ba=bf();if(ba!=null&&ba>parseFloat(va)){zi=String(ba);break e}}zi=va}var wb={};function bb(){return gb(function(){let t=0;const e=Hl(String(zi)).split("."),n=Hl("9").split("."),s=Math.max(e.length,n.length);for(let o=0;t==0&&o<s;o++){var r=e[o]||"",i=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r[0].length==0&&i[0].length==0)break;t=ya(r[1].length==0?0:parseInt(r[1],10),i[1].length==0?0:parseInt(i[1],10))||ya(r[2].length==0,i[2].length==0)||ya(r[2],i[2]),r=r[3],i=i[3]}while(t==0)}return 0<=t})}var Ja;if(K.document&&Ms){var Gl=bf();Ja=Gl||parseInt(zi,10)||void 0}else Ja=void 0;var Ib=Ja;function Nr(t,e){if(Ye.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(wf){e:{try{zu(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Eb[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Nr.X.h.call(this)}}Ge(Nr,Ye);var Eb={2:"touch",3:"pen",4:"mouse"};Nr.prototype.h=function(){Nr.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Gr="closure_listenable_"+(1e6*Math.random()|0),Tb=0;function _b(t,e,n,s,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ha=r,this.key=++Tb,this.ba=this.ea=!1}function _o(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function Wu(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function If(t){const e={};for(const n in t)e[n]=t[n];return e}const zl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ef(t,e){let n,s;for(let r=1;r<arguments.length;r++){s=arguments[r];for(n in s)t[n]=s[n];for(let i=0;i<zl.length;i++)n=zl[i],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function xo(t){this.src=t,this.g={},this.h=0}xo.prototype.add=function(t,e,n,s,r){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=eu(t,e,s,r);return-1<o?(e=t[o],n||(e.ea=!1)):(e=new _b(e,this.src,i,!!s,r),e.ea=n,t.push(e)),e};function Za(t,e){var n=e.type;if(n in t.g){var s=t.g[n],r=yf(s,e),i;(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(_o(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function eu(t,e,n,s){for(var r=0;r<t.length;++r){var i=t[r];if(!i.ba&&i.listener==e&&i.capture==!!n&&i.ha==s)return r}return-1}var Qu="closure_lm_"+(1e6*Math.random()|0),Ia={};function Tf(t,e,n,s,r){if(s&&s.once)return xf(t,e,n,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)Tf(t,e[i],n,s,r);return null}return n=Ju(n),t&&t[Gr]?t.N(e,n,Hr(s)?!!s.capture:!!s,r):_f(t,e,n,!1,s,r)}function _f(t,e,n,s,r,i){if(!e)throw Error("Invalid event type");var o=Hr(r)?!!r.capture:!!r,a=Xu(t);if(a||(t[Qu]=a=new xo(t)),n=a.add(e,n,s,o,i),n.proxy)return n;if(s=xb(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)mb||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),s,r);else if(t.attachEvent)t.attachEvent(Sf(e.toString()),s);else if(t.addListener&&t.removeListener)t.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return n}function xb(){function t(n){return e.call(t.src,t.listener,n)}const e=Cb;return t}function xf(t,e,n,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)xf(t,e[i],n,s,r);return null}return n=Ju(n),t&&t[Gr]?t.O(e,n,Hr(s)?!!s.capture:!!s,r):_f(t,e,n,!0,s,r)}function Cf(t,e,n,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)Cf(t,e[i],n,s,r);else s=Hr(s)?!!s.capture:!!s,n=Ju(n),t&&t[Gr]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=eu(i,n,s,r),-1<n&&(_o(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=Xu(t))&&(e=t.g[e.toString()],t=-1,e&&(t=eu(e,n,s,r)),(n=-1<t?e[t]:null)&&Yu(n))}function Yu(t){if(typeof t!="number"&&t&&!t.ba){var e=t.src;if(e&&e[Gr])Za(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(Sf(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=Xu(e))?(Za(n,t),n.h==0&&(n.src=null,e[Qu]=null)):_o(t)}}}function Sf(t){return t in Ia?Ia[t]:Ia[t]="on"+t}function Cb(t,e){if(t.ba)t=!0;else{e=new Nr(e,this);var n=t.listener,s=t.ha||t.src;t.ea&&Yu(t),t=n.call(s,e)}return t}function Xu(t){return t=t[Qu],t instanceof xo?t:null}var Ea="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ju(t){return typeof t=="function"?t:(t[Ea]||(t[Ea]=function(e){return t.handleEvent(e)}),t[Ea])}function Le(){wn.call(this),this.i=new xo(this),this.P=this,this.I=null}Ge(Le,wn);Le.prototype[Gr]=!0;Le.prototype.removeEventListener=function(t,e,n,s){Cf(this,t,e,n,s)};function Ke(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,typeof e=="string")e=new Ye(e,t);else if(e instanceof Ye)e.target=e.target||t;else{var r=e;e=new Ye(s,t),Ef(e,r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];r=pi(o,s,!0,e)&&r}if(o=e.g=t,r=pi(o,s,!0,e)&&r,r=pi(o,s,!1,e)&&r,n)for(i=0;i<n.length;i++)o=e.g=n[i],r=pi(o,s,!1,e)&&r}Le.prototype.M=function(){if(Le.X.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)_o(n[s]);delete t.g[e],t.h--}}this.I=null};Le.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)};Le.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};function pi(t,e,n,s){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ba&&o.capture==n){var a=o.listener,u=o.ha||o.src;o.ea&&Za(t.i,o),r=a.call(u,s)!==!1&&r}}return r&&!s.defaultPrevented}var Zu=K.JSON.stringify;function Sb(){var t=Nf;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Db{constructor(){this.h=this.g=null}add(e,n){const s=Df.get();s.set(e,n),this.h?this.h.next=s:this.g=s,this.h=s}}var Df=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new Ab,t=>t.reset());class Ab{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function Nb(t){K.setTimeout(()=>{throw t},0)}function Af(t,e){tu||kb(),nu||(tu(),nu=!0),Nf.add(t,e)}var tu;function kb(){var t=K.Promise.resolve(void 0);tu=function(){t.then(Mb)}}var nu=!1,Nf=new Db;function Mb(){for(var t;t=Sb();){try{t.h.call(t.g)}catch(n){Nb(n)}var e=Df;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}nu=!1}function Co(t,e){Le.call(this),this.h=t||1,this.g=e||K,this.j=Qe(this.kb,this),this.l=Date.now()}Ge(Co,Le);L=Co.prototype;L.ca=!1;L.R=null;L.kb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Ke(this,"tick"),this.ca&&(ec(this),this.start()))}};L.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function ec(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}L.M=function(){Co.X.M.call(this),ec(this),delete this.g};function tc(t,e,n){if(typeof t=="function")n&&(t=Qe(t,n));else if(t&&typeof t.handleEvent=="function")t=Qe(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:K.setTimeout(t,e||0)}function kf(t){t.g=tc(()=>{t.g=null,t.i&&(t.i=!1,kf(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class Ob extends wn{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:kf(this)}M(){super.M(),this.g&&(K.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kr(t){wn.call(this),this.h=t,this.g={}}Ge(kr,wn);var Wl=[];function Mf(t,e,n,s){Array.isArray(n)||(n&&(Wl[0]=n.toString()),n=Wl);for(var r=0;r<n.length;r++){var i=Tf(e,n[r],s||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function Of(t){Wu(t.g,function(e,n){this.g.hasOwnProperty(n)&&Yu(e)},t),t.g={}}kr.prototype.M=function(){kr.X.M.call(this),Of(this)};kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function So(){this.g=!0}So.prototype.Aa=function(){this.g=!1};function Rb(t,e,n,s,r,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function Lb(t,e,n,s,r,i,o){t.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+`
`+n+`
`+i+" "+o})}function Is(t,e,n,s){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Fb(t,n)+(s?" "+s:"")})}function Pb(t,e){t.info(function(){return"TIMEOUT: "+e})}So.prototype.info=function(){};function Fb(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return Zu(n)}catch{return e}}var is={},Ql=null;function Do(){return Ql=Ql||new Le}is.Oa="serverreachability";function Rf(t){Ye.call(this,is.Oa,t)}Ge(Rf,Ye);function Mr(t){const e=Do();Ke(e,new Rf(e))}is.STAT_EVENT="statevent";function Lf(t,e){Ye.call(this,is.STAT_EVENT,t),this.stat=e}Ge(Lf,Ye);function et(t){const e=Do();Ke(e,new Lf(e,t))}is.Pa="timingevent";function Pf(t,e){Ye.call(this,is.Pa,t),this.size=e}Ge(Pf,Ye);function zr(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return K.setTimeout(function(){t()},e)}var Ao={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,La:7,TIMEOUT:8,Cb:9},Ff={qb:"complete",Mb:"success",Ma:"error",La:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function nc(){}nc.prototype.h=null;function Yl(t){return t.h||(t.h=t.i())}function Vf(){}var Wr={OPEN:"a",pb:"b",Ma:"c",Bb:"d"};function sc(){Ye.call(this,"d")}Ge(sc,Ye);function rc(){Ye.call(this,"c")}Ge(rc,Ye);var su;function No(){}Ge(No,nc);No.prototype.g=function(){return new XMLHttpRequest};No.prototype.i=function(){return{}};su=new No;function Qr(t,e,n,s){this.l=t,this.j=e,this.m=n,this.U=s||1,this.S=new kr(this),this.O=Vb,t=Xa?125:void 0,this.T=new Co(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Bf}function Bf(){this.i=null,this.g="",this.h=!1}var Vb=45e3,ru={},Wi={};L=Qr.prototype;L.setTimeout=function(t){this.O=t};function iu(t,e,n){t.K=1,t.v=Mo(Ht(e)),t.s=n,t.P=!0,$f(t,null)}function $f(t,e){t.F=Date.now(),Yr(t),t.A=Ht(t.v);var n=t.A,s=t.U;Array.isArray(s)||(s=[String(s)]),Wf(n.i,"t",s),t.C=0,n=t.l.H,t.h=new Bf,t.g=mp(t.l,n?e:null,!t.s),0<t.N&&(t.L=new Ob(Qe(t.Ka,t,t.g),t.N)),Mf(t.S,t.g,"readystatechange",t.hb),e=t.H?If(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),Mr(),Rb(t.j,t.u,t.A,t.m,t.U,t.s)}L.hb=function(t){t=t.target;const e=this.L;e&&qt(t)==3?e.l():this.Ka(t)};L.Ka=function(t){try{if(t==this.g)e:{const l=qt(this.g);var e=this.g.Ea();const h=this.g.aa();if(!(3>l)&&(l!=3||Xa||this.g&&(this.h.h||this.g.fa()||eh(this.g)))){this.I||l!=4||e==7||(e==8||0>=h?Mr(3):Mr(2)),ko(this);var n=this.g.aa();this.Y=n;t:if(Uf(this)){var s=eh(this.g);t="";var r=s.length,i=qt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qn(this),gr(this);var o="";break t}this.h.i=new K.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=n==200,Lb(this.j,this.u,this.A,this.m,this.U,l,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Gi(a)){var c=a;break t}}c=null}if(n=c)Is(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,ou(this,n);else{this.i=!1,this.o=3,et(12),qn(this),gr(this);break e}}this.P?(qf(this,l,o),Xa&&this.i&&l==3&&(Mf(this.S,this.T,"tick",this.gb),this.T.start())):(Is(this.j,this.m,o,null),ou(this,o)),l==4&&qn(this),this.i&&!this.I&&(l==4?hp(this.l,this):(this.i=!1,Yr(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,et(12)):(this.o=0,et(13)),qn(this),gr(this)}}}catch{}finally{}};function Uf(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Da:!1}function qf(t,e,n){let s=!0,r;for(;!t.I&&t.C<n.length;)if(r=Bb(t,n),r==Wi){e==4&&(t.o=4,et(14),s=!1),Is(t.j,t.m,null,"[Incomplete Response]");break}else if(r==ru){t.o=4,et(15),Is(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}else Is(t.j,t.m,r,null),ou(t,r);Uf(t)&&r!=Wi&&r!=ru&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,et(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.$&&(t.$=!0,e=t.l,e.g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),hc(e),e.K=!0,et(11))):(Is(t.j,t.m,n,"[Invalid Chunked Response]"),qn(t),gr(t))}L.gb=function(){if(this.g){var t=qt(this.g),e=this.g.fa();this.C<e.length&&(ko(this),qf(this,t,e),this.i&&t!=4&&Yr(this))}};function Bb(t,e){var n=t.C,s=e.indexOf(`
`,n);return s==-1?Wi:(n=Number(e.substring(n,s)),isNaN(n)?ru:(s+=1,s+n>e.length?Wi:(e=e.substr(s,n),t.C=s+n,e)))}L.cancel=function(){this.I=!0,qn(this)};function Yr(t){t.V=Date.now()+t.O,jf(t,t.O)}function jf(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=zr(Qe(t.fb,t),e)}function ko(t){t.B&&(K.clearTimeout(t.B),t.B=null)}L.fb=function(){this.B=null;const t=Date.now();0<=t-this.V?(Pb(this.j,this.A),this.K!=2&&(Mr(),et(17)),qn(this),this.o=2,gr(this)):jf(this,this.V-t)};function gr(t){t.l.G==0||t.I||hp(t.l,t)}function qn(t){ko(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,ec(t.T),Of(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function ou(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||au(n.h,t))){if(!t.J&&au(n.h,t)&&n.G==3){try{var s=n.Fa.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var r=s;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Xi(n),Lo(n);else break e;lc(n),et(18)}}else n.Ba=r[1],0<n.Ba-n.T&&37500>r[2]&&n.L&&n.A==0&&!n.v&&(n.v=zr(Qe(n.bb,n),6e3));if(1>=Xf(n.h)&&n.ja){try{n.ja()}catch{}n.ja=void 0}}else jn(n,11)}else if((t.J||n.g==t)&&Xi(n),!Gi(e))for(r=n.Fa.g.parse(e),e=0;e<r.length;e++){let c=r[e];if(n.T=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.I=c[1],n.ka=c[2];const l=c[3];l!=null&&(n.ma=l,n.j.info("VER="+n.ma));const h=c[4];h!=null&&(n.Ca=h,n.j.info("SVER="+n.Ca));const f=c[5];f!=null&&typeof f=="number"&&0<f&&(s=1.5*f,n.J=s,n.j.info("backChannelRequestTimeoutMs_="+s)),s=n;const m=t.g;if(m){const v=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(v){var i=s.h;i.g||v.indexOf("spdy")==-1&&v.indexOf("quic")==-1&&v.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(ic(i,i.h),i.h=null))}if(s.D){const D=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;D&&(s.za=D,we(s.F,s.D,D))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms")),s=n;var o=t;if(s.sa=pp(s,s.H?s.ka:null,s.V),o.J){Jf(s.h,o);var a=o,u=s.J;u&&a.setTimeout(u),a.B&&(ko(a),Yr(a)),s.g=o}else cp(s);0<n.i.length&&Po(n)}else c[0]!="stop"&&c[0]!="close"||jn(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?jn(n,7):cc(n):c[0]!="noop"&&n.l&&n.l.wa(c),n.A=0)}}Mr(4)}catch{}}function $b(t){if(t.W&&typeof t.W=="function")return t.W();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Eo(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}e=[],n=0;for(s in t)e[n++]=t[s];return e}function Ub(t){if(t.oa&&typeof t.oa=="function")return t.oa();if(!t.W||typeof t.W!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Eo(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const s in t)e[n++]=s;return e}}}function Kf(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Eo(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Ub(t),s=$b(t),r=s.length,i=0;i<r;i++)e.call(void 0,s[i],n&&n[i],t)}var Hf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qb(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),r=null;if(0<=s){var i=t[n].substring(0,s);r=t[n].substring(s+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Gn(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Gn){this.h=e!==void 0?e:t.h,Qi(this,t.j),this.s=t.s,this.g=t.g,Yi(this,t.m),this.l=t.l,e=t.i;var n=new Or;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Xl(this,n),this.o=t.o}else t&&(n=String(t).match(Hf))?(this.h=!!e,Qi(this,n[1]||"",!0),this.s=ur(n[2]||""),this.g=ur(n[3]||"",!0),Yi(this,n[4]),this.l=ur(n[5]||"",!0),Xl(this,n[6]||"",!0),this.o=ur(n[7]||"")):(this.h=!!e,this.i=new Or(null,this.h))}Gn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(cr(e,Jl,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(cr(e,Jl,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(cr(n,n.charAt(0)=="/"?Hb:Kb,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",cr(n,zb)),t.join("")};function Ht(t){return new Gn(t)}function Qi(t,e,n){t.j=n?ur(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Yi(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Xl(t,e,n){e instanceof Or?(t.i=e,Wb(t.i,t.h)):(n||(e=cr(e,Gb)),t.i=new Or(e,t.h))}function we(t,e,n){t.i.set(e,n)}function Mo(t){return we(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ur(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cr(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,jb),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function jb(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Jl=/[#\/\?@]/g,Kb=/[#\?:]/g,Hb=/[#\?]/g,Gb=/[#\?@]/g,zb=/#/g;function Or(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function bn(t){t.g||(t.g=new Map,t.h=0,t.i&&qb(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}L=Or.prototype;L.add=function(t,e){bn(this),this.i=null,t=Ks(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Gf(t,e){bn(t),e=Ks(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function zf(t,e){return bn(t),e=Ks(t,e),t.g.has(e)}L.forEach=function(t,e){bn(this),this.g.forEach(function(n,s){n.forEach(function(r){t.call(e,r,s,this)},this)},this)};L.oa=function(){bn(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let s=0;s<e.length;s++){const r=t[s];for(let i=0;i<r.length;i++)n.push(e[s])}return n};L.W=function(t){bn(this);let e=[];if(typeof t=="string")zf(this,t)&&(e=e.concat(this.g.get(Ks(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};L.set=function(t,e){return bn(this),this.i=null,t=Ks(this,t),zf(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};L.get=function(t,e){return t?(t=this.W(t),0<t.length?String(t[0]):e):e};function Wf(t,e,n){Gf(t,e),0<n.length&&(t.i=null,t.g.set(Ks(t,e),Gu(n)),t.h+=n.length)}L.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var s=e[n];const i=encodeURIComponent(String(s)),o=this.W(s);for(s=0;s<o.length;s++){var r=i;o[s]!==""&&(r+="="+encodeURIComponent(String(o[s]))),t.push(r)}}return this.i=t.join("&")};function Ks(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Wb(t,e){e&&!t.j&&(bn(t),t.i=null,t.g.forEach(function(n,s){var r=s.toLowerCase();s!=r&&(Gf(this,s),Wf(this,r,n))},t)),t.j=e}var Qb=class{constructor(t,e){this.h=t,this.g=e}};function Qf(t){this.l=t||Yb,K.PerformanceNavigationTiming?(t=K.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(K.g&&K.g.Ga&&K.g.Ga()&&K.g.Ga().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Yb=10;function Yf(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Xf(t){return t.h?1:t.g?t.g.size:0}function au(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function ic(t,e){t.g?t.g.add(e):t.h=e}function Jf(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}Qf.prototype.cancel=function(){if(this.i=Zf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function Zf(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return Gu(t.i)}function oc(){}oc.prototype.stringify=function(t){return K.JSON.stringify(t,void 0)};oc.prototype.parse=function(t){return K.JSON.parse(t,void 0)};function Xb(){this.g=new oc}function Jb(t,e,n){const s=n||"";try{Kf(t,function(r,i){let o=r;Hr(r)&&(o=Zu(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function Zb(t,e){const n=new So;if(K.Image){const s=new Image;s.onload=fi(mi,n,s,"TestLoadImage: loaded",!0,e),s.onerror=fi(mi,n,s,"TestLoadImage: error",!1,e),s.onabort=fi(mi,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=fi(mi,n,s,"TestLoadImage: timeout",!1,e),K.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else e(!1)}function mi(t,e,n,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function Xr(t){this.l=t.$b||null,this.j=t.ib||!1}Ge(Xr,nc);Xr.prototype.g=function(){return new Oo(this.l,this.j)};Xr.prototype.i=function(t){return function(){return t}}({});function Oo(t,e){Le.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=ac,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ge(Oo,Le);var ac=0;L=Oo.prototype;L.open=function(t,e){if(this.readyState!=ac)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Rr(this)};L.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||K).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ga.bind(this))};L.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jr(this)),this.readyState=ac};L.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Rr(this)),this.g&&(this.readyState=3,Rr(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ga.bind(this));else if(typeof K.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ep(this)}else t.text().then(this.Ua.bind(this),this.ga.bind(this))};function ep(t){t.j.read().then(t.Sa.bind(t)).catch(t.ga.bind(t))}L.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Jr(this):Rr(this),this.readyState==3&&ep(this)}};L.Ua=function(t){this.g&&(this.response=this.responseText=t,Jr(this))};L.Ta=function(t){this.g&&(this.response=t,Jr(this))};L.ga=function(){this.g&&Jr(this)};function Jr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Rr(t)}L.setRequestHeader=function(t,e){this.v.append(t,e)};L.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};L.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Rr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Oo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var e0=K.JSON.parse;function Ae(t){Le.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=tp,this.K=this.L=!1}Ge(Ae,Le);var tp="",t0=/^https?$/i,n0=["POST","PUT"];L=Ae.prototype;L.da=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():su.g(),this.C=this.u?Yl(this.u):Yl(su),this.g.onreadystatechange=Qe(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){Zl(this,i);return}if(t=n||"",n=new Map(this.headers),s)if(Object.getPrototypeOf(s)===Object.prototype)for(var r in s)n.set(r,s[r]);else if(typeof s.keys=="function"&&typeof s.get=="function")for(const i of s.keys())n.set(i,s.get(i));else throw Error("Unknown input type for opt_headers: "+String(s));s=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),r=K.FormData&&t instanceof K.FormData,!(0<=yf(n0,e))||s||r||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{rp(this),0<this.B&&((this.K=s0(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Qe(this.qa,this)):this.A=tc(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Zl(this,i)}};function s0(t){return Ms&&bb()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}L.qa=function(){typeof Hu<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ke(this,"timeout"),this.abort(8))};function Zl(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,np(t),Ro(t)}function np(t){t.D||(t.D=!0,Ke(t,"complete"),Ke(t,"error"))}L.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ke(this,"complete"),Ke(this,"abort"),Ro(this))};L.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ro(this,!0)),Ae.X.M.call(this)};L.Ha=function(){this.s||(this.F||this.v||this.l?sp(this):this.eb())};L.eb=function(){sp(this)};function sp(t){if(t.h&&typeof Hu<"u"&&(!t.C[1]||qt(t)!=4||t.aa()!=2)){if(t.v&&qt(t)==4)tc(t.Ha,0,t);else if(Ke(t,"readystatechange"),qt(t)==4){t.h=!1;try{const a=t.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var s;if(s=a===0){var r=String(t.H).match(Hf)[1]||null;if(!r&&K.self&&K.self.location){var i=K.self.location.protocol;r=i.substr(0,i.length-1)}s=!t0.test(r?r.toLowerCase():"")}n=s}if(n)Ke(t,"complete"),Ke(t,"success");else{t.m=6;try{var o=2<qt(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.aa()+"]",np(t)}}finally{Ro(t)}}}}function Ro(t,e){if(t.g){rp(t);const n=t.g,s=t.C[0]?Hi:null;t.g=null,t.C=null,e||Ke(t,"ready");try{n.onreadystatechange=s}catch{}}}function rp(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(K.clearTimeout(t.A),t.A=null)}function qt(t){return t.g?t.g.readyState:0}L.aa=function(){try{return 2<qt(this)?this.g.status:-1}catch{return-1}};L.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}};L.Ra=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),e0(e)}};function eh(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case tp:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}L.Ea=function(){return this.m};L.Na=function(){return typeof this.j=="string"?this.j:String(this.j)};function ip(t){let e="";return Wu(t,function(n,s){e+=s,e+=":",e+=n,e+=`\r
`}),e}function uc(t,e,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=ip(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):we(t,e,n))}function Zs(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function op(t){this.Ca=0,this.i=[],this.j=new So,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.$a=this.U=0,this.Ya=Zs("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Wa=Zs("baseRetryDelayMs",5e3,t),this.ab=Zs("retryDelaySeedMs",1e4,t),this.Za=Zs("forwardChannelMaxRetries",2,t),this.ta=Zs("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Yb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new Qf(t&&t.concurrentRequestLimit),this.Fa=new Xb,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Xa=t&&t.Wb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}L=op.prototype;L.ma=8;L.G=1;function cc(t){if(ap(t),t.G==3){var e=t.U++,n=Ht(t.F);we(n,"SID",t.I),we(n,"RID",e),we(n,"TYPE","terminate"),Zr(t,n),e=new Qr(t,t.j,e,void 0),e.K=2,e.v=Mo(Ht(n)),n=!1,K.navigator&&K.navigator.sendBeacon&&(n=K.navigator.sendBeacon(e.v.toString(),"")),!n&&K.Image&&(new Image().src=e.v,n=!0),n||(e.g=mp(e.l,null),e.g.da(e.v)),e.F=Date.now(),Yr(e)}fp(t)}function Lo(t){t.g&&(hc(t),t.g.cancel(),t.g=null)}function ap(t){Lo(t),t.u&&(K.clearTimeout(t.u),t.u=null),Xi(t),t.h.cancel(),t.m&&(typeof t.m=="number"&&K.clearTimeout(t.m),t.m=null)}function Po(t){Yf(t.h)||t.m||(t.m=!0,Af(t.Ja,t),t.C=0)}function r0(t,e){return Xf(t.h)>=t.h.j-(t.m?1:0)?!1:t.m?(t.i=e.D.concat(t.i),!0):t.G==1||t.G==2||t.C>=(t.Ya?0:t.Za)?!1:(t.m=zr(Qe(t.Ja,t,e),dp(t,t.C)),t.C++,!0)}L.Ja=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const r=new Qr(this,this.j,t,void 0);let i=this.s;if(this.S&&(i?(i=If(i),Ef(i,this.S)):i=this.S),this.o!==null||this.N||(r.H=i,i=null),this.O)e:{for(var e=0,n=0;n<this.i.length;n++){t:{var s=this.i[n];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=n;break e}if(e===4096||n===this.i.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=up(this,r,e),n=Ht(this.F),we(n,"RID",t),we(n,"CVER",22),this.D&&we(n,"X-HTTP-Session-Id",this.D),Zr(this,n),i&&(this.N?e="headers="+encodeURIComponent(String(ip(i)))+"&"+e:this.o&&uc(n,this.o,i)),ic(this.h,r),this.Xa&&we(n,"TYPE","init"),this.O?(we(n,"$req",e),we(n,"SID","null"),r.Z=!0,iu(r,n,null)):iu(r,n,e),this.G=2}}else this.G==3&&(t?th(this,t):this.i.length==0||Yf(this.h)||th(this))};function th(t,e){var n;e?n=e.m:n=t.U++;const s=Ht(t.F);we(s,"SID",t.I),we(s,"RID",n),we(s,"AID",t.T),Zr(t,s),t.o&&t.s&&uc(s,t.o,t.s),n=new Qr(t,t.j,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=up(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),ic(t.h,n),iu(n,s,e)}function Zr(t,e){t.ia&&Wu(t.ia,function(n,s){we(e,s,n)}),t.l&&Kf({},function(n,s){we(e,s,n)})}function up(t,e,n){n=Math.min(t.i.length,n);var s=t.l?Qe(t.l.Qa,t.l,t):null;e:{var r=t.i;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=r[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let u=0;u<n;u++){let c=r[u].h;const l=r[u].g;if(c-=i,0>c)i=Math.max(0,r[u].h-100),a=!1;else try{Jb(l,o,"req"+c+"_")}catch{s&&s(l)}}if(a){s=o.join("&");break e}}}return t=t.i.splice(0,n),e.D=t,s}function cp(t){t.g||t.u||(t.Z=1,Af(t.Ia,t),t.A=0)}function lc(t){return t.g||t.u||3<=t.A?!1:(t.Z++,t.u=zr(Qe(t.Ia,t),dp(t,t.A)),t.A++,!0)}L.Ia=function(){if(this.u=null,lp(this),this.$&&!(this.K||this.g==null||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=zr(Qe(this.cb,this),t)}};L.cb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,et(10),Lo(this),lp(this))};function hc(t){t.B!=null&&(K.clearTimeout(t.B),t.B=null)}function lp(t){t.g=new Qr(t,t.j,"rpc",t.Z),t.o===null&&(t.g.H=t.s),t.g.N=0;var e=Ht(t.sa);we(e,"RID","rpc"),we(e,"SID",t.I),we(e,"CI",t.L?"0":"1"),we(e,"AID",t.T),we(e,"TYPE","xmlhttp"),Zr(t,e),t.o&&t.s&&uc(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=Mo(Ht(e)),n.s=null,n.P=!0,$f(n,t)}L.bb=function(){this.v!=null&&(this.v=null,Lo(this),lc(this),et(19))};function Xi(t){t.v!=null&&(K.clearTimeout(t.v),t.v=null)}function hp(t,e){var n=null;if(t.g==e){Xi(t),hc(t),t.g=null;var s=2}else if(au(t.h,e))n=e.D,Jf(t.h,e),s=1;else return;if(t.G!=0){if(t.pa=e.Y,e.i)if(s==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;s=Do(),Ke(s,new Pf(s,n)),Po(t)}else cp(t);else if(r=e.o,r==3||r==0&&0<t.pa||!(s==1&&r0(t,e)||s==2&&lc(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),r){case 1:jn(t,5);break;case 4:jn(t,10);break;case 3:jn(t,6);break;default:jn(t,2)}}}function dp(t,e){let n=t.Wa+Math.floor(Math.random()*t.ab);return t.l||(n*=2),n*e}function jn(t,e){if(t.j.info("Error code "+e),e==2){var n=null;t.l&&(n=null);var s=Qe(t.jb,t);n||(n=new Gn("//www.google.com/images/cleardot.gif"),K.location&&K.location.protocol=="http"||Qi(n,"https"),Mo(n)),Zb(n.toString(),s)}else et(2);t.G=0,t.l&&t.l.va(e),fp(t),ap(t)}L.jb=function(t){t?(this.j.info("Successfully pinged google.com"),et(2)):(this.j.info("Failed to ping google.com"),et(1))};function fp(t){if(t.G=0,t.la=[],t.l){const e=Zf(t.h);(e.length!=0||t.i.length!=0)&&(Kl(t.la,e),Kl(t.la,t.i),t.h.i.length=0,Gu(t.i),t.i.length=0),t.l.ua()}}function pp(t,e,n){var s=n instanceof Gn?Ht(n):new Gn(n,void 0);if(s.g!="")e&&(s.g=e+"."+s.g),Yi(s,s.m);else{var r=K.location;s=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var i=new Gn(null,void 0);s&&Qi(i,s),e&&(i.g=e),r&&Yi(i,r),n&&(i.l=n),s=i}return n=t.D,e=t.za,n&&e&&we(s,n,e),we(s,"VER",t.ma),Zr(t,s),s}function mp(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Da&&!t.ra?new Ae(new Xr({ib:!0})):new Ae(t.ra),e.L=t.H,e}function gp(){}L=gp.prototype;L.xa=function(){};L.wa=function(){};L.va=function(){};L.ua=function(){};L.Qa=function(){};function Ji(){if(Ms&&!(10<=Number(Ib)))throw Error("Environmental error: no available transport.")}Ji.prototype.g=function(t,e){return new ft(t,e)};function ft(t,e){Le.call(this),this.g=new op(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Xb)&&!Gi(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Gi(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Hs(this)}Ge(ft,Le);ft.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;et(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=pp(t,null,t.V),Po(t)};ft.prototype.close=function(){cc(this.g)};ft.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Zu(t),t=n);e.i.push(new Qb(e.$a++,t)),e.G==3&&Po(e)};ft.prototype.M=function(){this.g.l=null,delete this.j,cc(this.g),delete this.g,ft.X.M.call(this)};function yp(t){sc.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ge(yp,sc);function vp(){rc.call(this),this.status=1}Ge(vp,rc);function Hs(t){this.g=t}Ge(Hs,gp);Hs.prototype.xa=function(){Ke(this.g,"a")};Hs.prototype.wa=function(t){Ke(this.g,new yp(t))};Hs.prototype.va=function(t){Ke(this.g,new vp)};Hs.prototype.ua=function(){Ke(this.g,"b")};Ji.prototype.createWebChannel=Ji.prototype.g;ft.prototype.send=ft.prototype.u;ft.prototype.open=ft.prototype.m;ft.prototype.close=ft.prototype.close;Ao.NO_ERROR=0;Ao.TIMEOUT=8;Ao.HTTP_ERROR=6;Ff.COMPLETE="complete";Vf.EventType=Wr;Wr.OPEN="a";Wr.CLOSE="b";Wr.ERROR="c";Wr.MESSAGE="d";Le.prototype.listen=Le.prototype.N;Ae.prototype.listenOnce=Ae.prototype.O;Ae.prototype.getLastError=Ae.prototype.Na;Ae.prototype.getLastErrorCode=Ae.prototype.Ea;Ae.prototype.getStatus=Ae.prototype.aa;Ae.prototype.getResponseJson=Ae.prototype.Ra;Ae.prototype.getResponseText=Ae.prototype.fa;Ae.prototype.send=Ae.prototype.da;var i0=function(){return new Ji},o0=function(){return Do()},Ta=Ao,a0=Ff,u0=is,nh={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},c0=Xr,gi=Vf,l0=Ae;const sh="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Je.UNAUTHENTICATED=new Je(null),Je.GOOGLE_CREDENTIALS=new Je("google-credentials-uid"),Je.FIRST_PARTY=new Je("first-party-uid"),Je.MOCK_USER=new Je("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gs="9.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn=new hf("@firebase/firestore");function uu(){return Yn.logLevel}function _(t,...e){if(Yn.logLevel<=re.DEBUG){const n=e.map(dc);Yn.debug(`Firestore (${Gs}): ${t}`,...n)}}function Ze(t,...e){if(Yn.logLevel<=re.ERROR){const n=e.map(dc);Yn.error(`Firestore (${Gs}): ${t}`,...n)}}function cu(t,...e){if(Yn.logLevel<=re.WARN){const n=e.map(dc);Yn.warn(`Firestore (${Gs}): ${t}`,...n)}}function dc(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P(t="Unexpected state"){const e=`FIRESTORE (${Gs}) INTERNAL ASSERTION FAILED: `+t;throw Ze(e),new Error(e)}function G(t,e){t||P()}function z(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class R extends js{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class d0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Je.UNAUTHENTICATED))}shutdown(){}}class f0{constructor(e){this.t=e,this.currentUser=Je.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const r=u=>this.i!==s?(s=this.i,n(u)):Promise.resolve();let i=new Ft;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ft,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await r(this.currentUser)})},a=u=>{_("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(_("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ft)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(_("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(G(typeof s.accessToken=="string"),new h0(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return G(e===null||typeof e=="string"),new Je(e)}}class p0{constructor(e,n,s,r){this.h=e,this.l=n,this.m=s,this.g=r,this.type="FirstParty",this.user=Je.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(G(!(typeof this.h!="object"||this.h===null||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class m0{constructor(e,n,s,r){this.h=e,this.l=n,this.m=s,this.g=r}getToken(){return Promise.resolve(new p0(this.h,this.l,this.m,this.g))}start(e,n){e.enqueueRetryable(()=>n(Je.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class g0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class y0{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,n){const s=i=>{i.error!=null&&_("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,_("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{_("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?r(i):_("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(G(typeof n.token=="string"),this.A=n.token,new g0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=v0(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function X(t,e){return t<e?-1:t>e?1:0}function Os(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}function bp(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new R(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new R(w.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new R(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new R(w.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Te.fromMillis(Date.now())}static fromDate(e){return Te.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new Te(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.timestamp=e}static fromTimestamp(e){return new q(e)}static min(){return new q(new Te(0,0))}static max(){return new q(new Te(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,n,s){n===void 0?n=0:n>e.length&&P(),s===void 0?s=e.length-n:s>e.length-n&&P(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Lr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Lr?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ce extends Lr{construct(e,n,s){return new ce(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new R(w.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new ce(n)}static emptyPath(){return new ce([])}}const w0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Se extends Lr{construct(e,n,s){return new Se(e,n,s)}static isValidIdentifier(e){return w0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Se.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Se(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new R(w.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new R(w.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[r+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new R(w.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=u,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new R(w.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Se(n)}static emptyPath(){return new Se([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.path=e}static fromPath(e){return new N(ce.fromString(e))}static fromName(e){return new N(ce.fromString(e).popFirst(5))}static empty(){return new N(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new N(new ce(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e,n,s,r){this.indexId=e,this.collectionGroup=n,this.fields=s,this.indexState=r}}function lu(t){return t.fields.find(e=>e.kind===2)}function Mn(t){return t.fields.filter(e=>e.kind!==2)}Ip.UNKNOWN_ID=-1;class b0{constructor(e,n){this.fieldPath=e,this.kind=n}}class Zi{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Zi(0,pt.min())}}function I0(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=q.fromTimestamp(s===1e9?new Te(n+1,0):new Te(n,s));return new pt(r,N.empty(),e)}function Ep(t){return new pt(t.readTime,t.key,-1)}class pt{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new pt(q.min(),N.empty(),-1)}static max(){return new pt(q.max(),N.empty(),-1)}}function fc(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=N.comparator(t.documentKey,e.documentKey),n!==0?n:X(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _p{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function os(t){if(t.code!==w.FAILED_PRECONDITION||t.message!==Tp)throw t;_("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&P(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new g((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof g?n:g.resolve(n)}catch(n){return g.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):g.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):g.reject(n)}static resolve(e){return new g((n,s)=>{n(e)})}static reject(e){return new g((n,s)=>{s(e)})}static waitFor(e){return new g((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},u=>s(u))}),o=!0,i===r&&n()})}static or(e){let n=g.resolve(!1);for(const s of e)n=n.next(r=>r?g.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new g((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const c=u;n(e[c]).next(l=>{o[c]=l,++a,a===i&&s(o)},l=>r(l))}})}static doWhile(e,n){return new g((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.P=new Ft,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{n.error?this.P.reject(new yr(e,n.error)):this.P.resolve()},this.transaction.onerror=s=>{const r=pc(s.target.error);this.P.reject(new yr(e,r))}}static open(e,n,s,r){try{return new Fo(n,e.transaction(r,s))}catch(i){throw new yr(n,i)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(_("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new T0(n)}}class jt{constructor(e,n,s){this.name=e,this.version=n,this.S=s,jt.D(Ha())===12.2&&Ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return _("SimpleDb","Removing database:",e),Ln(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!cf())return!1;if(jt.N())return!0;const e=Ha(),n=jt.D(e),s=0<n&&n<10,r=jt.k(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static N(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.M)==="YES"}static O(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static k(e){const n=e.match(/Android ([\d.]+)/i),s=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(s)}async F(e){return this.db||(_("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;n(o)},r.onblocked=()=>{s(new yr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new R(w.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new R(w.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new yr(e,o))},r.onupgradeneeded=i=>{_("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.S.$(o,r.transaction,i.oldVersion,this.version).next(()=>{_("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,r){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.F(e);const a=Fo.open(this.db,e,i?"readonly":"readwrite",s),u=r(a).next(c=>(a.V(),c)).catch(c=>(a.abort(c),g.reject(c))).toPromise();return u.catch(()=>{}),await a.v,u}catch(a){const u=a,c=u.name!=="FirebaseError"&&o<3;if(_("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}class E0{constructor(e){this.U=e,this.q=!1,this.K=null}get isDone(){return this.q}get G(){return this.K}set cursor(e){this.U=e}done(){this.q=!0}j(e){this.K=e}delete(){return Ln(this.U.delete())}}class yr extends R{constructor(e,n){super(w.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function In(t){return t.name==="IndexedDbTransactionError"}class T0{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(_("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(_("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Ln(s)}add(e){return _("SimpleDb","ADD",this.store.name,e,e),Ln(this.store.add(e))}get(e){return Ln(this.store.get(e)).next(n=>(n===void 0&&(n=null),_("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return _("SimpleDb","DELETE",this.store.name,e),Ln(this.store.delete(e))}count(){return _("SimpleDb","COUNT",this.store.name),Ln(this.store.count())}W(e,n){const s=this.options(e,n);if(s.index||typeof this.store.getAll!="function"){const r=this.cursor(s),i=[];return this.H(r,(o,a)=>{i.push(a)}).next(()=>i)}{const r=this.store.getAll(s.range);return new g((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}}J(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new g((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}Y(e,n){_("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.X=!1;const r=this.cursor(s);return this.H(r,(i,o,a)=>a.delete())}Z(e,n){let s;n?s=e:(s={},n=e);const r=this.cursor(s);return this.H(r,n)}tt(e){const n=this.cursor({});return new g((s,r)=>{n.onerror=i=>{const o=pc(i.target.error);r(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():s()}):s()}})}H(e,n){const s=[];return new g((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const u=new E0(a),c=n(a.primaryKey,a.value,u);if(c instanceof g){const l=c.catch(h=>(u.done(),g.reject(h)));s.push(l)}u.isDone?r():u.G===null?a.continue():a.continue(u.G)}}).next(()=>g.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.X?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ln(t){return new g((e,n)=>{t.onsuccess=s=>{const r=s.target.result;e(r)},t.onerror=s=>{const r=pc(s.target.error);n(r)}})}let rh=!1;function pc(t){const e=jt.D(Ha());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new R("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rh||(rh=!0,setTimeout(()=>{throw s},0)),s}}return t}class _0{constructor(e,n){this.asyncQueue=e,this.et=n,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}nt(e){_("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{_("IndexBackiller",`Documents written: ${await this.et.st()}`)}catch(n){In(n)?_("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await os(n)}await this.nt(6e4)})}}class x0{constructor(e,n){this.localStore=e,this.persistence=n}async st(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.it(n,e))}it(e,n){const s=new Set;let r=n,i=!0;return g.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return _("IndexBackiller",`Processing collection: ${o}`),this.rt(e,o,r).next(a=>{r-=a,s.add(o)});i=!1})).next(()=>n-r)}rt(e,n,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ot(r,i)).next(a=>(_("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ot(e,n){let s=e;return n.changes.forEach((r,i)=>{const o=Ep(i);fc(o,s)>0&&(s=o)}),new pt(s.readTime,s.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ut(s),this.ct=s=>n.writeSequenceNumber(s))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function as(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xp(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wt.at=-1;class Ne{constructor(e,n){this.comparator=e,this.root=n||Ue.EMPTY}insert(e,n){return new Ne(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ue.BLACK,null,null))}remove(e){return new Ne(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ue.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yi(this.root,e,this.comparator,!1)}getReverseIterator(){return new yi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yi(this.root,e,this.comparator,!0)}}class yi{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ue{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:Ue.RED,this.left=r!=null?r:Ue.EMPTY,this.right=i!=null?i:Ue.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Ue(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ue.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Ue.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ue.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ue.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw P();const e=this.left.check();if(e!==this.right.check())throw P();return e+(this.isRed()?0:1)}}Ue.EMPTY=null,Ue.RED=!0,Ue.BLACK=!1;Ue.EMPTY=new class{constructor(){this.size=0}get key(){throw P()}get value(){throw P()}get color(){throw P()}get left(){throw P()}get right(){throw P()}copy(t,e,n,s,r){return this}insert(t,e,n){return new Ue(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.comparator=e,this.data=new Ne(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new oh(this.data.getIterator())}getIteratorFrom(e){return new oh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof le)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new le(this.comparator);return n.data=e,n}}class oh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ps(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.fields=e,e.sort(Se.comparator)}static empty(){return new ct([])}unionWith(e){let n=new le(Se.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new ct(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Os(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new Pe(n)}static fromUint8Array(e){const n=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new Pe(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pe.EMPTY_BYTE_STRING=new Pe("");const C0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pn(t){if(G(!!t),typeof t=="string"){let e=0;const n=C0.exec(t);if(G(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:xe(t.seconds),nanos:xe(t.nanos)}}function xe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Xn(t){return typeof t=="string"?Pe.fromBase64String(t):Pe.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Sp(t){const e=t.mapValue.fields.__previous_value__;return Cp(e)?Sp(e):e}function Pr(t){const e=pn(t.mapValue.fields.__local_write_time__.timestampValue);return new Te(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,n,s,r,i,o,a,u){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=u}}class Jn{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Jn("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Jn&&e.projectId===this.projectId&&e.database===this.database}}function Vo(t){return t==null}function Fr(t){return t===0&&1/t==-1/0}function D0(t){return typeof t=="number"&&Number.isInteger(t)&&!Fr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Di={nullValue:"NULL_VALUE"};function Zn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Cp(t)?4:Dp(t)?9007199254740991:10:P()}function Vt(t,e){if(t===e)return!0;const n=Zn(t);if(n!==Zn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Pr(t).isEqual(Pr(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=pn(s.timestampValue),o=pn(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,r){return Xn(s.bytesValue).isEqual(Xn(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,r){return xe(s.geoPointValue.latitude)===xe(r.geoPointValue.latitude)&&xe(s.geoPointValue.longitude)===xe(r.geoPointValue.longitude)}(t,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return xe(s.integerValue)===xe(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=xe(s.doubleValue),o=xe(r.doubleValue);return i===o?Fr(i)===Fr(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Os(t.arrayValue.values||[],e.arrayValue.values||[],Vt);case 10:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(ih(i)!==ih(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!Vt(i[a],o[a])))return!1;return!0}(t,e);default:return P()}}function Vr(t,e){return(t.values||[]).find(n=>Vt(n,e))!==void 0}function mn(t,e){if(t===e)return 0;const n=Zn(t),s=Zn(e);if(n!==s)return X(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return X(t.booleanValue,e.booleanValue);case 2:return function(r,i){const o=xe(r.integerValue||r.doubleValue),a=xe(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return ah(t.timestampValue,e.timestampValue);case 4:return ah(Pr(t),Pr(e));case 5:return X(t.stringValue,e.stringValue);case 6:return function(r,i){const o=Xn(r),a=Xn(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let u=0;u<o.length&&u<a.length;u++){const c=X(o[u],a[u]);if(c!==0)return c}return X(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,i){const o=X(xe(r.latitude),xe(i.latitude));return o!==0?o:X(xe(r.longitude),xe(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,i){const o=r.values||[],a=i.values||[];for(let u=0;u<o.length&&u<a.length;++u){const c=mn(o[u],a[u]);if(c)return c}return X(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,i){if(r===rn.mapValue&&i===rn.mapValue)return 0;if(r===rn.mapValue)return 1;if(i===rn.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),u=i.fields||{},c=Object.keys(u);a.sort(),c.sort();for(let l=0;l<a.length&&l<c.length;++l){const h=X(a[l],c[l]);if(h!==0)return h;const f=mn(o[a[l]],u[c[l]]);if(f!==0)return f}return X(a.length,c.length)}(t.mapValue,e.mapValue);default:throw P()}}function ah(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return X(t,e);const n=pn(t),s=pn(e),r=X(n.seconds,s.seconds);return r!==0?r:X(n.nanos,s.nanos)}function Ss(t){return hu(t)}function hu(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const r=pn(s);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Xn(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,N.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(s){let r="[",i=!0;for(const o of s.values||[])i?i=!1:r+=",",r+=hu(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${hu(s.fields[a])}`;return i+"}"}(t.mapValue):P();var e,n}function mc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function du(t){return!!t&&"integerValue"in t}function Br(t){return!!t&&"arrayValue"in t}function uh(t){return!!t&&"nullValue"in t}function ch(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ai(t){return!!t&&"mapValue"in t}function vr(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return as(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=vr(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=vr(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Dp(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function A0(t){return"nullValue"in t?Di:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?mc(Jn.empty(),N.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:P()}function N0(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?mc(Jn.empty(),N.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?rn:P()}function lh(t,e){const n=mn(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function hh(t,e){const n=mn(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e){this.value=e}static empty(){return new ze({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Ai(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=vr(n)}setAll(e){let n=Se.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const u=this.getFieldsMap(n);this.applyChanges(u,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=vr(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Ai(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Vt(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Ai(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){as(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new ze(vr(this.value))}}function Ap(t){const e=[];return as(t.fields,(n,s)=>{const r=new Se([n]);if(Ai(s)){const i=Ap(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new ct(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e,n,s,r,i,o){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Ee(e,0,q.min(),q.min(),ze.empty(),0)}static newFoundDocument(e,n,s){return new Ee(e,1,n,q.min(),s,0)}static newNoDocument(e,n){return new Ee(e,2,n,q.min(),ze.empty(),0)}static newUnknownDocument(e,n){return new Ee(e,3,n,q.min(),ze.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=q.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ee&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ee(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ht=null}}function dh(t,e=null,n=[],s=[],r=null,i=null,o=null){return new k0(t,e,n,s,r,i,o)}function es(t){const e=z(t);if(e.ht===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>{return(r=s).field.canonicalString()+r.op.toString()+Ss(r.value);var r}).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),Vo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>Ss(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>Ss(s)).join(",")),e.ht=n}return e.ht}function M0(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(s=n).field.canonicalString()} ${s.op} ${Ss(s.value)}`;var s}).join(", ")}]`),Vo(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>Ss(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>Ss(n)).join(",")),`Target(${e})`}function ei(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!$0(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!Vt(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gh(t.startAt,e.startAt)&&gh(t.endAt,e.endAt)}function eo(t){return N.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function to(t,e){return t.filters.filter(n=>n instanceof We&&n.field.isEqual(e))}function fh(t,e,n){let s=Di,r=!0;for(const i of to(t,e)){let o=Di,a=!0;switch(i.op){case"<":case"<=":o=A0(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Di}lh({value:s,inclusive:r},{value:o,inclusive:a})<0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];lh({value:s,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}function ph(t,e,n){let s=rn,r=!0;for(const i of to(t,e)){let o=rn,a=!0;switch(i.op){case">=":case">":o=N0(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=rn}hh({value:s,inclusive:r},{value:o,inclusive:a})>0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];hh({value:s,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}class We extends class{}{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.lt(e,n,s):new O0(e,n,s):n==="array-contains"?new P0(e,s):n==="in"?new F0(e,s):n==="not-in"?new V0(e,s):n==="array-contains-any"?new B0(e,s):new We(e,n,s)}static lt(e,n,s){return n==="in"?new R0(e,s):new L0(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.ft(mn(n,this.value)):n!==null&&Zn(this.value)===Zn(n)&&this.ft(mn(n,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return P()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class O0 extends We{constructor(e,n,s){super(e,n,s),this.key=N.fromName(s.referenceValue)}matches(e){const n=N.comparator(e.key,this.key);return this.ft(n)}}class R0 extends We{constructor(e,n){super(e,"in",n),this.keys=Np("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class L0 extends We{constructor(e,n){super(e,"not-in",n),this.keys=Np("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Np(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>N.fromName(s.referenceValue))}class P0 extends We{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Br(n)&&Vr(n.arrayValue,this.value)}}class F0 extends We{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Vr(this.value.arrayValue,n)}}class V0 extends We{constructor(e,n){super(e,"not-in",n)}matches(e){if(Vr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Vr(this.value.arrayValue,n)}}class B0 extends We{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Br(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>Vr(this.value.arrayValue,s))}}class Rs{constructor(e,n){this.position=e,this.inclusive=n}}class wr{constructor(e,n="asc"){this.field=e,this.dir=n}}function $0(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function mh(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=N.comparator(N.fromName(o.referenceValue),n.key):s=mn(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function gh(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Vt(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this._t=null,this.wt=null,this.startAt,this.endAt}}function U0(t,e,n,s,r,i,o,a){return new Bo(t,e,n,s,r,i,o,a)}function gc(t){return new Bo(t)}function yh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function q0(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function j0(t){for(const e of t.filters)if(e.dt())return e.field;return null}function K0(t){return t.collectionGroup!==null}function $r(t){const e=z(t);if(e._t===null){e._t=[];const n=j0(e),s=q0(e);if(n!==null&&s===null)n.isKeyField()||e._t.push(new wr(n)),e._t.push(new wr(Se.keyField(),"asc"));else{let r=!1;for(const i of e.explicitOrderBy)e._t.push(i),i.field.isKeyField()&&(r=!0);if(!r){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new wr(Se.keyField(),i))}}}return e._t}function St(t){const e=z(t);if(!e.wt)if(e.limitType==="F")e.wt=dh(e.path,e.collectionGroup,$r(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of $r(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new wr(i.field,o))}const s=e.endAt?new Rs(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Rs(e.startAt.position,e.startAt.inclusive):null;e.wt=dh(e.path,e.collectionGroup,n,e.filters,e.limit,s,r)}return e.wt}function fu(t,e,n){return new Bo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $o(t,e){return ei(St(t),St(e))&&t.limitType===e.limitType}function kp(t){return`${es(St(t))}|lt:${t.limitType}`}function pu(t){return`Query(target=${M0(St(t))}; limitType=${t.limitType})`}function yc(t,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):N.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,s){for(const r of n.explicitOrderBy)if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(r,i,o){const a=mh(r,i,o);return r.inclusive?a<=0:a<0}(n.startAt,$r(n),s)||n.endAt&&!function(r,i,o){const a=mh(r,i,o);return r.inclusive?a>=0:a>0}(n.endAt,$r(n),s))}(t,e)}function H0(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Mp(t){return(e,n)=>{let s=!1;for(const r of $r(t)){const i=G0(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function G0(t,e,n){const s=t.field.isKeyField()?N.comparator(e.key,n.key):function(r,i,o){const a=i.data.field(r),u=o.data.field(r);return a!==null&&u!==null?mn(a,u):P()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return P()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Op(t,e){if(t.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fr(e)?"-0":e}}function Rp(t){return{integerValue:""+t}}function z0(t,e){return D0(e)?Rp(e):Op(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(){this._=void 0}}function W0(t,e,n){return t instanceof Ur?function(s,r){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&(i.fields.__previous_value__=r),{mapValue:i}}(n,e):t instanceof Ls?Pp(t,e):t instanceof Ps?Fp(t,e):function(s,r){const i=Lp(s,r),o=vh(i)+vh(s.yt);return du(i)&&du(s.yt)?Rp(o):Op(s.It,o)}(t,e)}function Q0(t,e,n){return t instanceof Ls?Pp(t,e):t instanceof Ps?Fp(t,e):n}function Lp(t,e){return t instanceof qr?du(n=e)||function(s){return!!s&&"doubleValue"in s}(n)?e:{integerValue:0}:null;var n}class Ur extends Uo{}class Ls extends Uo{constructor(e){super(),this.elements=e}}function Pp(t,e){const n=Vp(e);for(const s of t.elements)n.some(r=>Vt(r,s))||n.push(s);return{arrayValue:{values:n}}}class Ps extends Uo{constructor(e){super(),this.elements=e}}function Fp(t,e){let n=Vp(e);for(const s of t.elements)n=n.filter(r=>!Vt(r,s));return{arrayValue:{values:n}}}class qr extends Uo{constructor(e,n){super(),this.It=e,this.yt=n}}function vh(t){return xe(t.integerValue||t.doubleValue)}function Vp(t){return Br(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,n){this.field=e,this.transform=n}}function X0(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Ls&&s instanceof Ls||n instanceof Ps&&s instanceof Ps?Os(n.elements,s.elements,Vt):n instanceof qr&&s instanceof qr?Vt(n.yt,s.yt):n instanceof Ur&&s instanceof Ur}(t.transform,e.transform)}class J0{constructor(e,n){this.version=e,this.transformResults=n}}class rt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new rt}static exists(e){return new rt(void 0,e)}static updateTime(e){return new rt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ni(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qo{}function Bp(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vc(t.key,rt.none()):new zs(t.key,t.data,rt.none());{const n=t.data,s=ze.empty();let r=new le(Se.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new zt(t.key,s,new ct(r.toArray()),rt.none())}}function Z0(t,e,n){t instanceof zs?function(s,r,i){const o=s.value.clone(),a=bh(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof zt?function(s,r,i){if(!Ni(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=bh(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll($p(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(s,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function br(t,e,n,s){return t instanceof zs?function(r,i,o,a){if(!Ni(r.precondition,i))return o;const u=r.value.clone(),c=Ih(r.fieldTransforms,a,i);return u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(t,e,n,s):t instanceof zt?function(r,i,o,a){if(!Ni(r.precondition,i))return o;const u=Ih(r.fieldTransforms,a,i),c=i.data;return c.setAll($p(r)),c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(l=>l.field))}(t,e,n,s):function(r,i,o){return Ni(r.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function eI(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=Lp(s.transform,r||null);i!=null&&(n===null&&(n=ze.empty()),n.set(s.field,i))}return n||null}function wh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&Os(n,s,(r,i)=>X0(r,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class zs extends qo{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class zt extends qo{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $p(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function bh(t,e,n){const s=new Map;G(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,Q0(o,a,n[r]))}return s}function Ih(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,W0(i,o,e))}return s}class vc extends qo{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Up extends qo{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce,te;function nI(t){switch(t){default:return P();case w.CANCELLED:case w.UNKNOWN:case w.DEADLINE_EXCEEDED:case w.RESOURCE_EXHAUSTED:case w.INTERNAL:case w.UNAVAILABLE:case w.UNAUTHENTICATED:return!1;case w.INVALID_ARGUMENT:case w.NOT_FOUND:case w.ALREADY_EXISTS:case w.PERMISSION_DENIED:case w.FAILED_PRECONDITION:case w.ABORTED:case w.OUT_OF_RANGE:case w.UNIMPLEMENTED:case w.DATA_LOSS:return!0}}function qp(t){if(t===void 0)return Ze("GRPC error has no .code"),w.UNKNOWN;switch(t){case Ce.OK:return w.OK;case Ce.CANCELLED:return w.CANCELLED;case Ce.UNKNOWN:return w.UNKNOWN;case Ce.DEADLINE_EXCEEDED:return w.DEADLINE_EXCEEDED;case Ce.RESOURCE_EXHAUSTED:return w.RESOURCE_EXHAUSTED;case Ce.INTERNAL:return w.INTERNAL;case Ce.UNAVAILABLE:return w.UNAVAILABLE;case Ce.UNAUTHENTICATED:return w.UNAUTHENTICATED;case Ce.INVALID_ARGUMENT:return w.INVALID_ARGUMENT;case Ce.NOT_FOUND:return w.NOT_FOUND;case Ce.ALREADY_EXISTS:return w.ALREADY_EXISTS;case Ce.PERMISSION_DENIED:return w.PERMISSION_DENIED;case Ce.FAILED_PRECONDITION:return w.FAILED_PRECONDITION;case Ce.ABORTED:return w.ABORTED;case Ce.OUT_OF_RANGE:return w.OUT_OF_RANGE;case Ce.UNIMPLEMENTED:return w.UNIMPLEMENTED;case Ce.DATA_LOSS:return w.DATA_LOSS;default:return P()}}(te=Ce||(Ce={}))[te.OK=0]="OK",te[te.CANCELLED=1]="CANCELLED",te[te.UNKNOWN=2]="UNKNOWN",te[te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",te[te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",te[te.NOT_FOUND=5]="NOT_FOUND",te[te.ALREADY_EXISTS=6]="ALREADY_EXISTS",te[te.PERMISSION_DENIED=7]="PERMISSION_DENIED",te[te.UNAUTHENTICATED=16]="UNAUTHENTICATED",te[te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",te[te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",te[te.ABORTED=10]="ABORTED",te[te.OUT_OF_RANGE=11]="OUT_OF_RANGE",te[te.UNIMPLEMENTED=12]="UNIMPLEMENTED",te[te.INTERNAL=13]="INTERNAL",te[te.UNAVAILABLE=14]="UNAVAILABLE",te[te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){as(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return xp(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI=new Ne(N.comparator);function ut(){return sI}const jp=new Ne(N.comparator);function lr(...t){let e=jp;for(const n of t)e=e.insert(n.key,n);return e}function Kp(t){let e=jp;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Lt(){return Ir()}function Hp(){return Ir()}function Ir(){return new En(t=>t.toString(),(t,e)=>t.isEqual(e))}const rI=new Ne(N.comparator),iI=new le(N.comparator);function Z(...t){let e=iI;for(const n of t)e=e.add(n);return e}const oI=new le(X);function Gp(){return oI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const s=new Map;return s.set(e,ti.createSynthesizedTargetChangeForCurrentChange(e,n)),new jo(q.min(),s,Gp(),ut(),Z())}}class ti{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new ti(Pe.EMPTY_BYTE_STRING,n,Z(),Z(),Z())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,n,s,r){this.Tt=e,this.removedTargetIds=n,this.key=s,this.Et=r}}class zp{constructor(e,n){this.targetId=e,this.At=n}}class Wp{constructor(e,n,s=Pe.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class Eh{constructor(){this.Rt=0,this.bt=_h(),this.Pt=Pe.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return this.Rt!==0}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=Z(),n=Z(),s=Z();return this.bt.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:P()}}),new ti(this.Pt,this.vt,e,n,s)}Nt(){this.Vt=!1,this.bt=_h()}kt(e,n){this.Vt=!0,this.bt=this.bt.insert(e,n)}Mt(e){this.Vt=!0,this.bt=this.bt.remove(e)}Ot(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class aI{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=ut(),this.qt=Th(),this.Kt=new le(X)}Gt(e){for(const n of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(n,e.Et):this.jt(n,e.key,e.Et);for(const n of e.removedTargetIds)this.jt(n,e.key,e.Et)}Wt(e){this.forEachTarget(e,n=>{const s=this.zt(n);switch(e.state){case 0:this.Ht(n)&&s.Ct(e.resumeToken);break;case 1:s.Ft(),s.St||s.Nt(),s.Ct(e.resumeToken);break;case 2:s.Ft(),s.St||this.removeTarget(n);break;case 3:this.Ht(n)&&(s.$t(),s.Ct(e.resumeToken));break;case 4:this.Ht(n)&&(this.Jt(n),s.Ct(e.resumeToken));break;default:P()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Lt.forEach((s,r)=>{this.Ht(r)&&n(r)})}Yt(e){const n=e.targetId,s=e.At.count,r=this.Xt(n);if(r){const i=r.target;if(eo(i))if(s===0){const o=new N(i.path);this.jt(n,o,Ee.newNoDocument(o,q.min()))}else G(s===1);else this.Zt(n)!==s&&(this.Jt(n),this.Kt=this.Kt.add(n))}}te(e){const n=new Map;this.Lt.forEach((i,o)=>{const a=this.Xt(o);if(a){if(i.current&&eo(a.target)){const u=new N(a.target.path);this.Ut.get(u)!==null||this.ee(o,u)||this.jt(o,u,Ee.newNoDocument(u,e))}i.Dt&&(n.set(o,i.xt()),i.Nt())}});let s=Z();this.qt.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const c=this.Xt(u);return!c||c.purpose===2||(a=!1,!1)}),a&&(s=s.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(e));const r=new jo(e,n,this.Kt,this.Ut,s);return this.Ut=ut(),this.qt=Th(),this.Kt=new le(X),r}Qt(e,n){if(!this.Ht(e))return;const s=this.ee(e,n.key)?2:0;this.zt(e).kt(n.key,s),this.Ut=this.Ut.insert(n.key,n),this.qt=this.qt.insert(n.key,this.ne(n.key).add(e))}jt(e,n,s){if(!this.Ht(e))return;const r=this.zt(e);this.ee(e,n)?r.kt(n,1):r.Mt(n),this.qt=this.qt.insert(n,this.ne(n).delete(e)),s&&(this.Ut=this.Ut.insert(n,s))}removeTarget(e){this.Lt.delete(e)}Zt(e){const n=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ot(e){this.zt(e).Ot()}zt(e){let n=this.Lt.get(e);return n||(n=new Eh,this.Lt.set(e,n)),n}ne(e){let n=this.qt.get(e);return n||(n=new le(X),this.qt=this.qt.insert(e,n)),n}Ht(e){const n=this.Xt(e)!==null;return n||_("WatchChangeAggregator","Detected inactive target",e),n}Xt(e){const n=this.Lt.get(e);return n&&n.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new Eh),this.Bt.getRemoteKeysForTarget(e).forEach(n=>{this.jt(e,n,null)})}ee(e,n){return this.Bt.getRemoteKeysForTarget(e).has(n)}}function Th(){return new Ne(N.comparator)}function _h(){return new Ne(N.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),cI=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class lI{constructor(e,n){this.databaseId=e,this.gt=n}}function jr(t,e){return t.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qp(t,e){return t.gt?e.toBase64():e.toUint8Array()}function hI(t,e){return jr(t,e.toTimestamp())}function lt(t){return G(!!t),q.fromTimestamp(function(e){const n=pn(e);return new Te(n.seconds,n.nanos)}(t))}function wc(t,e){return function(n){return new ce(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function Yp(t){const e=ce.fromString(t);return G(sm(e)),e}function no(t,e){return wc(t.databaseId,e.path)}function zn(t,e){const n=Yp(e);if(n.get(1)!==t.databaseId.projectId)throw new R(w.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new R(w.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new N(Jp(n))}function mu(t,e){return wc(t.databaseId,e)}function Xp(t){const e=Yp(t);return e.length===4?ce.emptyPath():Jp(e)}function gu(t){return new ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Jp(t){return G(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function xh(t,e,n){return{name:no(t,e),fields:n.value.mapValue.fields}}function dI(t,e,n){const s=zn(t,e.name),r=lt(e.updateTime),i=new ze({mapValue:{fields:e.fields}}),o=Ee.newFoundDocument(s,r,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function fI(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:P()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,c){return u.gt?(G(c===void 0||typeof c=="string"),Pe.fromBase64String(c||"")):(G(c===void 0||c instanceof Uint8Array),Pe.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const c=u.code===void 0?w.UNKNOWN:qp(u.code);return new R(c,u.message||"")}(o);n=new Wp(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=zn(t,s.document.name),i=lt(s.document.updateTime),o=new ze({mapValue:{fields:s.document.fields}}),a=Ee.newFoundDocument(r,i,o),u=s.targetIds||[],c=s.removedTargetIds||[];n=new ki(u,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=zn(t,s.document),i=s.readTime?lt(s.readTime):q.min(),o=Ee.newNoDocument(r,i),a=s.removedTargetIds||[];n=new ki([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=zn(t,s.document),i=s.removedTargetIds||[];n=new ki([],i,r,null)}else{if(!("filter"in e))return P();{e.filter;const s=e.filter;s.targetId;const r=s.count||0,i=new tI(r),o=s.targetId;n=new zp(o,i)}}return n}function so(t,e){let n;if(e instanceof zs)n={update:xh(t,e.key,e.value)};else if(e instanceof vc)n={delete:no(t,e.key)};else if(e instanceof zt)n={update:xh(t,e.key,e.data),updateMask:bI(e.fieldMask)};else{if(!(e instanceof Up))return P();n={verify:no(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof Ur)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ls)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ps)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof qr)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw P()}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:hI(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:P()}(t,e.precondition)),n}function yu(t,e){const n=e.currentDocument?function(r){return r.updateTime!==void 0?rt.updateTime(lt(r.updateTime)):r.exists!==void 0?rt.exists(r.exists):rt.none()}(e.currentDocument):rt.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(i,o){let a=null;if("setToServerValue"in o)G(o.setToServerValue==="REQUEST_TIME"),a=new Ur;else if("appendMissingElements"in o){const c=o.appendMissingElements.values||[];a=new Ls(c)}else if("removeAllFromArray"in o){const c=o.removeAllFromArray.values||[];a=new Ps(c)}else"increment"in o?a=new qr(i,o.increment):P();const u=Se.fromServerFormat(o.fieldPath);return new Y0(u,a)}(t,r)):[];if(e.update){e.update.name;const r=zn(t,e.update.name),i=new ze({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const u=a.fieldPaths||[];return new ct(u.map(c=>Se.fromServerFormat(c)))}(e.updateMask);return new zt(r,i,o,n,s)}return new zs(r,i,n,s)}if(e.delete){const r=zn(t,e.delete);return new vc(r,n)}if(e.verify){const r=zn(t,e.verify);return new Up(r,n)}return P()}function pI(t,e){return t&&t.length>0?(G(e!==void 0),t.map(n=>function(s,r){let i=s.updateTime?lt(s.updateTime):lt(r);return i.isEqual(q.min())&&(i=lt(r)),new J0(i,s.transformResults||[])}(n,e))):[]}function Zp(t,e){return{documents:[mu(t,e.path)]}}function em(t,e){const n={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(n.parent=mu(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=mu(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(u){if(u.length===0)return;const c=u.map(l=>function(h){if(h.op==="=="){if(ch(h.value))return{unaryFilter:{field:ms(h.field),op:"IS_NAN"}};if(uh(h.value))return{unaryFilter:{field:ms(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(ch(h.value))return{unaryFilter:{field:ms(h.field),op:"IS_NOT_NAN"}};if(uh(h.value))return{unaryFilter:{field:ms(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ms(h.field),op:yI(h.op),value:h.value}}}(l));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(u){if(u.length!==0)return u.map(c=>function(l){return{field:ms(l.field),direction:gI(l.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(u,c){return u.gt||Vo(c)?c:{value:c}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n}function tm(t){let e=Xp(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){G(s===1);const l=n.from[0];l.allDescendants?r=l.collectionId:e=e.child(l.collectionId)}let i=[];n.where&&(i=nm(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(l=>function(h){return new wr(Es(h.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(l)));let a=null;n.limit&&(a=function(l){let h;return h=typeof l=="object"?l.value:l,Vo(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(l){const h=!!l.before,f=l.values||[];return new Rs(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(l){const h=!l.before,f=l.values||[];return new Rs(f,h)}(n.endAt)),U0(e,r,o,i,a,"F",u,c)}function mI(t,e){const n=function(s,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return P()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function nm(t){return t?t.unaryFilter!==void 0?[wI(t)]:t.fieldFilter!==void 0?[vI(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>nm(e)).reduce((e,n)=>e.concat(n)):P():[]}function gI(t){return uI[t]}function yI(t){return cI[t]}function ms(t){return{fieldPath:t.canonicalString()}}function Es(t){return Se.fromServerFormat(t.fieldPath)}function vI(t){return We.create(Es(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return P()}}(t.fieldFilter.op),t.fieldFilter.value)}function wI(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Es(t.unaryFilter.field);return We.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Es(t.unaryFilter.field);return We.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Es(t.unaryFilter.field);return We.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Es(t.unaryFilter.field);return We.create(r,"!=",{nullValue:"NULL_VALUE"});default:return P()}}function bI(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function sm(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Ch(e)),e=II(t.get(n),e);return Ch(e)}function II(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Ch(t){return t+""}function Pt(t){const e=t.length;if(G(e>=2),e===2)return G(t.charAt(0)===""&&t.charAt(1)===""),ce.emptyPath();const n=e-2,s=[];let r="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&P(),t.charAt(o+1)){case"":const a=t.substring(i,o);let u;r.length===0?u=a:(r+=a,u=r,r=""),s.push(u);break;case"":r+=t.substring(i,o),r+="\0";break;case"":r+=t.substring(i,o+1);break;default:P()}i=o+2}return new ce(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(t,e){return[t,tt(e)]}function rm(t,e,n){return[t,tt(e),n]}const EI={},TI=["prefixPath","collectionGroup","readTime","documentId"],_I=["prefixPath","collectionGroup","documentId"],xI=["collectionGroup","readTime","prefixPath","documentId"],CI=["canonicalId","targetId"],SI=["targetId","path"],DI=["path","targetId"],AI=["collectionId","parent"],NI=["indexId","uid"],kI=["uid","sequenceNumber"],MI=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],OI=["indexId","uid","orderedDocumentKey"],RI=["userId","collectionPath","documentId"],LI=["userId","collectionPath","largestBatchId"],PI=["userId","collectionGroup","largestBatchId"],im=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],FI=[...im,"documentOverlays"],om=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],am=om,VI=[...am,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu extends _p{constructor(e,n){super(),this.ie=e,this.currentSequenceNumber=n}}function Fe(t,e){const n=z(t);return jt.O(n.ie,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&Z0(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=br(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=br(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=Hp();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const u=Bp(o,a);u!==null&&s.set(r.key,u),o.isValidDocument()||o.convertToNoDocument(q.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Z())}isEqual(e){return this.batchId===e.batchId&&Os(this.mutations,e.mutations,(n,s)=>wh(n,s))&&Os(this.baseMutations,e.baseMutations,(n,s)=>wh(n,s))}}class Ic{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){G(e.mutations.length===s.length);let r=rI;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Ic(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,n,s,r,i=q.min(),o=q.min(),a=Pe.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new cn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new cn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new cn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e){this.re=e}}function BI(t,e){let n;if(e.document)n=dI(t.re,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=N.fromSegments(e.noDocument.path),r=ns(e.noDocument.readTime);n=Ee.newNoDocument(s,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return P();{const s=N.fromSegments(e.unknownDocument.path),r=ns(e.unknownDocument.version);n=Ee.newUnknownDocument(s,r)}}return e.readTime&&n.setReadTime(function(s){const r=new Te(s[0],s[1]);return q.fromTimestamp(r)}(e.readTime)),n}function Dh(t,e){const n=e.key,s={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:ro(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(r,i){return{name:no(r,i.key),fields:i.data.value.mapValue.fields,updateTime:jr(r,i.version.toTimestamp())}}(t.re,e);else if(e.isNoDocument())s.noDocument={path:n.path.toArray(),readTime:ts(e.version)};else{if(!e.isUnknownDocument())return P();s.unknownDocument={path:n.path.toArray(),version:ts(e.version)}}return s}function ro(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ts(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ns(t){const e=new Te(t.seconds,t.nanoseconds);return q.fromTimestamp(e)}function Pn(t,e){const n=(e.baseMutations||[]).map(i=>yu(t.re,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>yu(t.re,i)),r=Te.fromMillis(e.localWriteTimeMs);return new bc(e.batchId,r,n,s)}function hr(t){const e=ns(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ns(t.lastLimboFreeSnapshotVersion):q.min();let s;var r;return t.query.documents!==void 0?(G((r=t.query).documents.length===1),s=St(gc(Xp(r.documents[0])))):s=function(i){return St(tm(i))}(t.query),new cn(s,t.targetId,0,t.lastListenSequenceNumber,e,n,Pe.fromBase64String(t.resumeToken))}function cm(t,e){const n=ts(e.snapshotVersion),s=ts(e.lastLimboFreeSnapshotVersion);let r;r=eo(e.target)?Zp(t.re,e.target):em(t.re,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:es(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function lm(t){const e=tm({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?fu(e,e.limit,"L"):e}function _a(t,e){return new Ec(e.largestBatchId,yu(t.re,e.overlayMutation))}function Ah(t,e){const n=e.path.lastSegment();return[t,tt(e.path.popLast()),n]}function Nh(t,e,n,s){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:ts(s.readTime),documentKey:tt(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{getBundleMetadata(e,n){return kh(e).get(n).next(s=>{if(s)return{id:(r=s).bundleId,createTime:ns(r.createTime),version:r.version};var r})}saveBundleMetadata(e,n){return kh(e).put({bundleId:(s=n).id,createTime:ts(lt(s.createTime)),version:s.version});var s}getNamedQuery(e,n){return Mh(e).get(n).next(s=>{if(s)return{name:(r=s).name,query:lm(r.bundledQuery),readTime:ns(r.readTime)};var r})}saveNamedQuery(e,n){return Mh(e).put(function(s){return{name:s.name,readTime:ts(lt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function kh(t){return Fe(t,"bundles")}function Mh(t){return Fe(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,n){this.It=e,this.userId=n}static oe(e,n){const s=n.uid||"";return new Ko(e,s)}getOverlay(e,n){return er(e).get(Ah(this.userId,n)).next(s=>s?_a(this.It,s):null)}getOverlays(e,n){const s=Lt();return g.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){const r=[];return s.forEach((i,o)=>{const a=new Ec(n,o);r.push(this.ue(e,a))}),g.waitFor(r)}removeOverlaysForBatchId(e,n,s){const r=new Set;n.forEach(o=>r.add(tt(o.getCollectionPath())));const i=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(er(e).Y("collectionPathOverlayIndex",a))}),g.waitFor(i)}getOverlaysForCollection(e,n,s){const r=Lt(),i=tt(n),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return er(e).W("collectionPathOverlayIndex",o).next(a=>{for(const u of a){const c=_a(this.It,u);r.set(c.getKey(),c)}return r})}getOverlaysForCollectionGroup(e,n,s,r){const i=Lt();let o;const a=IDBKeyRange.bound([this.userId,n,s],[this.userId,n,Number.POSITIVE_INFINITY],!0);return er(e).Z({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{const h=_a(this.It,c);i.size()<r||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):l.done()}).next(()=>i)}ue(e,n){return er(e).put(function(s,r,i){const[o,a,u]=Ah(r,i.mutation.key);return{userId:r,collectionPath:a,documentId:u,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:so(s.re,i.mutation)}}(this.It,this.userId,n))}}function er(t){return Fe(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(){}ce(e,n){this.ae(e,n),n.he()}ae(e,n){if("nullValue"in e)this.le(n,5);else if("booleanValue"in e)this.le(n,10),n.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(n,15),n.fe(xe(e.integerValue));else if("doubleValue"in e){const s=xe(e.doubleValue);isNaN(s)?this.le(n,13):(this.le(n,15),Fr(s)?n.fe(0):n.fe(s))}else if("timestampValue"in e){const s=e.timestampValue;this.le(n,20),typeof s=="string"?n.de(s):(n.de(`${s.seconds||""}`),n.fe(s.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,n),this.we(n);else if("bytesValue"in e)this.le(n,30),n.me(Xn(e.bytesValue)),this.we(n);else if("referenceValue"in e)this.ge(e.referenceValue,n);else if("geoPointValue"in e){const s=e.geoPointValue;this.le(n,45),n.fe(s.latitude||0),n.fe(s.longitude||0)}else"mapValue"in e?Dp(e)?this.le(n,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,n),this.we(n)):"arrayValue"in e?(this.pe(e.arrayValue,n),this.we(n)):P()}_e(e,n){this.le(n,25),this.Ie(e,n)}Ie(e,n){n.de(e)}ye(e,n){const s=e.fields||{};this.le(n,55);for(const r of Object.keys(s))this._e(r,n),this.ae(s[r],n)}pe(e,n){const s=e.values||[];this.le(n,50);for(const r of s)this.ae(r,n)}ge(e,n){this.le(n,37),N.fromName(e).path.forEach(s=>{this.le(n,60),this.Ie(s,n)})}le(e,n){e.fe(n)}we(e){e.fe(2)}}Fn.Te=new Fn;function UI(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function Oh(t){const e=64-function(n){let s=0;for(let r=0;r<8;++r){const i=UI(255&n[r]);if(s+=i,i!==8)break}return s}(t);return Math.ceil(e/8)}class qI{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ee(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ae(s.value),s=n.next();this.Re()}be(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Pe(s.value),s=n.next();this.ve()}Ve(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ae(s);else if(s<2048)this.Ae(960|s>>>6),this.Ae(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s);else{const r=n.codePointAt(0);this.Ae(240|r>>>18),this.Ae(128|63&r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r)}}this.Re()}Se(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Pe(s);else if(s<2048)this.Pe(960|s>>>6),this.Pe(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Pe(480|s>>>12),this.Pe(128|63&s>>>6),this.Pe(128|63&s);else{const r=n.codePointAt(0);this.Pe(240|r>>>18),this.Pe(128|63&r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r)}}this.ve()}De(e){const n=this.Ce(e),s=Oh(n);this.xe(1+s),this.buffer[this.position++]=255&s;for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=255&n[r]}Ne(e){const n=this.Ce(e),s=Oh(n);this.xe(1+s),this.buffer[this.position++]=~(255&s);for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}ke(){this.Me(255),this.Me(255)}Oe(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Ce(e){const n=function(r){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,r,!1),new Uint8Array(i.buffer)}(e),s=(128&n[0])!=0;n[0]^=s?255:128;for(let r=1;r<n.length;++r)n[r]^=s?255:0;return n}Ae(e){const n=255&e;n===0?(this.Me(0),this.Me(255)):n===255?(this.Me(255),this.Me(0)):this.Me(n)}Pe(e){const n=255&e;n===0?(this.Fe(0),this.Fe(255)):n===255?(this.Fe(255),this.Fe(0)):this.Fe(e)}Re(){this.Me(0),this.Me(1)}ve(){this.Fe(0),this.Fe(1)}Me(e){this.xe(1),this.buffer[this.position++]=e}Fe(e){this.xe(1),this.buffer[this.position++]=~e}xe(e){const n=e+this.position;if(n<=this.buffer.length)return;let s=2*this.buffer.length;s<n&&(s=n);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class jI{constructor(e){this.Be=e}me(e){this.Be.Ee(e)}de(e){this.Be.Ve(e)}fe(e){this.Be.De(e)}he(){this.Be.ke()}}class KI{constructor(e){this.Be=e}me(e){this.Be.be(e)}de(e){this.Be.Se(e)}fe(e){this.Be.Ne(e)}he(){this.Be.Oe()}}class tr{constructor(){this.Be=new qI,this.Le=new jI(this.Be),this.Ue=new KI(this.Be)}seed(e){this.Be.seed(e)}qe(e){return e===0?this.Le:this.Ue}$e(){return this.Be.$e()}reset(){this.Be.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,n,s,r){this.indexId=e,this.documentKey=n,this.arrayValue=s,this.directionalValue=r}Ke(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(n);return s.set(this.directionalValue,0),n!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new Vn(this.indexId,this.documentKey,this.arrayValue,s)}}function Sn(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Rh(t.arrayValue,e.arrayValue),n!==0?n:(n=Rh(t.directionalValue,e.directionalValue),n!==0?n:N.comparator(t.documentKey,e.documentKey)))}function Rh(t,e){for(let n=0;n<t.length&&n<e.length;++n){const s=t[n]-e[n];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ge=e.orderBy,this.Qe=[];for(const n of e.filters){const s=n;s.dt()?this.je=s:this.Qe.push(s)}}We(e){const n=lu(e);if(n!==void 0&&!this.ze(n))return!1;const s=Mn(e);let r=0,i=0;for(;r<s.length&&this.ze(s[r]);++r);if(r===s.length)return!0;if(this.je!==void 0){const o=s[r];if(!this.He(this.je,o)||!this.Je(this.Ge[i++],o))return!1;++r}for(;r<s.length;++r){const o=s[r];if(i>=this.Ge.length||!this.Je(this.Ge[i++],o))return!1}return!0}ze(e){for(const n of this.Qe)if(this.He(n,e))return!0;return!1}He(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===s}Je(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(){this.Ye=new Tc}addToCollectionParentIndex(e,n){return this.Ye.add(n),g.resolve()}getCollectionParents(e,n){return g.resolve(this.Ye.getEntries(n))}addFieldIndex(e,n){return g.resolve()}deleteFieldIndex(e,n){return g.resolve()}getDocumentsMatchingTarget(e,n){return g.resolve(null)}getIndexType(e,n){return g.resolve(0)}getFieldIndexes(e,n){return g.resolve([])}getNextCollectionGroupToUpdate(e){return g.resolve(null)}getMinOffset(e,n){return g.resolve(pt.min())}getMinOffsetFromCollectionGroup(e,n){return g.resolve(pt.min())}updateCollectionGroup(e,n,s){return g.resolve()}updateIndexEntries(e,n){return g.resolve()}}class Tc{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new le(ce.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new le(ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi=new Uint8Array(0);class zI{constructor(e,n){this.user=e,this.databaseId=n,this.Xe=new Tc,this.Ze=new En(s=>es(s),(s,r)=>ei(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Xe.has(n)){const s=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.Xe.add(n)});const i={collectionId:s,parent:tt(r)};return Lh(e).put(i)}return g.resolve()}getCollectionParents(e,n){const s=[],r=IDBKeyRange.bound([n,""],[bp(n),""],!1,!0);return Lh(e).W(r).next(i=>{for(const o of i){if(o.collectionId!==n)break;s.push(Pt(o.parent))}return s})}addFieldIndex(e,n){const s=wi(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete r.indexId;const i=s.add(r);if(n.indexState){const o=sr(e);return i.next(a=>{o.put(Nh(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const s=wi(e),r=sr(e),i=nr(e);return s.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const s=nr(e);let r=!0;const i=new Map;return g.forEach(this.tn(n),o=>this.en(e,o).next(a=>{r&&(r=!!a),i.set(o,a)})).next(()=>{if(r){let o=Z();const a=[];return g.forEach(i,(u,c)=>{var l;_("IndexedDbIndexManager",`Using index ${l=u,`id=${l.indexId}|cg=${l.collectionGroup}|f=${l.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`} to execute ${es(n)}`);const h=function(V,Q){const ee=lu(Q);if(ee===void 0)return null;for(const ae of to(V,ee.fieldPath))switch(ae.op){case"array-contains-any":return ae.value.arrayValue.values||[];case"array-contains":return[ae.value]}return null}(c,u),f=function(V,Q){const ee=new Map;for(const ae of Mn(Q))for(const ye of to(V,ae.fieldPath))switch(ye.op){case"==":case"in":ee.set(ae.fieldPath.canonicalString(),ye.value);break;case"not-in":case"!=":return ee.set(ae.fieldPath.canonicalString(),ye.value),Array.from(ee.values())}return null}(c,u),m=function(V,Q){const ee=[];let ae=!0;for(const ye of Mn(Q)){const Y=ye.kind===0?fh(V,ye.fieldPath,V.startAt):ph(V,ye.fieldPath,V.startAt);ee.push(Y.value),ae&&(ae=Y.inclusive)}return new Rs(ee,ae)}(c,u),v=function(V,Q){const ee=[];let ae=!0;for(const ye of Mn(Q)){const Y=ye.kind===0?ph(V,ye.fieldPath,V.endAt):fh(V,ye.fieldPath,V.endAt);ee.push(Y.value),ae&&(ae=Y.inclusive)}return new Rs(ee,ae)}(c,u),D=this.nn(u,c,m),x=this.nn(u,c,v),M=this.sn(u,c,f),W=this.rn(u.indexId,h,D,m.inclusive,x,v.inclusive,M);return g.forEach(W,V=>s.J(V,n.limit).next(Q=>{Q.forEach(ee=>{const ae=N.fromSegments(ee.documentKey);o.has(ae)||(o=o.add(ae),a.push(ae))})}))}).next(()=>a)}return g.resolve(null)})}tn(e){let n=this.Ze.get(e);return n||(n=[e],this.Ze.set(e,n),n)}rn(e,n,s,r,i,o,a){const u=(n!=null?n.length:1)*Math.max(s.length,i.length),c=u/(n!=null?n.length:1),l=[];for(let h=0;h<u;++h){const f=n?this.on(n[h/c]):vi,m=this.un(e,f,s[h%c],r),v=this.cn(e,f,i[h%c],o),D=a.map(x=>this.un(e,f,x,!0));l.push(...this.createRange(m,v,D))}return l}un(e,n,s,r){const i=new Vn(e,N.empty(),n,s);return r?i:i.Ke()}cn(e,n,s,r){const i=new Vn(e,N.empty(),n,s);return r?i.Ke():i}en(e,n){const s=new HI(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const a of i)s.We(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let s=2;return g.forEach(this.tn(n),r=>this.en(e,r).next(i=>{i?s!==0&&i.fields.length<function(o){let a=new le(Se.comparator),u=!1;for(const c of o.filters){const l=c;l.field.isKeyField()||(l.op==="array-contains"||l.op==="array-contains-any"?u=!0:a=a.add(l.field))}for(const c of o.orderBy)c.field.isKeyField()||(a=a.add(c.field));return a.size+(u?1:0)}(r)&&(s=1):s=0})).next(()=>s)}an(e,n){const s=new tr;for(const r of Mn(e)){const i=n.data.field(r.fieldPath);if(i==null)return null;const o=s.qe(r.kind);Fn.Te.ce(i,o)}return s.$e()}on(e){const n=new tr;return Fn.Te.ce(e,n.qe(0)),n.$e()}hn(e,n){const s=new tr;return Fn.Te.ce(mc(this.databaseId,n),s.qe(function(r){const i=Mn(r);return i.length===0?0:i[i.length-1].kind}(e))),s.$e()}sn(e,n,s){if(s===null)return[];let r=[];r.push(new tr);let i=0;for(const o of Mn(e)){const a=s[i++];for(const u of r)if(this.ln(n,o.fieldPath)&&Br(a))r=this.fn(r,o,a);else{const c=u.qe(o.kind);Fn.Te.ce(a,c)}}return this.dn(r)}nn(e,n,s){return this.sn(e,n,s.position)}dn(e){const n=[];for(let s=0;s<e.length;++s)n[s]=e[s].$e();return n}fn(e,n,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const a of r){const u=new tr;u.seed(a.$e()),Fn.Te.ce(o,u.qe(n.kind)),i.push(u)}return i}ln(e,n){return!!e.filters.find(s=>s instanceof We&&s.field.isEqual(n)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,n){const s=wi(e),r=sr(e);return(n?s.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):s.W()).next(i=>{const o=[];return g.forEach(i,a=>r.get([a.indexId,this.uid]).next(u=>{o.push(function(c,l){const h=l?new Zi(l.sequenceNumber,new pt(ns(l.readTime),new N(Pt(l.documentKey)),l.largestBatchId)):Zi.empty(),f=c.fields.map(([m,v])=>new b0(Se.fromServerFormat(m),v));return new Ip(c.indexId,c.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:X(s.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,s){const r=wi(e),i=sr(e);return this._n(e).next(o=>r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>g.forEach(a,u=>i.put(Nh(u.indexId,this.user,o,s)))))}updateIndexEntries(e,n){const s=new Map;return g.forEach(n,(r,i)=>{const o=s.get(r.collectionGroup);return(o?g.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(s.set(r.collectionGroup,a),g.forEach(a,u=>this.wn(e,r,u).next(c=>{const l=this.mn(i,u);return c.isEqual(l)?g.resolve():this.gn(e,i,u,c,l)}))))})}yn(e,n,s,r){return nr(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.hn(s,n.key),documentKey:n.key.path.toArray()})}pn(e,n,s,r){return nr(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.hn(s,n.key),n.key.path.toArray()])}wn(e,n,s){const r=nr(e);let i=new le(Sn);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.hn(s,n)])},(o,a)=>{i=i.add(new Vn(s.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}mn(e,n){let s=new le(Sn);const r=this.an(n,e);if(r==null)return s;const i=lu(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Br(o))for(const a of o.arrayValue.values||[])s=s.add(new Vn(n.indexId,e.key,this.on(a),r))}else s=s.add(new Vn(n.indexId,e.key,vi,r));return s}gn(e,n,s,r,i){_("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,u,c,l,h){const f=a.getIterator(),m=u.getIterator();let v=ps(f),D=ps(m);for(;v||D;){let x=!1,M=!1;if(v&&D){const W=c(v,D);W<0?M=!0:W>0&&(x=!0)}else v!=null?M=!0:x=!0;x?(l(D),D=ps(m)):M?(h(v),v=ps(f)):(v=ps(f),D=ps(m))}}(r,i,Sn,a=>{o.push(this.yn(e,n,s,a))},a=>{o.push(this.pn(e,n,s,a))}),g.waitFor(o)}_n(e){let n=1;return sr(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,s){s=s.sort((o,a)=>Sn(o,a)).filter((o,a,u)=>!a||Sn(o,u[a-1])!==0);const r=[];r.push(e);for(const o of s){const a=Sn(o,e),u=Sn(o,n);if(a===0)r[0]=e.Ke();else if(a>0&&u<0)r.push(o),r.push(o.Ke());else if(u>0)break}r.push(n);const i=[];for(let o=0;o<r.length;o+=2)i.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,vi,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,vi,[]]));return i}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Ph)}getMinOffset(e,n){return g.mapArray(this.tn(n),s=>this.en(e,s).next(r=>r||P())).next(Ph)}}function Lh(t){return Fe(t,"collectionParents")}function nr(t){return Fe(t,"indexEntries")}function wi(t){return Fe(t,"indexConfiguration")}function sr(t){return Fe(t,"indexState")}function Ph(t){G(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let s=1;s<t.length;s++){const r=t[s].indexState.offset;fc(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new pt(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class st{constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new st(e,st.DEFAULT_COLLECTION_PERCENTILE,st.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(t,e,n){const s=t.store("mutations"),r=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const u=s.Z({range:o},(l,h,f)=>(a++,f.delete()));i.push(u.next(()=>{G(a===1)}));const c=[];for(const l of n.mutations){const h=rm(e,l.key.path,n.batchId);i.push(r.delete(h)),c.push(l.key)}return g.waitFor(i).next(()=>c)}function io(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw P();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */st.DEFAULT_COLLECTION_PERCENTILE=10,st.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,st.DEFAULT=new st(41943040,st.DEFAULT_COLLECTION_PERCENTILE,st.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),st.DISABLED=new st(-1,0,0);class Ho{constructor(e,n,s,r){this.userId=e,this.It=n,this.indexManager=s,this.referenceDelegate=r,this.In={}}static oe(e,n,s,r){G(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Ho(i,n,s,r)}checkEmpty(e){let n=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Zt(e).Z({index:"userMutationsIndex",range:s},(r,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,s,r){const i=bs(e),o=Zt(e);return o.add({}).next(a=>{G(typeof a=="number");const u=new bc(a,n,s,r),c=function(f,m,v){const D=v.baseMutations.map(M=>so(f.re,M)),x=v.mutations.map(M=>so(f.re,M));return{userId:m,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:D,mutations:x}}(this.It,this.userId,u),l=[];let h=new le((f,m)=>X(f.canonicalString(),m.canonicalString()));for(const f of r){const m=rm(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),l.push(o.put(c)),l.push(i.put(m,EI))}return h.forEach(f=>{l.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.In[a]=u.keys()}),g.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return Zt(e).get(n).next(s=>s?(G(s.userId===this.userId),Pn(this.It,s)):null)}Tn(e,n){return this.In[n]?g.resolve(this.In[n]):this.lookupMutationBatch(e,n).next(s=>{if(s){const r=s.keys();return this.In[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Zt(e).Z({index:"userMutationsIndex",range:r},(o,a,u)=>{a.userId===this.userId&&(G(a.batchId>=s),i=Pn(this.It,a)),u.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return Zt(e).Z({index:"userMutationsIndex",range:n,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Zt(e).W("userMutationsIndex",n).next(s=>s.map(r=>Pn(this.It,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const s=Mi(this.userId,n.path),r=IDBKeyRange.lowerBound(s),i=[];return bs(e).Z({range:r},(o,a,u)=>{const[c,l,h]=o,f=Pt(l);if(c===this.userId&&n.path.isEqual(f))return Zt(e).get(h).next(m=>{if(!m)throw P();G(m.userId===this.userId),i.push(Pn(this.It,m))});u.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new le(X);const r=[];return n.forEach(i=>{const o=Mi(this.userId,i.path),a=IDBKeyRange.lowerBound(o),u=bs(e).Z({range:a},(c,l,h)=>{const[f,m,v]=c,D=Pt(m);f===this.userId&&i.path.isEqual(D)?s=s.add(v):h.done()});r.push(u)}),g.waitFor(r).next(()=>this.En(e,s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1,i=Mi(this.userId,s),o=IDBKeyRange.lowerBound(i);let a=new le(X);return bs(e).Z({range:o},(u,c,l)=>{const[h,f,m]=u,v=Pt(f);h===this.userId&&s.isPrefixOf(v)?v.length===r&&(a=a.add(m)):l.done()}).next(()=>this.En(e,a))}En(e,n){const s=[],r=[];return n.forEach(i=>{r.push(Zt(e).get(i).next(o=>{if(o===null)throw P();G(o.userId===this.userId),s.push(Pn(this.It,o))}))}),g.waitFor(r).next(()=>s)}removeMutationBatch(e,n){return hm(e.ie,this.userId,n).next(s=>(e.addOnCommittedListener(()=>{this.An(n.batchId)}),g.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return g.resolve();const s=IDBKeyRange.lowerBound([this.userId]),r=[];return bs(e).Z({range:s},(i,o,a)=>{if(i[0]===this.userId){const u=Pt(i[1]);r.push(u)}else a.done()}).next(()=>{G(r.length===0)})})}containsKey(e,n){return dm(e,this.userId,n)}Rn(e){return fm(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function dm(t,e,n){const s=Mi(e,n.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return bs(t).Z({range:i,X:!0},(a,u,c)=>{const[l,h,f]=a;l===e&&h===r&&(o=!0),c.done()}).next(()=>o)}function Zt(t){return Fe(t,"mutations")}function bs(t){return Fe(t,"documentMutations")}function fm(t){return Fe(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new ss(0)}static vn(){return new ss(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e,n){this.referenceDelegate=e,this.It=n}allocateTargetId(e){return this.Vn(e).next(n=>{const s=new ss(n.highestTargetId);return n.highestTargetId=s.next(),this.Sn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(n=>q.fromTimestamp(new Te(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,s){return this.Vn(e).next(r=>(r.highestListenSequenceNumber=n,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.Sn(e,r)))}addTargetData(e,n){return this.Dn(e,n).next(()=>this.Vn(e).next(s=>(s.targetCount+=1,this.Cn(n,s),this.Sn(e,s))))}updateTargetData(e,n){return this.Dn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>gs(e).delete(n.targetId)).next(()=>this.Vn(e)).next(s=>(G(s.targetCount>0),s.targetCount-=1,this.Sn(e,s)))}removeTargets(e,n,s){let r=0;const i=[];return gs(e).Z((o,a)=>{const u=hr(a);u.sequenceNumber<=n&&s.get(u.targetId)===null&&(r++,i.push(this.removeTargetData(e,u)))}).next(()=>g.waitFor(i)).next(()=>r)}forEachTarget(e,n){return gs(e).Z((s,r)=>{const i=hr(r);n(i)})}Vn(e){return Vh(e).get("targetGlobalKey").next(n=>(G(n!==null),n))}Sn(e,n){return Vh(e).put("targetGlobalKey",n)}Dn(e,n){return gs(e).put(cm(this.It,n))}Cn(e,n){let s=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,s=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.Vn(e).next(n=>n.targetCount)}getTargetData(e,n){const s=es(n),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return gs(e).Z({range:r,index:"queryTargetsIndex"},(o,a,u)=>{const c=hr(a);ei(n,c.target)&&(i=c,u.done())}).next(()=>i)}addMatchingKeys(e,n,s){const r=[],i=sn(e);return n.forEach(o=>{const a=tt(o.path);r.push(i.put({targetId:s,path:a})),r.push(this.referenceDelegate.addReference(e,s,o))}),g.waitFor(r)}removeMatchingKeys(e,n,s){const r=sn(e);return g.forEach(n,i=>{const o=tt(i.path);return g.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,n){const s=sn(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,n){const s=IDBKeyRange.bound([n],[n+1],!1,!0),r=sn(e);let i=Z();return r.Z({range:s,X:!0},(o,a,u)=>{const c=Pt(o[1]),l=new N(c);i=i.add(l)}).next(()=>i)}containsKey(e,n){const s=tt(n.path),r=IDBKeyRange.bound([s],[bp(s)],!1,!0);let i=0;return sn(e).Z({index:"documentTargetsIndex",X:!0,range:r},([o,a],u,c)=>{o!==0&&(i++,c.done())}).next(()=>i>0)}se(e,n){return gs(e).get(n).next(s=>s?hr(s):null)}}function gs(t){return Fe(t,"targets")}function Vh(t){return Fe(t,"targetGlobal")}function sn(t){return Fe(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh([t,e],[n,s]){const r=X(t,n);return r===0?X(e,s):r}class QI{constructor(e){this.xn=e,this.buffer=new le(Bh),this.Nn=0}kn(){return++this.Nn}Mn(e){const n=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();Bh(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class YI{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.On=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Fn(6e4)}stop(){this.On&&(this.On.cancel(),this.On=null)}get started(){return this.On!==null}Fn(e){_("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.On=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.On=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){In(n)?_("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await os(n)}await this.Fn(3e5)})}}class XI{constructor(e,n){this.$n=e,this.params=n}calculateTargetCount(e,n){return this.$n.Bn(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return g.resolve(wt.at);const s=new QI(n);return this.$n.forEachTarget(e,r=>s.Mn(r.sequenceNumber)).next(()=>this.$n.Ln(e,r=>s.Mn(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.$n.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.$n.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(_("LruGarbageCollector","Garbage collection skipped; disabled"),g.resolve(Fh)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(_("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fh):this.Un(e,n))}getCacheSize(e){return this.$n.getCacheSize(e)}Un(e,n){let s,r,i,o,a,u,c;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(_("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,a=Date.now(),this.removeTargets(e,s,n))).next(h=>(i=h,u=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(c=Date.now(),uu()<=re.DEBUG&&_("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(u-a)+`ms
	Removed ${h} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),g.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(e,n){this.db=e,this.garbageCollector=function(s,r){return new XI(s,r)}(this,n)}Bn(e){const n=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}qn(e){let n=0;return this.Ln(e,s=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Ln(e,n){return this.Kn(e,(s,r)=>n(r))}addReference(e,n,s){return bi(e,s)}removeReference(e,n,s){return bi(e,s)}removeTargets(e,n,s){return this.db.getTargetCache().removeTargets(e,n,s)}markPotentiallyOrphaned(e,n){return bi(e,n)}Gn(e,n){return function(s,r){let i=!1;return fm(s).tt(o=>dm(s,o,r).next(a=>(a&&(i=!0),g.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Kn(e,(o,a)=>{if(a<=n){const u=this.Gn(e,o).next(c=>{if(!c)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,q.min()),sn(e).delete([0,tt(o.path)])))});r.push(u)}}).next(()=>g.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,n){return bi(e,n)}Kn(e,n){const s=sn(e);let r,i=wt.at;return s.Z({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(i!==wt.at&&n(new N(Pt(r)),i),i=c,r=u):i=wt.at}).next(()=>{i!==wt.at&&n(new N(Pt(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function bi(t,e){return sn(t).put(function(n,s){return{targetId:0,path:tt(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(){this.changes=new En(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ee.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?g.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e){this.It=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,s){return Dn(e).put(s)}removeEntry(e,n,s){return Dn(e).delete(function(r,i){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],ro(i),o[o.length-1]]}(n,s))}updateMetadata(e,n){return this.getMetadata(e).next(s=>(s.byteSize+=n,this.Qn(e,s)))}getEntry(e,n){let s=Ee.newInvalidDocument(n);return Dn(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(rr(n))},(r,i)=>{s=this.jn(n,i)}).next(()=>s)}Wn(e,n){let s={size:0,document:Ee.newInvalidDocument(n)};return Dn(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(rr(n))},(r,i)=>{s={document:this.jn(n,i),size:io(i)}}).next(()=>s)}getEntries(e,n){let s=ut();return this.zn(e,n,(r,i)=>{const o=this.jn(r,i);s=s.insert(r,o)}).next(()=>s)}Hn(e,n){let s=ut(),r=new Ne(N.comparator);return this.zn(e,n,(i,o)=>{const a=this.jn(i,o);s=s.insert(i,a),r=r.insert(i,io(o))}).next(()=>({documents:s,Jn:r}))}zn(e,n,s){if(n.isEmpty())return g.resolve();let r=new le(qh);n.forEach(u=>r=r.add(u));const i=IDBKeyRange.bound(rr(r.first()),rr(r.last())),o=r.getIterator();let a=o.getNext();return Dn(e).Z({index:"documentKeyIndex",range:i},(u,c,l)=>{const h=N.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&qh(a,h)<0;)s(a,null),a=o.getNext();a&&a.isEqual(h)&&(s(a,c),a=o.hasNext()?o.getNext():null),a?l.j(rr(a)):l.done()}).next(()=>{for(;a;)s(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,s){const r=[n.popLast().toArray(),n.lastSegment(),ro(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Dn(e).W(IDBKeyRange.bound(r,i,!0)).next(o=>{let a=ut();for(const u of o){const c=this.jn(N.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);a=a.insert(c.key,c)}return a})}getAllFromCollectionGroup(e,n,s,r){let i=ut();const o=Uh(n,s),a=Uh(n,pt.max());return Dn(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{const h=this.jn(N.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);i=i.insert(h.key,h),i.size===r&&l.done()}).next(()=>i)}newChangeBuffer(e){return new eE(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return $h(e).get("remoteDocumentGlobalKey").next(n=>(G(!!n),n))}Qn(e,n){return $h(e).put("remoteDocumentGlobalKey",n)}jn(e,n){if(n){const s=BI(this.It,n);if(!(s.isNoDocument()&&s.version.isEqual(q.min())))return s}return Ee.newInvalidDocument(e)}}function mm(t){return new ZI(t)}class eE extends pm{constructor(e,n){super(),this.Yn=e,this.trackRemovals=n,this.Xn=new En(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const n=[];let s=0,r=new le((i,o)=>X(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Xn.get(i);if(n.push(this.Yn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const u=Dh(this.Yn.It,o);r=r.add(i.path.popLast()),s+=io(u)-a.size,n.push(this.Yn.addEntry(e,i,u))}else if(s-=a.size,this.trackRemovals){const u=Dh(this.Yn.It,o.convertToNoDocument(q.min()));n.push(this.Yn.addEntry(e,i,u))}}),r.forEach(i=>{n.push(this.Yn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Yn.updateMetadata(e,s)),g.waitFor(n)}getFromCache(e,n){return this.Yn.Wn(e,n).next(s=>(this.Xn.set(n,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,n){return this.Yn.Hn(e,n).next(({documents:s,Jn:r})=>(r.forEach((i,o)=>{this.Xn.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function $h(t){return Fe(t,"remoteDocumentGlobal")}function Dn(t){return Fe(t,"remoteDocumentsV14")}function rr(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Uh(t,e){const n=e.documentKey.path.toArray();return[t,ro(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function qh(t,e){const n=t.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<s.length-2;++i)if(r=X(n[i],s[i]),r)return r;return r=X(n.length,s.length),r||(r=X(n[n.length-2],s[s.length-2]),r||X(n[n.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.getBaseDocument(e,n,s))).next(r=>(s!==null&&br(s.mutation,r,ct.empty(),Te.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,Z()).next(()=>s))}getLocalViewOfDocuments(e,n,s=Z()){const r=Lt();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=lr();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Lt();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,Z()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=ut();const o=Ir(),a=Ir();return n.forEach((u,c)=>{const l=s.get(c.key);r.has(c.key)&&(l===void 0||l.mutation instanceof zt)?i=i.insert(c.key,c):l!==void 0&&(o.set(c.key,l.mutation.getFieldMask()),br(l.mutation,c,l.mutation.getFieldMask(),Te.now()))}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var h;return a.set(c,new tE(l,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const s=Ir();let r=new Ne((o,a)=>o-a),i=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let l=s.get(u)||ct.empty();l=a.applyToLocalView(c,l),s.set(u,l);const h=(r.get(a.batchId)||Z()).add(u);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),c=u.key,l=u.value,h=Hp();l.forEach(f=>{if(!i.has(f)){const m=Bp(n.get(f),s.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return g.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s){return function(r){return N.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):K0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s):this.getDocumentsMatchingCollectionQuery(e,n,s)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):g.resolve(Lt());let a=-1,u=i;return o.next(c=>g.forEach(c,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(l)?g.resolve():this.getBaseDocument(e,l,h).next(f=>{u=u.insert(l,f)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,Z())).next(l=>({batchId:a,changes:Kp(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new N(n)).next(s=>{let r=lr();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s){const r=n.collectionGroup;let i=lr();return this.indexManager.getCollectionParents(e,r).next(o=>g.forEach(o,a=>{const u=function(c,l){return new Bo(l,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,u,s).next(c=>{c.forEach((l,h)=>{i=i.insert(l,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,s){let r;return this.remoteDocumentCache.getAllFromCollection(e,n.path,s).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId))).next(i=>{i.forEach((a,u)=>{const c=u.getKey();r.get(c)===null&&(r=r.insert(c,Ee.newInvalidDocument(c)))});let o=lr();return r.forEach((a,u)=>{const c=i.get(a);c!==void 0&&br(c.mutation,u,ct.empty(),Te.now()),yc(n,u)&&(o=o.insert(a,u))}),o})}getBaseDocument(e,n,s){return s===null||s.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):g.resolve(Ee.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,n){return g.resolve(this.Zn.get(n))}saveBundleMetadata(e,n){var s;return this.Zn.set(n.id,{id:(s=n).id,version:s.version,createTime:lt(s.createTime)}),g.resolve()}getNamedQuery(e,n){return g.resolve(this.ts.get(n))}saveNamedQuery(e,n){return this.ts.set(n.name,function(s){return{name:s.name,query:lm(s.bundledQuery),readTime:lt(s.readTime)}}(n)),g.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(){this.overlays=new Ne(N.comparator),this.es=new Map}getOverlay(e,n){return g.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Lt();return g.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.ue(e,n,i)}),g.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.es.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(s)),g.resolve()}getOverlaysForCollection(e,n,s){const r=Lt(),i=n.length+1,o=new N(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>s&&r.set(u.getKey(),u)}return g.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new Ne((c,l)=>c-l);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>s){let l=i.get(c.largestBatchId);l===null&&(l=Lt(),i=i.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}const a=Lt(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=r)););return g.resolve(a)}ue(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.es.get(r.largestBatchId).delete(s.key);this.es.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Ec(n,s));let i=this.es.get(n);i===void 0&&(i=Z(),this.es.set(n,i)),this.es.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(){this.ns=new le(Me.ss),this.rs=new le(Me.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,n){const s=new Me(e,n);this.ns=this.ns.add(s),this.rs=this.rs.add(s)}us(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.cs(new Me(e,n))}hs(e,n){e.forEach(s=>this.removeReference(s,n))}ls(e){const n=new N(new ce([])),s=new Me(n,e),r=new Me(n,e+1),i=[];return this.rs.forEachInRange([s,r],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const n=new N(new ce([])),s=new Me(n,e),r=new Me(n,e+1);let i=Z();return this.rs.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new Me(e,0),s=this.ns.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Me{constructor(e,n){this.key=e,this._s=n}static ss(e,n){return N.comparator(e.key,n.key)||X(e._s,n._s)}static os(e,n){return X(e._s,n._s)||N.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this.gs=new le(Me.ss)}checkEmpty(e){return g.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new bc(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.gs=this.gs.add(new Me(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return g.resolve(o)}lookupMutationBatch(e,n){return g.resolve(this.ys(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ps(s),i=r<0?0:r;return g.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return g.resolve(this.mutationQueue.length===0?-1:this.ws-1)}getAllMutationBatches(e){return g.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Me(n,0),r=new Me(n,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([s,r],o=>{const a=this.ys(o._s);i.push(a)}),g.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new le(X);return n.forEach(r=>{const i=new Me(r,0),o=new Me(r,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],a=>{s=s.add(a._s)})}),g.resolve(this.Is(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;N.isDocumentKey(i)||(i=i.child(""));const o=new Me(new N(i),0);let a=new le(X);return this.gs.forEachWhile(u=>{const c=u.key.path;return!!s.isPrefixOf(c)&&(c.length===r&&(a=a.add(u._s)),!0)},o),g.resolve(this.Is(a))}Is(e){const n=[];return e.forEach(s=>{const r=this.ys(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){G(this.Ts(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.gs;return g.forEach(n.mutations,r=>{const i=new Me(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.gs=s})}An(e){}containsKey(e,n){const s=new Me(n,0),r=this.gs.firstAfterOrEqual(s);return g.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,g.resolve()}Ts(e,n){return this.ps(e)}ps(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ys(e){const n=this.ps(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e){this.Es=e,this.docs=new Ne(N.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.Es(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return g.resolve(s?s.document.mutableCopy():Ee.newInvalidDocument(n))}getEntries(e,n){let s=ut();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Ee.newInvalidDocument(r))}),g.resolve(s)}getAllFromCollection(e,n,s){let r=ut();const i=new N(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:u}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||fc(Ep(u),s)<=0||(r=r.insert(u.key,u.mutableCopy()))}return g.resolve(r)}getAllFromCollectionGroup(e,n,s,r){P()}As(e,n){return g.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new oE(this)}getSize(e){return g.resolve(this.size)}}class oE extends pm{constructor(e){super(),this.Yn=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Yn.addEntry(e,r)):this.Yn.removeEntry(s)}),g.waitFor(n)}getFromCache(e,n){return this.Yn.getEntry(e,n)}getAllFromCache(e,n){return this.Yn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e){this.persistence=e,this.Rs=new En(n=>es(n),ei),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.bs=0,this.Ps=new _c,this.targetCount=0,this.vs=ss.Pn()}forEachTarget(e,n){return this.Rs.forEach((s,r)=>n(r)),g.resolve()}getLastRemoteSnapshotVersion(e){return g.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return g.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),g.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.bs&&(this.bs=n),g.resolve()}Dn(e){this.Rs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.vs=new ss(n),this.highestTargetId=n),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,n){return this.Dn(n),this.targetCount+=1,g.resolve()}updateTargetData(e,n){return this.Dn(n),g.resolve()}removeTargetData(e,n){return this.Rs.delete(n.target),this.Ps.ls(n.targetId),this.targetCount-=1,g.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Rs.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),g.waitFor(i).next(()=>r)}getTargetCount(e){return g.resolve(this.targetCount)}getTargetData(e,n){const s=this.Rs.get(n)||null;return g.resolve(s)}addMatchingKeys(e,n,s){return this.Ps.us(n,s),g.resolve()}removeMatchingKeys(e,n,s){this.Ps.hs(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),g.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Ps.ls(n),g.resolve()}getMatchingKeysForTargetId(e,n){const s=this.Ps.ds(n);return g.resolve(s)}containsKey(e,n){return g.resolve(this.Ps.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ym{constructor(e,n){this.Vs={},this.overlays={},this.Ss=new wt(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new aE(this),this.indexManager=new GI,this.remoteDocumentCache=function(s){return new iE(s)}(s=>this.referenceDelegate.xs(s)),this.It=new um(n),this.Ns=new nE(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new sE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.Vs[e.toKey()];return s||(s=new rE(n,this.referenceDelegate),this.Vs[e.toKey()]=s),s}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,n,s){_("MemoryPersistence","Starting transaction:",e);const r=new uE(this.Ss.next());return this.referenceDelegate.ks(),s(r).next(i=>this.referenceDelegate.Ms(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Os(e,n){return g.or(Object.values(this.Vs).map(s=>()=>s.containsKey(e,n)))}}class uE extends _p{constructor(e){super(),this.currentSequenceNumber=e}}class Go{constructor(e){this.persistence=e,this.Fs=new _c,this.$s=null}static Bs(e){return new Go(e)}get Ls(){if(this.$s)return this.$s;throw P()}addReference(e,n,s){return this.Fs.addReference(s,n),this.Ls.delete(s.toString()),g.resolve()}removeReference(e,n,s){return this.Fs.removeReference(s,n),this.Ls.add(s.toString()),g.resolve()}markPotentiallyOrphaned(e,n){return this.Ls.add(n.toString()),g.resolve()}removeTarget(e,n){this.Fs.ls(n.targetId).forEach(r=>this.Ls.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Ls.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}ks(){this.$s=new Set}Ms(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return g.forEach(this.Ls,s=>{const r=N.fromPath(s);return this.Us(e,r).next(i=>{i||n.removeEntry(r,q.min())})}).next(()=>(this.$s=null,n.apply(e)))}updateLimboDocument(e,n){return this.Us(e,n).next(s=>{s?this.Ls.delete(n.toString()):this.Ls.add(n.toString())})}xs(e){return 0}Us(e,n){return g.or([()=>g.resolve(this.Fs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Os(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cE{constructor(e){this.It=e}$(e,n,s,r){const i=new Fo("createOrUpgrade",n);s<1&&r>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sh,{unique:!0}),a.createObjectStore("documentMutations")}(e),jh(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=g.resolve();return s<3&&r>=3&&(s!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),jh(e)),o=o.next(()=>function(a){const u=a.store("targetGlobal"),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:q.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",c)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(a,u){return u.store("mutations").W().next(c=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sh,{unique:!0});const l=u.store("mutations"),h=c.map(f=>l.put(f));return g.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.qs(i))),s<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(i)))),s<7&&r>=7&&(o=o.next(()=>this.Gs(i))),s<8&&r>=8&&(o=o.next(()=>this.Qs(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.js(i))),s<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(a){const u=a.createObjectStore("documentOverlays",{keyPath:RI});u.createIndex("collectionPathOverlayIndex",LI,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",PI,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(a){const u=a.createObjectStore("remoteDocumentsV14",{keyPath:TI});u.createIndex("documentKeyIndex",_I),u.createIndex("collectionGroupIndex",xI)}(e)).next(()=>this.Ws(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.zs(e,i))),s<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:NI}).createIndex("sequenceNumberIndex",kI,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:MI}).createIndex("documentKeyIndex",OI,{unique:!1})}(e))),o}Ks(e){let n=0;return e.store("remoteDocuments").Z((s,r)=>{n+=io(r)}).next(()=>{const s={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}qs(e){const n=e.store("mutationQueues"),s=e.store("mutations");return n.W().next(r=>g.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.W("userMutationsIndex",o).next(a=>g.forEach(a,u=>{G(u.userId===i.userId);const c=Pn(this.It,u);return hm(e,i.userId,c).next(()=>{})}))}))}Gs(e){const n=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.Z((o,a)=>{const u=new ce(o),c=function(l){return[0,tt(l)]}(u);i.push(n.get(c).next(l=>l?g.resolve():(h=>n.put({targetId:0,path:tt(h),sequenceNumber:r.highestListenSequenceNumber}))(u)))}).next(()=>g.waitFor(i))})}Qs(e,n){e.createObjectStore("collectionParents",{keyPath:AI});const s=n.store("collectionParents"),r=new Tc,i=o=>{if(r.add(o)){const a=o.lastSegment(),u=o.popLast();return s.put({collectionId:a,parent:tt(u)})}};return n.store("remoteDocuments").Z({X:!0},(o,a)=>{const u=new ce(o);return i(u.popLast())}).next(()=>n.store("documentMutations").Z({X:!0},([o,a,u],c)=>{const l=Pt(a);return i(l.popLast())}))}js(e){const n=e.store("targets");return n.Z((s,r)=>{const i=hr(r),o=cm(this.It,i);return n.put(o)})}Ws(e,n){const s=n.store("remoteDocuments"),r=[];return s.Z((i,o)=>{const a=n.store("remoteDocumentsV14"),u=(c=o,c.document?new N(ce.fromString(c.document.name).popFirst(5)):c.noDocument?N.fromSegments(c.noDocument.path):c.unknownDocument?N.fromSegments(c.unknownDocument.path):P()).path.toArray();var c;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(l))}).next(()=>g.waitFor(r))}zs(e,n){const s=n.store("mutations"),r=mm(this.It),i=new ym(Go.Bs,this.It.re);return s.W().next(o=>{const a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:Z();Pn(this.It,u).keys().forEach(h=>l=l.add(h)),a.set(u.userId,l)}),g.forEach(a,(u,c)=>{const l=new Je(c),h=Ko.oe(this.It,l),f=i.getIndexManager(l),m=Ho.oe(l,this.It,f,i.referenceDelegate);return new gm(r,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new vu(n,wt.at),u).next()})})}}function jh(t){t.createObjectStore("targetDocuments",{keyPath:SI}).createIndex("documentTargetsIndex",DI,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",CI,{unique:!0}),t.createObjectStore("targetGlobal")}const xa="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class xc{constructor(e,n,s,r,i,o,a,u,c,l,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=s,this.Hs=i,this.window=o,this.document=a,this.Js=c,this.Ys=l,this.Xs=h,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=f=>Promise.resolve(),!xc.C())throw new R(w.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new JI(this,r),this.ii=n+"main",this.It=new um(u),this.ri=new jt(this.ii,this.Xs,new cE(this.It)),this.Cs=new WI(this.referenceDelegate,this.It),this.remoteDocumentCache=mm(this.It),this.Ns=new $I,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,l===!1&&Ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new R(w.FAILED_PRECONDITION,xa);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new wt(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){return this.si=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget(async()=>{this.started&&await this.ui()}))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ii(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(n=>this.isPrimary&&!n?this._i(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(In(e))return _("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return _("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return ir(e).get("owner").next(n=>g.resolve(this.mi(n)))}gi(e){return Ii(e).delete(this.clientId)}async yi(){if(this.isPrimary&&!this.pi(this.ni,18e5)){this.ni=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const s=Fe(n,"clientMetadata");return s.W().next(r=>{const i=this.Ii(r,18e5),o=r.filter(a=>i.indexOf(a)===-1);return g.forEach(o,a=>s.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.oi)for(const n of e)this.oi.removeItem(this.Ti(n.clientId))}}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?g.resolve(!0):ir(e).get("owner").next(n=>{if(n!==null&&this.pi(n.leaseTimestampMs,5e3)&&!this.Ei(n.ownerId)){if(this.mi(n)&&this.networkEnabled)return!0;if(!this.mi(n)){if(!n.allowTabSynchronization)throw new R(w.FAILED_PRECONDITION,xa);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ii(e).W().next(s=>this.Ii(s,5e3).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&_("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Ds=!1,this.Ai(),this.ei&&(this.ei.cancel(),this.ei=null),this.Ri(),this.bi(),await this.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new vu(e,wt.at);return this._i(n).next(()=>this.gi(n))}),this.ri.close(),this.Pi()}Ii(e,n){return e.filter(s=>this.pi(s.updateTimeMs,n)&&!this.Ei(s.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>Ii(e).W().next(n=>this.Ii(n,18e5).map(s=>s.clientId)))}get started(){return this.Ds}getMutationQueue(e,n){return Ho.oe(e,this.It,n,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new zI(e,this.It.re.databaseId)}getDocumentOverlayCache(e){return Ko.oe(this.It,e)}getBundleCache(){return this.Ns}runTransaction(e,n,s){_("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",i=(o=this.Xs)===15?VI:o===14?am:o===13?om:o===12?FI:o===11?im:void P();var o;let a;return this.ri.runTransaction(e,r,i,u=>(a=new vu(u,this.Ss?this.Ss.next():wt.at),n==="readwrite-primary"?this.fi(a).next(c=>!!c||this.di(a)).next(c=>{if(!c)throw Ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new R(w.FAILED_PRECONDITION,Tp);return s(a)}).next(c=>this.wi(a).next(()=>c)):this.Vi(a).next(()=>s(a)))).then(u=>(a.raiseOnCommittedEvent(),u))}Vi(e){return ir(e).get("owner").next(n=>{if(n!==null&&this.pi(n.leaseTimestampMs,5e3)&&!this.Ei(n.ownerId)&&!this.mi(n)&&!(this.Ys||this.allowTabSynchronization&&n.allowTabSynchronization))throw new R(w.FAILED_PRECONDITION,xa)})}wi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ir(e).put("owner",n)}static C(){return jt.C()}_i(e){const n=ir(e);return n.get("owner").next(s=>this.mi(s)?(_("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):g.resolve())}pi(e,n){const s=Date.now();return!(e<s-n)&&(!(e>s)||(Ze(`Detected an update time that is in the future: ${e} > ${s}`),!1))}ci(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground=this.document.visibilityState==="visible")}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Zs=()=>{this.Ai(),Qv()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var n;try{const s=((n=this.oi)===null||n===void 0?void 0:n.getItem(this.Ti(e)))!==null;return _("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return Ze("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Ze("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch{}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ir(t){return Fe(t,"owner")}function Ii(t){return Fe(t,"clientMetadata")}function lE(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Si=s,this.Di=r}static Ci(e,n){let s=Z(),r=Z();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Cc(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(){this.xi=!1}initialize(e,n){this.Ni=e,this.indexManager=n,this.xi=!0}getDocumentsMatchingQuery(e,n,s,r){return this.ki(e,n).next(i=>i||this.Mi(e,n,r,s)).next(i=>i||this.Oi(e,n))}ki(e,n){if(yh(n))return g.resolve(null);let s=St(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=fu(n,null,"F"),s=St(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=Z(...i);return this.Ni.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,s).next(u=>{const c=this.Fi(n,a);return this.$i(n,c,o,u.readTime)?this.ki(e,fu(n,null,"F")):this.Bi(e,c,n,u)}))})))}Mi(e,n,s,r){return yh(n)||r.isEqual(q.min())?this.Oi(e,n):this.Ni.getDocuments(e,s).next(i=>{const o=this.Fi(n,i);return this.$i(n,o,s,r)?this.Oi(e,n):(uu()<=re.DEBUG&&_("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),pu(n)),this.Bi(e,o,n,I0(r,-1)))})}Fi(e,n){let s=new le(Mp(e));return n.forEach((r,i)=>{yc(e,i)&&(s=s.add(i))}),s}$i(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Oi(e,n){return uu()<=re.DEBUG&&_("QueryEngine","Using full collection scan to execute query:",pu(n)),this.Ni.getDocumentsMatchingQuery(e,n,pt.min())}Bi(e,n,s,r){return this.Ni.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(e,n,s,r){this.persistence=e,this.Li=n,this.It=r,this.Ui=new Ne(X),this.qi=new En(i=>es(i),ei),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(s)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gm(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ui))}}function wm(t,e,n,s){return new hE(t,e,n,s)}async function bm(t,e){const n=z(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Qi(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let u=Z();for(const c of r){o.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}for(const c of i){a.push(c.batchId);for(const l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(s,u).next(c=>({ji:c,removedBatchIds:o,addedBatchIds:a}))})})}function dE(t,e){const n=z(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(o,a,u,c){const l=u.batch,h=l.keys();let f=g.resolve();return h.forEach(m=>{f=f.next(()=>c.getEntry(a,m)).next(v=>{const D=u.docVersions.get(m);G(D!==null),v.version.compareTo(D)<0&&(l.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),c.addEntry(v)))})}),f.next(()=>o.mutationQueue.removeMutationBatch(a,l))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=Z();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(a=a.add(o.batch.mutations[u].key));return a}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function Im(t){const e=z(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Cs.getLastRemoteSnapshotVersion(n))}function fE(t,e){const n=z(t),s=e.snapshotVersion;let r=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Gi.newChangeBuffer({trackRemovals:!0});r=n.Ui;const a=[];e.targetChanges.forEach((l,h)=>{const f=r.get(h);if(!f)return;a.push(n.Cs.removeMatchingKeys(i,l.removedDocuments,h).next(()=>n.Cs.addMatchingKeys(i,l.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?m=m.withResumeToken(Pe.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):l.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(l.resumeToken,s)),r=r.insert(h,m),function(v,D,x){return v.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(f,m,l)&&a.push(n.Cs.updateTargetData(i,m))});let u=ut(),c=Z();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,l))}),a.push(pE(i,o,e.documentUpdates).next(l=>{u=l.Wi,c=l.zi})),!s.isEqual(q.min())){const l=n.Cs.getLastRemoteSnapshotVersion(i).next(h=>n.Cs.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(l)}return g.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(n.Ui=r,i))}function pE(t,e,n){let s=Z(),r=Z();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=ut();return n.forEach((a,u)=>{const c=i.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(r=r.add(a)),u.isNoDocument()&&u.version.isEqual(q.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):_("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{Wi:o,zi:r}})}function mE(t,e){const n=z(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function gE(t,e){const n=z(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Cs.getTargetData(s,e).next(i=>i?(r=i,g.resolve(r)):n.Cs.allocateTargetId(s).next(o=>(r=new cn(e,o,0,s.currentSequenceNumber),n.Cs.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ui.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(s.targetId,s),n.qi.set(e,s.targetId)),s})}async function wu(t,e,n){const s=z(t),r=s.Ui.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!In(o))throw o;_("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ui=s.Ui.remove(e),s.qi.delete(r.target)}function Kh(t,e,n){const s=z(t);let r=q.min(),i=Z();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,u,c){const l=z(a),h=l.qi.get(c);return h!==void 0?g.resolve(l.Ui.get(h)):l.Cs.getTargetData(u,c)}(s,o,St(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Cs.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>s.Li.getDocumentsMatchingQuery(o,e,n?r:q.min(),n?i:Z())).next(a=>(yE(s,H0(e),a),{documents:a,Hi:i})))}function yE(t,e,n){let s=q.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Ki.set(e,s)}class Hh{constructor(){this.activeTargetIds=Gp()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Em{constructor(){this.Lr=new Hh,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,n,s){this.Ur[e]=n}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new Hh,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{qr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){_("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){_("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.oo=n+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}co(e,n,s,r,i){const o=this.ao(e,n);_("RestConnection","Sending: ",o,s);const a={};return this.ho(a,r,i),this.lo(e,o,a,s).then(u=>(_("RestConnection","Received: ",u),u),u=>{throw cu("RestConnection",`${e} failed with error: `,u,"url: ",o,"request:",s),u})}fo(e,n,s,r,i,o){return this.co(e,n,s,r,i)}ho(e,n,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+Gs,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}ao(e,n){const s=wE[e];return`${this.oo}/v1/${n}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,n,s,r){return new Promise((i,o)=>{const a=new l0;a.listenOnce(a0.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Ta.NO_ERROR:const c=a.getResponseJson();_("Connection","XHR received:",JSON.stringify(c)),i(c);break;case Ta.TIMEOUT:_("Connection",'RPC "'+e+'" timed out'),o(new R(w.DEADLINE_EXCEEDED,"Request time out"));break;case Ta.HTTP_ERROR:const l=a.getStatus();if(_("Connection",'RPC "'+e+'" failed with status:',l,"response text:",a.getResponseText()),l>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const f=function(m){const v=m.toLowerCase().replace(/_/g,"-");return Object.values(w).indexOf(v)>=0?v:w.UNKNOWN}(h.status);o(new R(f,h.message))}else o(new R(w.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new R(w.UNAVAILABLE,"Connection failed."));break;default:P()}}finally{_("Connection",'RPC "'+e+'" completed.')}});const u=JSON.stringify(r);a.send(n,"POST",u,s,15)})}_o(e,n,s){const r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=i0(),o=o0(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new c0({})),this.ho(a.initMessageHeaders,n,s),a.encodeInitMessageHeaders=!0;const u=r.join("");_("Connection","Creating WebChannel: "+u,a);const c=i.createWebChannel(u,a);let l=!1,h=!1;const f=new bE({Hr:v=>{h?_("Connection","Not sending because WebChannel is closed:",v):(l||(_("Connection","Opening WebChannel transport."),c.open(),l=!0),_("Connection","WebChannel sending:",v),c.send(v))},Jr:()=>c.close()}),m=(v,D,x)=>{v.listen(D,M=>{try{x(M)}catch(W){setTimeout(()=>{throw W},0)}})};return m(c,gi.EventType.OPEN,()=>{h||_("Connection","WebChannel transport opened.")}),m(c,gi.EventType.CLOSE,()=>{h||(h=!0,_("Connection","WebChannel transport closed"),f.io())}),m(c,gi.EventType.ERROR,v=>{h||(h=!0,cu("Connection","WebChannel transport errored:",v),f.io(new R(w.UNAVAILABLE,"The operation could not be completed")))}),m(c,gi.EventType.MESSAGE,v=>{var D;if(!h){const x=v.data[0];G(!!x);const M=x,W=M.error||((D=M[0])===null||D===void 0?void 0:D.error);if(W){_("Connection","WebChannel received error:",W);const V=W.status;let Q=function(ae){const ye=Ce[ae];if(ye!==void 0)return qp(ye)}(V),ee=W.message;Q===void 0&&(Q=w.INTERNAL,ee="Unknown error status: "+V+" with message "+W.message),h=!0,f.io(new R(Q,ee)),c.close()}else _("Connection","WebChannel received:",x),f.ro(x)}}),m(o,u0.STAT_EVENT,v=>{v.stat===nh.PROXY?_("Connection","Detected buffering proxy"):v.stat===nh.NOPROXY&&_("Connection","Detected no buffering proxy")}),setTimeout(()=>{f.so()},0),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(){return typeof window<"u"?window:null}function Oi(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(t){return new lI(t,!0)}class Tm{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Hs=e,this.timerId=n,this.wo=s,this.mo=r,this.yo=i,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const n=Math.floor(this.po+this.Ro()),s=Math.max(0,Date.now()-this.To),r=Math.max(0,n-s);r>0&&_("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.po} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.Io=this.Hs.enqueueAfterDelay(this.timerId,r,()=>(this.To=Date.now(),e())),this.po*=this.mo,this.po<this.wo&&(this.po=this.wo),this.po>this.yo&&(this.po=this.yo)}bo(){this.Io!==null&&(this.Io.skipDelay(),this.Io=null)}cancel(){this.Io!==null&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,n,s,r,i,o,a,u){this.Hs=e,this.Po=s,this.vo=r,this.Vo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Tm(e,n)}No(){return this.state===1||this.state===5||this.ko()}ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Mo()}async stop(){this.No()&&await this.close(0)}Oo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&this.Do===null&&(this.Do=this.Hs.enqueueAfterDelay(this.Po,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(e,n){this.Lo(),this.Uo(),this.xo.cancel(),this.So++,e!==4?this.xo.reset():n&&n.code===w.RESOURCE_EXHAUSTED?(Ze(n.toString()),Ze("Using maximum backoff delay to prevent overloading the backend."),this.xo.Eo()):n&&n.code===w.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.qo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(n)}qo(){}auth(){this.state=1;const e=this.Ko(this.So),n=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.So===n&&this.Go(s,r)},s=>{e(()=>{const r=new R(w.UNKNOWN,"Fetching auth token failed: "+s.message);return this.Qo(r)})})}Go(e,n){const s=this.Ko(this.So);this.stream=this.jo(e,n),this.stream.Yr(()=>{s(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(r=>{s(()=>this.Qo(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}Mo(){this.state=5,this.xo.Ao(async()=>{this.state=0,this.start()})}Qo(e){return _("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return n=>{this.Hs.enqueueAndForget(()=>this.So===e?n():(_("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TE extends _m{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.It=i}jo(e,n){return this.Vo._o("Listen",e,n)}onMessage(e){this.xo.reset();const n=fI(this.It,e),s=function(r){if(!("targetChange"in r))return q.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?q.min():i.readTime?lt(i.readTime):q.min()}(e);return this.listener.Wo(n,s)}zo(e){const n={};n.database=gu(this.It),n.addTarget=function(r,i){let o;const a=i.target;return o=eo(a)?{documents:Zp(r,a)}:{query:em(r,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=Qp(r,i.resumeToken):i.snapshotVersion.compareTo(q.min())>0&&(o.readTime=jr(r,i.snapshotVersion.toTimestamp())),o}(this.It,e);const s=mI(this.It,e);s&&(n.labels=s),this.Bo(n)}Ho(e){const n={};n.database=gu(this.It),n.removeTarget=e,this.Bo(n)}}class _E extends _m{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(e,n){return this.Vo._o("Write",e,n)}onMessage(e){if(G(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const n=pI(e.writeResults,e.commitTime),s=lt(e.commitTime);return this.listener.Zo(s,n)}return G(!e.writeResults||e.writeResults.length===0),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=gu(this.It),this.Bo(e)}Xo(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>so(this.It,s))};this.Bo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xE extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.Vo=s,this.It=r,this.nu=!1}su(){if(this.nu)throw new R(w.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,n,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.Vo.co(e,n,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new R(w.UNKNOWN,r.toString())})}fo(e,n,s,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.Vo.fo(e,n,s,i,o,r)).catch(i=>{throw i.name==="FirebaseError"?(i.code===w.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new R(w.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class CE{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){this.iu===0&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){this.state==="Online"?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,e==="Online"&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Ze(n),this.ou=!1):_("OnlineStateTracker",n)}lu(){this.ru!==null&&(this.ru.cancel(),this.ru=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(o=>{s.enqueueAndForget(async()=>{us(this)&&(_("RemoteStore","Restarting streams for network reachability change."),await async function(a){const u=z(a);u._u.add(4),await ni(u),u.gu.set("Unknown"),u._u.delete(4),await Wo(u)}(this))})}),this.gu=new CE(s,r)}}async function Wo(t){if(us(t))for(const e of t.wu)await e(!0)}async function ni(t){for(const e of t.wu)await e(!1)}function xm(t,e){const n=z(t);n.du.has(e.targetId)||(n.du.set(e.targetId,e),Ac(n)?Dc(n):Ws(n).ko()&&Sc(n,e))}function Cm(t,e){const n=z(t),s=Ws(n);n.du.delete(e),s.ko()&&Sm(n,e),n.du.size===0&&(s.ko()?s.Fo():us(n)&&n.gu.set("Unknown"))}function Sc(t,e){t.yu.Ot(e.targetId),Ws(t).zo(e)}function Sm(t,e){t.yu.Ot(e),Ws(t).Ho(e)}function Dc(t){t.yu=new aI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),se:e=>t.du.get(e)||null}),Ws(t).start(),t.gu.uu()}function Ac(t){return us(t)&&!Ws(t).No()&&t.du.size>0}function us(t){return z(t)._u.size===0}function Dm(t){t.yu=void 0}async function DE(t){t.du.forEach((e,n)=>{Sc(t,e)})}async function AE(t,e){Dm(t),Ac(t)?(t.gu.hu(e),Dc(t)):t.gu.set("Unknown")}async function NE(t,e,n){if(t.gu.set("Online"),e instanceof Wp&&e.state===2&&e.cause)try{await async function(s,r){const i=r.cause;for(const o of r.targetIds)s.du.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.du.delete(o),s.yu.removeTarget(o))}(t,e)}catch(s){_("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await oo(t,s)}else if(e instanceof ki?t.yu.Gt(e):e instanceof zp?t.yu.Yt(e):t.yu.Wt(e),!n.isEqual(q.min()))try{const s=await Im(t.localStore);n.compareTo(s)>=0&&await function(r,i){const o=r.yu.te(i);return o.targetChanges.forEach((a,u)=>{if(a.resumeToken.approximateByteSize()>0){const c=r.du.get(u);c&&r.du.set(u,c.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const u=r.du.get(a);if(!u)return;r.du.set(a,u.withResumeToken(Pe.EMPTY_BYTE_STRING,u.snapshotVersion)),Sm(r,a);const c=new cn(u.target,a,1,u.sequenceNumber);Sc(r,c)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){_("RemoteStore","Failed to raise snapshot:",s),await oo(t,s)}}async function oo(t,e,n){if(!In(e))throw e;t._u.add(1),await ni(t),t.gu.set("Offline"),n||(n=()=>Im(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{_("RemoteStore","Retrying IndexedDB access"),await n(),t._u.delete(1),await Wo(t)})}function Am(t,e){return e().catch(n=>oo(t,n,e))}async function si(t){const e=z(t),n=gn(e);let s=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;kE(e);)try{const r=await mE(e.localStore,s);if(r===null){e.fu.length===0&&n.Fo();break}s=r.batchId,ME(e,r)}catch(r){await oo(e,r)}Nm(e)&&km(e)}function kE(t){return us(t)&&t.fu.length<10}function ME(t,e){t.fu.push(e);const n=gn(t);n.ko()&&n.Yo&&n.Xo(e.mutations)}function Nm(t){return us(t)&&!gn(t).No()&&t.fu.length>0}function km(t){gn(t).start()}async function OE(t){gn(t).eu()}async function RE(t){const e=gn(t);for(const n of t.fu)e.Xo(n.mutations)}async function LE(t,e,n){const s=t.fu.shift(),r=Ic.from(s,e,n);await Am(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await si(t)}async function PE(t,e){e&&gn(t).Yo&&await async function(n,s){if(r=s.code,nI(r)&&r!==w.ABORTED){const i=n.fu.shift();gn(n).Oo(),await Am(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await si(n)}var r}(t,e),Nm(t)&&km(t)}async function zh(t,e){const n=z(t);n.asyncQueue.verifyOperationInProgress(),_("RemoteStore","RemoteStore received new credentials");const s=us(n);n._u.add(3),await ni(n),s&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n._u.delete(3),await Wo(n)}async function FE(t,e){const n=z(t);e?(n._u.delete(2),await Wo(n)):e||(n._u.add(2),await ni(n),n.gu.set("Unknown"))}function Ws(t){return t.pu||(t.pu=function(e,n,s){const r=z(e);return r.su(),new TE(n,r.Vo,r.authCredentials,r.appCheckCredentials,r.It,s)}(t.datastore,t.asyncQueue,{Yr:DE.bind(null,t),Zr:AE.bind(null,t),Wo:NE.bind(null,t)}),t.wu.push(async e=>{e?(t.pu.Oo(),Ac(t)?Dc(t):t.gu.set("Unknown")):(await t.pu.stop(),Dm(t))})),t.pu}function gn(t){return t.Iu||(t.Iu=function(e,n,s){const r=z(e);return r.su(),new _E(n,r.Vo,r.authCredentials,r.appCheckCredentials,r.It,s)}(t.datastore,t.asyncQueue,{Yr:OE.bind(null,t),Zr:PE.bind(null,t),tu:RE.bind(null,t),Zo:LE.bind(null,t)}),t.wu.push(async e=>{e?(t.Iu.Oo(),await si(t)):(await t.Iu.stop(),t.fu.length>0&&(_("RemoteStore",`Stopping write stream with ${t.fu.length} pending writes`),t.fu=[]))})),t.Iu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Ft,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new Nc(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new R(w.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kc(t,e){if(Ze("AsyncQueue",`${e}: ${t}`),In(t))return new R(w.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.comparator=e?(n,s)=>e(n,s)||N.comparator(n.key,s.key):(n,s)=>N.comparator(n.key,s.key),this.keyedMap=lr(),this.sortedSet=new Ne(this.comparator)}static emptySet(e){return new Ds(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ds)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Ds;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(){this.Tu=new Ne(N.comparator)}track(e){const n=e.doc.key,s=this.Tu.get(n);s?e.type!==0&&s.type===3?this.Tu=this.Tu.insert(n,e):e.type===3&&s.type!==1?this.Tu=this.Tu.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.Tu=this.Tu.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.Tu=this.Tu.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.Tu=this.Tu.remove(n):e.type===1&&s.type===2?this.Tu=this.Tu.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.Tu=this.Tu.insert(n,{type:2,doc:e.doc}):P():this.Tu=this.Tu.insert(n,e)}Eu(){const e=[];return this.Tu.inorderTraversal((n,s)=>{e.push(s)}),e}}class Fs{constructor(e,n,s,r,i,o,a,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u}static fromInitialDocuments(e,n,s,r){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Fs(e,n,Ds.emptySet(n),i,s,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$o(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(){this.Au=void 0,this.listeners=[]}}class BE{constructor(){this.queries=new En(e=>kp(e),$o),this.onlineState="Unknown",this.Ru=new Set}}async function $E(t,e){const n=z(t),s=e.query;let r=!1,i=n.queries.get(s);if(i||(r=!0,i=new VE),r)try{i.Au=await n.onListen(s)}catch(o){const a=kc(o,`Initialization of query '${pu(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.listeners.push(e),e.bu(n.onlineState),i.Au&&e.Pu(i.Au)&&Mc(n)}async function UE(t,e){const n=z(t),s=e.query;let r=!1;const i=n.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=i.listeners.length===0)}if(r)return n.queries.delete(s),n.onUnlisten(s)}function qE(t,e){const n=z(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Pu(r)&&(s=!0);o.Au=r}}s&&Mc(n)}function jE(t,e,n){const s=z(t),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(n);s.queries.delete(e)}function Mc(t){t.Ru.forEach(e=>{e.next()})}class KE{constructor(e,n,s){this.query=e,this.vu=n,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=s||{}}Pu(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Fs(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),n=!0):this.Cu(e,this.onlineState)&&(this.xu(e),n=!0),this.Su=e,n}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let n=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),n=!0),n}Cu(e,n){if(!e.fromCache)return!0;const s=n!=="Offline";return(!this.options.Nu||!s)&&(!e.docs.isEmpty()||n==="Offline")}Du(e){if(e.docChanges.length>0)return!0;const n=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}xu(e){e=Fs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Vu=!0,this.vu.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e){this.key=e}}class Om{constructor(e){this.key=e}}class HE{constructor(e,n){this.query=e,this.Lu=n,this.Uu=null,this.current=!1,this.qu=Z(),this.mutatedKeys=Z(),this.Ku=Mp(e),this.Gu=new Ds(this.Ku)}get Qu(){return this.Lu}ju(e,n){const s=n?n.Wu:new Wh,r=n?n.Gu:this.Gu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const u=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,c=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((l,h)=>{const f=r.get(l),m=yc(this.query,h)?h:null,v=!!f&&this.mutatedKeys.has(f.key),D=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;f&&m?f.data.isEqual(m.data)?v!==D&&(s.track({type:3,doc:m}),x=!0):this.zu(f,m)||(s.track({type:2,doc:m}),x=!0,(u&&this.Ku(m,u)>0||c&&this.Ku(m,c)<0)&&(a=!0)):!f&&m?(s.track({type:0,doc:m}),x=!0):f&&!m&&(s.track({type:1,doc:f}),x=!0,(u||c)&&(a=!0)),x&&(m?(o=o.add(m),i=D?i.add(l):i.delete(l)):(o=o.delete(l),i=i.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),s.track({type:1,doc:l})}return{Gu:o,Wu:s,$i:a,mutatedKeys:i}}zu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s){const r=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;const i=e.Wu.Eu();i.sort((c,l)=>function(h,f){const m=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return P()}};return m(h)-m(f)}(c.type,l.type)||this.Ku(c.doc,l.doc)),this.Hu(s);const o=n?this.Ju():[],a=this.qu.size===0&&this.current?1:0,u=a!==this.Uu;return this.Uu=a,i.length!==0||u?{snapshot:new Fs(this.query,e.Gu,r,i,e.mutatedKeys,a===0,u,!1),Yu:o}:{Yu:o}}bu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Gu:this.Gu,Wu:new Wh,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Yu:[]}}Xu(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}Hu(e){e&&(e.addedDocuments.forEach(n=>this.Lu=this.Lu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Lu=this.Lu.delete(n)),this.current=e.current)}Ju(){if(!this.current)return[];const e=this.qu;this.qu=Z(),this.Gu.forEach(s=>{this.Xu(s.key)&&(this.qu=this.qu.add(s.key))});const n=[];return e.forEach(s=>{this.qu.has(s)||n.push(new Om(s))}),this.qu.forEach(s=>{e.has(s)||n.push(new Mm(s))}),n}Zu(e){this.Lu=e.Hi,this.qu=Z();const n=this.ju(e.documents);return this.applyChanges(n,!0)}tc(){return Fs.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,this.Uu===0)}}class GE{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class zE{constructor(e){this.key=e,this.ec=!1}}class WE{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.nc={},this.sc=new En(a=>kp(a),$o),this.ic=new Map,this.rc=new Set,this.oc=new Ne(N.comparator),this.uc=new Map,this.cc=new _c,this.ac={},this.hc=new Map,this.lc=ss.vn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return this.fc===!0}}async function QE(t,e){const n=iT(t);let s,r;const i=n.sc.get(e);if(i)s=i.targetId,n.sharedClientState.addLocalQueryTarget(s),r=i.view.tc();else{const o=await gE(n.localStore,St(e));n.isPrimaryClient&&xm(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=await YE(n,e,s,a==="current")}return r}async function YE(t,e,n,s){t.dc=(l,h,f)=>async function(m,v,D,x){let M=v.view.ju(D);M.$i&&(M=await Kh(m.localStore,v.query,!1).then(({documents:Q})=>v.view.ju(Q,M)));const W=x&&x.targetChanges.get(v.targetId),V=v.view.applyChanges(M,m.isPrimaryClient,W);return Yh(m,v.targetId,V.Yu),V.snapshot}(t,l,h,f);const r=await Kh(t.localStore,e,!0),i=new HE(e,r.Hi),o=i.ju(r.documents),a=ti.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline"),u=i.applyChanges(o,t.isPrimaryClient,a);Yh(t,n,u.Yu);const c=new GE(e,n,i);return t.sc.set(e,c),t.ic.has(n)?t.ic.get(n).push(e):t.ic.set(n,[e]),u.snapshot}async function XE(t,e){const n=z(t),s=n.sc.get(e),r=n.ic.get(s.targetId);if(r.length>1)return n.ic.set(s.targetId,r.filter(i=>!$o(i,e))),void n.sc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await wu(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),Cm(n.remoteStore,s.targetId),bu(n,s.targetId)}).catch(os)):(bu(n,s.targetId),await wu(n.localStore,s.targetId,!0))}async function JE(t,e,n){const s=Vm(t);try{const r=await function(i,o){const a=z(i),u=Te.now(),c=o.reduce((f,m)=>f.add(m.key),Z());let l,h;return a.persistence.runTransaction("Locally write mutations","readwrite",f=>{let m=ut(),v=Z();return a.Gi.getEntries(f,c).next(D=>{m=D,m.forEach((x,M)=>{M.isValidDocument()||(v=v.add(x))})}).next(()=>a.localDocuments.getOverlayedDocuments(f,m)).next(D=>{l=D;const x=[];for(const M of o){const W=eI(M,l.get(M.key).overlayedDocument);W!=null&&x.push(new zt(M.key,W,Ap(W.value.mapValue),rt.exists(!0)))}return a.mutationQueue.addMutationBatch(f,u,x,o)}).next(D=>{h=D;const x=D.applyToLocalDocumentSet(l,v);return a.documentOverlayCache.saveOverlays(f,D.batchId,x)})}).then(()=>({batchId:h.batchId,changes:Kp(l)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let u=i.ac[i.currentUser.toKey()];u||(u=new Ne(X)),u=u.insert(o,a),i.ac[i.currentUser.toKey()]=u}(s,r.batchId,n),await ri(s,r.changes),await si(s.remoteStore)}catch(r){const i=kc(r,"Failed to persist write");n.reject(i)}}async function Rm(t,e){const n=z(t);try{const s=await fE(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.uc.get(i);o&&(G(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.ec=!0:r.modifiedDocuments.size>0?G(o.ec):r.removedDocuments.size>0&&(G(o.ec),o.ec=!1))}),await ri(n,s,e)}catch(s){await os(s)}}function Qh(t,e,n){const s=z(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.sc.forEach((i,o)=>{const a=o.view.bu(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=z(i);a.onlineState=o;let u=!1;a.queries.forEach((c,l)=>{for(const h of l.listeners)h.bu(o)&&(u=!0)}),u&&Mc(a)}(s.eventManager,e),r.length&&s.nc.Wo(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function ZE(t,e,n){const s=z(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.uc.get(e),i=r&&r.key;if(i){let o=new Ne(N.comparator);o=o.insert(i,Ee.newNoDocument(i,q.min()));const a=Z().add(i),u=new jo(q.min(),new Map,new le(X),o,a);await Rm(s,u),s.oc=s.oc.remove(i),s.uc.delete(e),Oc(s)}else await wu(s.localStore,e,!1).then(()=>bu(s,e,n)).catch(os)}async function eT(t,e){const n=z(t),s=e.batch.batchId;try{const r=await dE(n.localStore,e);Pm(n,s,null),Lm(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await ri(n,r)}catch(r){await os(r)}}async function tT(t,e,n){const s=z(t);try{const r=await function(i,o){const a=z(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return a.mutationQueue.lookupMutationBatch(u,o).next(l=>(G(l!==null),c=l.keys(),a.mutationQueue.removeMutationBatch(u,l))).next(()=>a.mutationQueue.performConsistencyCheck(u)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(u,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>a.localDocuments.getDocuments(u,c))})}(s.localStore,e);Pm(s,e,n),Lm(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await ri(s,r)}catch(r){await os(r)}}function Lm(t,e){(t.hc.get(e)||[]).forEach(n=>{n.resolve()}),t.hc.delete(e)}function Pm(t,e,n){const s=z(t);let r=s.ac[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.ac[s.currentUser.toKey()]=r}}function bu(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.ic.get(e))t.sc.delete(s),n&&t.nc._c(s,n);t.ic.delete(e),t.isPrimaryClient&&t.cc.ls(e).forEach(s=>{t.cc.containsKey(s)||Fm(t,s)})}function Fm(t,e){t.rc.delete(e.path.canonicalString());const n=t.oc.get(e);n!==null&&(Cm(t.remoteStore,n),t.oc=t.oc.remove(e),t.uc.delete(n),Oc(t))}function Yh(t,e,n){for(const s of n)s instanceof Mm?(t.cc.addReference(s.key,e),nT(t,s)):s instanceof Om?(_("SyncEngine","Document no longer in limbo: "+s.key),t.cc.removeReference(s.key,e),t.cc.containsKey(s.key)||Fm(t,s.key)):P()}function nT(t,e){const n=e.key,s=n.path.canonicalString();t.oc.get(n)||t.rc.has(s)||(_("SyncEngine","New document in limbo: "+n),t.rc.add(s),Oc(t))}function Oc(t){for(;t.rc.size>0&&t.oc.size<t.maxConcurrentLimboResolutions;){const e=t.rc.values().next().value;t.rc.delete(e);const n=new N(ce.fromString(e)),s=t.lc.next();t.uc.set(s,new zE(n)),t.oc=t.oc.insert(n,s),xm(t.remoteStore,new cn(St(gc(n.path)),s,2,wt.at))}}async function ri(t,e,n){const s=z(t),r=[],i=[],o=[];s.sc.isEmpty()||(s.sc.forEach((a,u)=>{o.push(s.dc(u,e,n).then(c=>{if(c){s.isPrimaryClient&&s.sharedClientState.updateQueryState(u.targetId,c.fromCache?"not-current":"current"),r.push(c);const l=Cc.Ci(u.targetId,c);i.push(l)}}))}),await Promise.all(o),s.nc.Wo(r),await async function(a,u){const c=z(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",l=>g.forEach(u,h=>g.forEach(h.Si,f=>c.persistence.referenceDelegate.addReference(l,h.targetId,f)).next(()=>g.forEach(h.Di,f=>c.persistence.referenceDelegate.removeReference(l,h.targetId,f)))))}catch(l){if(!In(l))throw l;_("LocalStore","Failed to update sequence numbers: "+l)}for(const l of u){const h=l.targetId;if(!l.fromCache){const f=c.Ui.get(h),m=f.snapshotVersion,v=f.withLastLimboFreeSnapshotVersion(m);c.Ui=c.Ui.insert(h,v)}}}(s.localStore,i))}async function sT(t,e){const n=z(t);if(!n.currentUser.isEqual(e)){_("SyncEngine","User change. New user:",e.toKey());const s=await bm(n.localStore,e);n.currentUser=e,function(r,i){r.hc.forEach(o=>{o.forEach(a=>{a.reject(new R(w.CANCELLED,i))})}),r.hc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await ri(n,s.ji)}}function rT(t,e){const n=z(t),s=n.uc.get(e);if(s&&s.ec)return Z().add(s.key);{let r=Z();const i=n.ic.get(e);if(!i)return r;for(const o of i){const a=n.sc.get(o);r=r.unionWith(a.view.Qu)}return r}}function iT(t){const e=z(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZE.bind(null,e),e.nc.Wo=qE.bind(null,e.eventManager),e.nc._c=jE.bind(null,e.eventManager),e}function Vm(t){const e=z(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tT.bind(null,e),e}class Bm{constructor(){this.synchronizeTabs=!1}async initialize(e){this.It=zo(e.databaseInfo.databaseId),this.sharedClientState=this.mc(e),this.persistence=this.gc(e),await this.persistence.start(),this.localStore=this.yc(e),this.gcScheduler=this.Ic(e,this.localStore),this.indexBackfillerScheduler=this.Tc(e,this.localStore)}Ic(e,n){return null}Tc(e,n){return null}yc(e){return wm(this.persistence,new vm,e.initialUser,this.It)}gc(e){return new ym(Go.Bs,this.It)}mc(e){return new Em}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class oT extends Bm{constructor(e,n,s){super(),this.Ec=e,this.cacheSizeBytes=n,this.forceOwnership=s,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ec.initialize(this,e),await Vm(this.Ec.syncEngine),await si(this.Ec.remoteStore),await this.persistence.li(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}yc(e){return wm(this.persistence,new vm,e.initialUser,this.It)}Ic(e,n){const s=this.persistence.referenceDelegate.garbageCollector;return new YI(s,e.asyncQueue,n)}Tc(e,n){const s=new x0(n,this.persistence);return new _0(e.asyncQueue,s)}gc(e){const n=lE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?st.withCacheSize(this.cacheSizeBytes):st.DEFAULT;return new xc(this.synchronizeTabs,n,e.clientId,s,e.asyncQueue,EE(),Oi(),this.It,this.sharedClientState,!!this.forceOwnership)}mc(e){return new Em}}class $m{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Qh(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=sT.bind(null,this.syncEngine),await FE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new BE}createDatastore(e){const n=zo(e.databaseInfo.databaseId),s=(r=e.databaseInfo,new IE(r));var r;return function(i,o,a,u){return new xE(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return n=this.localStore,s=this.datastore,r=e.asyncQueue,i=a=>Qh(this.syncEngine,a,0),o=Gh.C()?new Gh:new vE,new SE(n,s,r,i,o);var n,s,r,i,o}createSyncEngine(e,n){return function(s,r,i,o,a,u,c){const l=new WE(s,r,i,o,a,u);return c&&(l.fc=!0),l}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=z(e);_("RemoteStore","RemoteStore shutting down."),n._u.add(5),await ni(n),n.mu.shutdown(),n.gu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ac(this.observer.next,e)}error(e){this.observer.error?this.Ac(this.observer.error,e):Ze("Uncaught Error in snapshot listener:",e)}Rc(){this.muted=!0}Ac(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uT{constructor(e,n,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Je.UNAUTHENTICATED,this.clientId=wp.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{_("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(_("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new R(w.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ft;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=kc(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function Um(t,e){t.asyncQueue.verifyOperationInProgress(),_("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await bm(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function qm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await cT(t);_("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener(r=>zh(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>zh(e.remoteStore,i)),t.onlineComponents=e}async function cT(t){return t.offlineComponents||(_("FirestoreClient","Using default OfflineComponentProvider"),await Um(t,new Bm)),t.offlineComponents}async function jm(t){return t.onlineComponents||(_("FirestoreClient","Using default OnlineComponentProvider"),await qm(t,new $m)),t.onlineComponents}function lT(t){return jm(t).then(e=>e.syncEngine)}async function hT(t){const e=await jm(t),n=e.eventManager;return n.onListen=QE.bind(null,e.syncEngine),n.onUnlisten=XE.bind(null,e.syncEngine),n}function dT(t,e,n={}){const s=new Ft;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,u){const c=new aT({next:h=>{i.enqueueAndForget(()=>UE(r,l)),h.fromCache&&a.source==="server"?u.reject(new R(w.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),l=new KE(o,c,{includeMetadataChanges:!0,Nu:!0});return $E(r,l)}(await hT(t),t.asyncQueue,e,n,s)),s.promise}const Xh=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Km(t,e,n){if(!n)throw new R(w.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function fT(t,e,n,s){if(e===!0&&s===!0)throw new R(w.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Jh(t){if(!N.isDocumentKey(t))throw new R(w.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Zh(t){if(N.isDocumentKey(t))throw new R(w.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Rc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":P()}function rs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new R(w.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Rc(t);throw new R(w.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new R(w.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new R(w.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,fT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ed({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new R(w.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new R(w.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ed(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new d0;switch(n.type){case"gapi":const s=n.client;return new m0(s,n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new R(w.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=Xh.get(e);n&&(_("ComponentProvider","Removing Datastore"),Xh.delete(e),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ln(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ht(this.firestore,e,this._key)}}class Qo{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Qo(this.firestore,e,this._query)}}class ln extends Qo{constructor(e,n,s){super(e,n,gc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ht(this.firestore,null,new N(e))}withConverter(e){return new ln(this.firestore,e,this._path)}}function pT(t,e,...n){if(t=fn(t),Km("collection","path",e),t instanceof Lc){const s=ce.fromString(e,...n);return Zh(s),new ln(t,null,s)}{if(!(t instanceof ht||t instanceof ln))throw new R(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(ce.fromString(e,...n));return Zh(s),new ln(t.firestore,null,s)}}function Pc(t,e,...n){if(t=fn(t),arguments.length===1&&(e=wp.R()),Km("doc","path",e),t instanceof Lc){const s=ce.fromString(e,...n);return Jh(s),new ht(t,null,new N(s))}{if(!(t instanceof ht||t instanceof ln))throw new R(w.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(ce.fromString(e,...n));return Jh(s),new ht(t.firestore,t instanceof ln?t.converter:null,new N(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(){this.$c=Promise.resolve(),this.Bc=[],this.Lc=!1,this.Uc=[],this.qc=null,this.Kc=!1,this.Gc=!1,this.Qc=[],this.xo=new Tm(this,"async_queue_retry"),this.jc=()=>{const n=Oi();n&&_("AsyncQueue","Visibility state changed to "+n.visibilityState),this.xo.bo()};const e=Oi();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.jc)}get isShuttingDown(){return this.Lc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Wc(),this.zc(e)}enterRestrictedMode(e){if(!this.Lc){this.Lc=!0,this.Gc=e||!1;const n=Oi();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.jc)}}enqueue(e){if(this.Wc(),this.Lc)return new Promise(()=>{});const n=new Ft;return this.zc(()=>this.Lc&&this.Gc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Bc.push(e),this.Hc()))}async Hc(){if(this.Bc.length!==0){try{await this.Bc[0](),this.Bc.shift(),this.xo.reset()}catch(e){if(!In(e))throw e;_("AsyncQueue","Operation failed with retryable error: "+e)}this.Bc.length>0&&this.xo.Ao(()=>this.Hc())}}zc(e){const n=this.$c.then(()=>(this.Kc=!0,e().catch(s=>{this.qc=s,this.Kc=!1;const r=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(s);throw Ze("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.Kc=!1,s))));return this.$c=n,n}enqueueAfterDelay(e,n,s){this.Wc(),this.Qc.indexOf(e)>-1&&(n=0);const r=Nc.createAndSchedule(this,e,n,s,i=>this.Jc(i));return this.Uc.push(r),r}Wc(){this.qc&&P()}verifyOperationInProgress(){}async Yc(){let e;do e=this.$c,await e;while(e!==this.$c)}Xc(e){for(const n of this.Uc)if(n.timerId===e)return!0;return!1}Zc(e){return this.Yc().then(()=>{this.Uc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.Uc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Yc()})}ta(e){this.Qc.push(e)}Jc(e){const n=this.Uc.indexOf(e);this.Uc.splice(n,1)}}class ii extends Lc{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new mT,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Hm(this),this._firestoreClient.terminate()}}function oi(t,e){const n=typeof t=="object"?t:Zw(),s=typeof t=="string"?t:e||"(default)";return Ww(n,"firestore").getImmediate({identifier:s})}function Fc(t){return t._firestoreClient||Hm(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Hm(t){var e;const n=t._freezeSettings(),s=function(r,i,o,a){return new S0(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new uT(t._authCredentials,t._appCheckCredentials,t._queue,s)}function gT(t,e){vT(t=rs(t,ii));const n=Fc(t),s=t._freezeSettings(),r=new $m;return yT(n,r,new oT(r,s.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function yT(t,e,n){const s=new Ft;return t.asyncQueue.enqueue(async()=>{try{await Um(t,n),await qm(t,e),s.resolve()}catch(r){const i=r;if(!function(o){return o.name==="FirebaseError"?o.code===w.FAILED_PRECONDITION||o.code===w.UNIMPLEMENTED:typeof DOMException<"u"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(i))throw i;cu("Error enabling offline persistence. Falling back to persistence disabled: "+i),s.reject(i)}}).then(()=>s.promise)}function vT(t){if(t._initialized||t._terminated)throw new R(w.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new R(w.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Se(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vs(Pe.fromBase64String(e))}catch(n){throw new R(w.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Vs(Pe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new R(w.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new R(w.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT=/^__.*__$/;class bT{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new zt(e,this.data,this.fieldMask,n,this.fieldTransforms):new zs(e,this.data,n,this.fieldTransforms)}}class Gm{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new zt(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function zm(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw P()}}class $c{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.It=s,this.ignoreUndefinedProperties=r,i===void 0&&this.ea(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get na(){return this.settings.na}sa(e){return new $c(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ia(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.sa({path:s,ra:!1});return r.oa(e),r}ua(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.sa({path:s,ra:!1});return r.ea(),r}ca(e){return this.sa({path:void 0,ra:!0})}aa(e){return ao(e,this.settings.methodName,this.settings.ha||!1,this.path,this.settings.la)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}ea(){if(this.path)for(let e=0;e<this.path.length;e++)this.oa(this.path.get(e))}oa(e){if(e.length===0)throw this.aa("Document fields must not be empty");if(zm(this.na)&&wT.test(e))throw this.aa('Document fields cannot begin and end with "__"')}}class IT{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.It=s||zo(e)}fa(e,n,s,r=!1){return new $c({na:e,methodName:n,la:s,path:Se.emptyPath(),ra:!1,ha:r},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Wm(t){const e=t._freezeSettings(),n=zo(t._databaseId);return new IT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ET(t,e,n,s,r,i={}){const o=t.fa(i.merge||i.mergeFields?2:0,e,n,r);Uc("Data must be an object, but it was:",o,s);const a=Qm(s,o);let u,c;if(i.merge)u=new ct(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const l=[];for(const h of i.mergeFields){const f=Iu(e,h,n);if(!o.contains(f))throw new R(w.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);Xm(l,f)||l.push(f)}u=new ct(l),c=o.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,c=o.fieldTransforms;return new bT(new ze(a),u,c)}class Xo extends Vc{_toFieldTransform(e){if(e.na!==2)throw e.na===1?e.aa(`${this._methodName}() can only appear at the top level of your update data`):e.aa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xo}}function TT(t,e,n,s){const r=t.fa(1,e,n);Uc("Data must be an object, but it was:",r,s);const i=[],o=ze.empty();as(s,(u,c)=>{const l=qc(e,u,n);c=fn(c);const h=r.ua(l);if(c instanceof Xo)i.push(l);else{const f=Jo(c,h);f!=null&&(i.push(l),o.set(l,f))}});const a=new ct(i);return new Gm(o,a,r.fieldTransforms)}function _T(t,e,n,s,r,i){const o=t.fa(1,e,n),a=[Iu(e,s,n)],u=[r];if(i.length%2!=0)throw new R(w.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(Iu(e,i[f])),u.push(i[f+1]);const c=[],l=ze.empty();for(let f=a.length-1;f>=0;--f)if(!Xm(c,a[f])){const m=a[f];let v=u[f];v=fn(v);const D=o.ua(m);if(v instanceof Xo)c.push(m);else{const x=Jo(v,D);x!=null&&(c.push(m),l.set(m,x))}}const h=new ct(c);return new Gm(l,h,o.fieldTransforms)}function Jo(t,e){if(Ym(t=fn(t)))return Uc("Unsupported field value:",e,t),Qm(t,e);if(t instanceof Vc)return function(n,s){if(!zm(s.na))throw s.aa(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.aa(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.ra&&e.na!==4)throw e.aa("Nested arrays are not supported");return function(n,s){const r=[];let i=0;for(const o of n){let a=Jo(o,s.ca(i));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(t,e)}return function(n,s){if((n=fn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return z0(s.It,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Te.fromDate(n);return{timestampValue:jr(s.It,r)}}if(n instanceof Te){const r=new Te(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:jr(s.It,r)}}if(n instanceof Bc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Vs)return{bytesValue:Qp(s.It,n._byteString)};if(n instanceof ht){const r=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(r))throw s.aa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:wc(n.firestore._databaseId||s.databaseId,n._key.path)}}throw s.aa(`Unsupported field value: ${Rc(n)}`)}(t,e)}function Qm(t,e){const n={};return xp(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):as(t,(s,r)=>{const i=Jo(r,e.ia(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function Ym(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Te||t instanceof Bc||t instanceof Vs||t instanceof ht||t instanceof Vc)}function Uc(t,e,n){if(!Ym(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const s=Rc(n);throw s==="an object"?e.aa(t+" a custom object"):e.aa(t+" "+s)}}function Iu(t,e,n){if((e=fn(e))instanceof Yo)return e._internalPath;if(typeof e=="string")return qc(t,e);throw ao("Field path arguments must be of type string or ",t,!1,void 0,n)}const xT=new RegExp("[~\\*/\\[\\]]");function qc(t,e,n){if(e.search(xT)>=0)throw ao(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Yo(...e.split("."))._internalPath}catch{throw ao(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function ao(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${s}`),o&&(u+=` in document ${r}`),u+=")"),new R(w.INVALID_ARGUMENT,a+t+u)}function Xm(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ht(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new CT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Zm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class CT extends Jm{data(){return super.data()}}function Zm(t,e){return typeof e=="string"?qc(t,e):e instanceof Yo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ST extends Jm{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ri(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Zm("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class Ri extends ST{data(e={}){return super.data(e)}}class DT{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new Ei(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new Ri(this._firestore,this._userDataWriter,s.key,s,new Ei(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new R(w.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>({type:"added",doc:new Ri(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ei(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:i++}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new Ri(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ei(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,c=-1;return o.type!==0&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),c=i.indexOf(o.doc.key)),{type:AT(o.type),doc:a,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function AT(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return P()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new R(w.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{convertValue(e,n="none"){switch(Zn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Xn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw P()}}convertObject(e,n){const s={};return as(e.fields,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertGeoPoint(e){return new Bc(xe(e.latitude),xe(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=Sp(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Pr(e));default:return null}}convertTimestamp(e){const n=pn(e);return new Te(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=ce.fromString(e);G(sm(s));const r=new Jn(s.get(1),s.get(3)),i=new N(s.popFirst(5));return r.isEqual(n)||Ze(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class OT extends kT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ht(this.firestore,null,n)}}function RT(t){t=rs(t,Qo);const e=rs(t.firestore,ii),n=Fc(e),s=new OT(e);return NT(t._query),dT(n,t._query).then(r=>new DT(e,s,t,r))}function LT(t,e,n){t=rs(t,ht);const s=rs(t.firestore,ii),r=MT(t.converter,e,n);return tg(s,[ET(Wm(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,rt.none())])}function eg(t,e,n,...s){t=rs(t,ht);const r=rs(t.firestore,ii),i=Wm(r);let o;return o=typeof(e=fn(e))=="string"||e instanceof Yo?_T(i,"updateDoc",t._key,e,n,s):TT(i,"updateDoc",t._key,e),tg(r,[o.toMutation(t._key,rt.exists(!0))])}function tg(t,e){return function(n,s){const r=new Ft;return n.asyncQueue.enqueueAndForget(async()=>JE(await lT(n),s,r)),r.promise}(Fc(t),e)}(function(t,e=!0){(function(n){Gs=n})(Xw),Ki(new Dr("firestore",(n,{instanceIdentifier:s,options:r})=>{const i=n.getProvider("app").getImmediate(),o=new ii(new f0(n.getProvider("auth-internal")),new y0(n.getProvider("app-check-internal")),function(a,u){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new R(w.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jn(a.options.projectId,u)}(i,s),i);return r=Object.assign({useFetchStreams:e},r),o._setSettings(r),o},"PUBLIC").setMultipleInstances(!0)),Cs(sh,"3.5.0",t),Cs(sh,"3.5.0","esm2017")})();gT(oi()).catch(t=>{t.code=="failed-precondition"||t.code=="unimplemented"});let jc=ju({duration:1500,position:"top"});const uo=ue([]),Oe=$n(()=>uo.value);async function Kc(){const t=[];(await RT(pT(oi(),"Vokabeln"))).forEach(n=>{t.push(n)}),uo.value=t.map(n=>({...n.data()}))}async function PT(t,e){if(uo.value.findIndex(n=>n.german.value===t)===-1){const n={id:Math.random()+"",german:{timesAsked:0,timesCorrect:0,value:t},swedish:{timesAsked:0,timesCorrect:0,value:e}};try{const s=await LT(Pc(oi(),"Vokabeln",n.id),n);return uo.value.push(n),!0}catch(s){return jc.error("<b>Saving your data is creating an error!</b>"),console.error(s),!1}}else return!1}async function ng(t,e,n,s){let r=0,i=JSON.parse(JSON.stringify(t));if(i){i[e].timesAsked+=1,s===i[n].value&&(r=1,i[e].timesCorrect+=1);try{await eg(Pc(oi(),"Vokabeln",i.id),i)}catch(o){jc.error("<b>Checking created an error!</b>"),console.error(o)}Kc()}return r}async function FT(){let t=Oe.value;try{for(let e of t)e.german.timesAsked=0,e.swedish.timesAsked=0,e.german.timesCorrect=0,e.swedish.timesCorrect=0,await eg(Pc(oi(),"Vokabeln",e.id),e);Kc()}catch(e){jc.error("<b>Resetting your statistics is creating an error!</b>"),console.error(e)}}const sg="/Vokabeltrainer/moose.png",VT=t=>(yn("data-v-c0da6c64"),t=t(),vn(),t),BT=VT(()=>T("img",{src:sg,alt:"Moose",class:"mooseImg"},null,-1)),$T=[BT],UT=Dt({__name:"HomeButton",setup(t){return(e,n)=>(ie(),ke("button",{class:"backHomeButtonCSS",onMousedown:n[0]||(n[0]=s=>j(Un)("home"))},$T,32))}});const qT=At(UT,[["__scopeId","data-v-c0da6c64"]]),As=ue(!1),Li=ue(0),Eu=ue(0),dr=ue(!1),Hc=t=>(yn("data-v-1eb88d61"),t=t(),vn(),t),jT=Hc(()=>T("header",null,[T("h1",{class:"homeH1"},"Vokabeltrainer"),T("div",{class:"mooseDiv"},[T("img",{src:sg,alt:"Moose",class:"mooseImg"})])],-1)),KT=Hc(()=>T("nav",null,null,-1)),HT=Hc(()=>T("footer",null,null,-1)),GT=Dt({__name:"HomeScreen",setup(t){return As.value=!1,(e,n)=>(ie(),ke(ve,null,[jT,KT,T("main",null,[T("button",{class:"button",onClick:n[0]||(n[0]=s=>j(Un)("trainingStart"))}," Training "),T("button",{class:"button",onClick:n[1]||(n[1]=s=>j(Un)("teststart"))},"Test"),T("button",{class:"button",onClick:n[2]||(n[2]=s=>j(Un)("vokabellisteSuche"))}," Vokabelliste "),T("button",{class:"button",onClick:n[3]||(n[3]=s=>j(Un)("statistik"))},"Statistik")]),HT],64))}});const zT=At(GT,[["__scopeId","data-v-1eb88d61"]]),Zo="/Vokabeltrainer/germany.png",ea="/Vokabeltrainer/sweden.png",WT={class:"searchedVocabulary"},QT={class:"answerOptions"},YT=["onClick","disabled"],XT=Dt({__name:"Test",props:{language:null},setup(t){const e=t,n=ue(!1),{language:s}=_d(e),r=Kr(()=>s.value==="german"?"swedish":"german"),i=ue([]),o=ue([]),a=ue(null),u=ue(null),c=ue(),l=ue(),h=ue();Li.value=0,Eu.value=0;function f(){c.value=Oe.value[Math.floor(Math.random()*Oe.value.length)];do l.value=Oe.value[Math.floor(Math.random()*Oe.value.length)],h.value=Oe.value[Math.floor(Math.random()*Oe.value.length)];while(c.value.german.value===l.value.german.value||c.value.german.value===h.value.german.value||l.value.german.value===h.value.german.value);i.value=[],i.value.push(c.value[r.value].value,l.value[r.value].value,h.value[r.value].value),o.value=i.value.shuffle()}f();async function m(){if(!c.value||typeof a.value!="number")return;let v=o.value[a.value];u.value=await ng(c.value,s.value,r.value,v),Li.value+=1,a.value!==null&&o.value[a.value]===c.value[r.value].value&&(Eu.value+=1),n.value=!0,setTimeout(()=>{f(),n.value=!1,a.value=null,u.value=null,Li.value===100&&(As.value=!0)},1200)}return(v,D)=>{var x;return ie(),ke(ve,null,[T("div",WT,$e((x=c.value)==null?void 0:x[j(s)].value),1),T("div",QT,[(ie(!0),ke(ve,null,Vu(o.value,(M,W)=>{var V;return ie(),ke("button",{onClick:Q=>(a.value=W,m()),class:Bs([{selected:a.value===W},{true:u.value!==null&&M===((V=c.value)==null?void 0:V[j(r)].value)},{false:u.value===0&&a.value===W}]),disabled:n.value},$e(M),11,YT)}),256))])],64)}}});const JT=At(XT,[["__scopeId","data-v-e35d8d9b"]]),ZT=t=>(yn("data-v-969437ed"),t=t(),vn(),t),e_=ZT(()=>T("h2",null,"Test abgeschlossen!",-1)),t_={class:"buttonDiv"},n_=Dt({__name:"TestEnde",setup(t){function e(){dr.value=!1,As.value=!1}return(n,s)=>(ie(),ke(ve,null,[e_,T("h3",null," Du hast "+$e(j(Eu))+" von "+$e(j(Li))+" Fragen richtig beantwortet. ",1),T("div",t_,[T("button",{class:"button",onClick:s[0]||(s[0]=r=>(e(),j(Un)("teststart")))}," Wiederholen ")])],64))}});const s_=At(n_,[["__scopeId","data-v-969437ed"]]),Gc=t=>(yn("data-v-ce1c158d"),t=t(),vn(),t),r_=Gc(()=>T("h1",{class:"notHomeH1"},"Test",-1)),i_={key:0},o_=Gc(()=>T("div",{class:"erkl\xE4rungsText"},[T("p",null,[Si(" Es werden 100 Vokabeln abgefragt. "),T("br"),Si(" Zum bestehen d\xFCrfen nicht mehr als 5 Vokabeln falsch beantwortet werden."),T("br"),Si(" Viel Erfolg! ")])],-1)),a_=Gc(()=>T("h3",{class:"languageSelect"},"W\xE4hle eine Sprache:",-1)),u_={class:"flagsDiv"},c_={class:"flagsButtons"},l_={class:"flagsButtons"},h_={class:"startButtonDiv"},d_=["disabled"],f_=Dt({__name:"TestStart",setup(t){dr.value=!1;const e=ue(""),n=Kr(()=>e.value==="");return(s,r)=>(ie(),ke(ve,null,[r_,!j(dr)&&!j(As)?(ie(),ke("div",i_,[o_,a_,T("div",u_,[T("button",c_,[T("img",{src:Zo,alt:"germany",class:"flags",onClick:r[0]||(r[0]=i=>e.value="german")})]),T("button",l_,[T("img",{src:ea,alt:"sweden",class:"flags",onClick:r[1]||(r[1]=i=>e.value="swedish")})])]),T("div",h_,[T("button",{class:"startButton",disabled:j(n),onClick:r[2]||(r[2]=i=>dr.value=!0)}," Start ",8,d_)])])):vt("",!0),j(dr)&&e.value&&!j(As)?(ie(),yt(JT,{key:1,language:e.value},null,8,["language"])):vt("",!0),j(As)?(ie(),yt(s_,{key:2})):vt("",!0)],64))}});const p_=At(f_,[["__scopeId","data-v-ce1c158d"]]),m_={class:"searchedVocabulary"},g_={class:"answerOptions"},y_=["onClick","disabled"],v_=Dt({__name:"Training",props:{language:null},setup(t){const e=t,n=ue(!1),{language:s}=_d(e),r=Kr(()=>s.value==="german"?"swedish":"german"),i=ue([]),o=ue([]),a=ue(null),u=ue(null),c=ue(),l=ue(),h=ue();function f(){c.value=Oe.value[Math.floor(Math.random()*Oe.value.length)];do l.value=Oe.value[Math.floor(Math.random()*Oe.value.length)],h.value=Oe.value[Math.floor(Math.random()*Oe.value.length)];while(c.value.german.value===l.value.german.value||c.value.german.value===h.value.german.value||l.value.german.value===h.value.german.value);i.value=[],i.value.push(c.value[r.value].value,l.value[r.value].value,h.value[r.value].value),o.value=i.value.shuffle()}f();async function m(){if(!c.value||typeof a.value!="number")return;let v=o.value[a.value];u.value=await ng(c.value,s.value,r.value,v),n.value=!0,setTimeout(()=>{f(),n.value=!1,a.value=null,u.value=null},1200)}return(v,D)=>{var x;return ie(),ke(ve,null,[T("div",m_,$e((x=c.value)==null?void 0:x[j(s)].value),1),T("div",g_,[(ie(!0),ke(ve,null,Vu(o.value,(M,W)=>{var V;return ie(),ke("button",{onClick:Q=>(a.value=W,m()),class:Bs([{selected:a.value===W},{true:u.value!==null&&M===((V=c.value)==null?void 0:V[j(r)].value)},{false:u.value===0&&a.value===W}]),disabled:n.value},$e(M),11,y_)}),256))])],64)}}});const w_=At(v_,[["__scopeId","data-v-d5bedfb7"]]),rg=t=>(yn("data-v-4a0a3e9f"),t=t(),vn(),t),b_=rg(()=>T("h1",{class:"notHomeH1"},"Training",-1)),I_={key:0},E_=rg(()=>T("h3",{class:"languageSelect"},"W\xE4hle eine Sprache:",-1)),T_={class:"flagsDiv"},__={class:"flagsButtons"},x_={class:"flagsButtons"},C_={class:"startButtonDiv"},S_=["disabled"],D_=Dt({__name:"TrainingStart",setup(t){const e=ue(!1),n=ue(""),s=Kr(()=>n.value==="");return(r,i)=>(ie(),ke(ve,null,[b_,e.value?vt("",!0):(ie(),ke("div",I_,[E_,T("div",T_,[T("button",__,[T("img",{src:Zo,alt:"germany",class:"flags",onClick:i[0]||(i[0]=o=>n.value="german")})]),T("button",x_,[T("img",{src:ea,alt:"sweden",class:"flags",onClick:i[1]||(i[1]=o=>n.value="swedish")})])]),T("div",C_,[T("button",{class:"startButton",disabled:j(s),onClick:i[2]||(i[2]=o=>e.value=!0)}," Start ",8,S_)])])),e.value&&n.value?(ie(),yt(w_,{key:1,language:n.value},null,8,["language"])):vt("",!0)],64))}});const A_=At(D_,[["__scopeId","data-v-4a0a3e9f"]]),cs=t=>(yn("data-v-a69dc302"),t=t(),vn(),t),N_=cs(()=>T("h1",{class:"notHomeH1"},"Vokabelliste",-1)),k_=cs(()=>T("div",{class:"addVocabularyDiv"},"Vokabel hinzuf\xFCgen:",-1)),M_={class:"textInputDiv"},O_=cs(()=>T("img",{src:Zo,alt:"germany",class:"flagsBefore"},null,-1)),R_=cs(()=>T("img",{src:Zo,alt:"germany",class:"flagsEnd"},null,-1)),L_={class:"textInputDiv"},P_=cs(()=>T("img",{src:ea,alt:"sweden",class:"flagsBefore"},null,-1)),F_=cs(()=>T("img",{src:ea,alt:"sweden",class:"flagsEnd"},null,-1)),V_=cs(()=>T("button",{class:"addVocabularyButton"},"Hinzuf\xFCgen",-1)),B_=Dt({__name:"VokabellisteHinzuf\xFCgen",setup(t){let e=ju({duration:1500,position:"top"});const n=ue(""),s=ue("");async function r(){await PT(n.value,s.value)?e.success(`<b>${n.value} : ${s.value}</b> wurde hinzugef\xFCgt!`):alert(`You already added ${n.value} or Your Database has been corrupted! Zwinkersmiley!`),n.value="",s.value=""}return(i,o)=>(ie(),ke(ve,null,[N_,k_,T("form",{onSubmit:o[2]||(o[2]=Nv(a=>r(),["prevent"]))},[T("div",M_,[O_,$i(T("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>n.value=a),type:"text",id:"inputDeutsch",name:"\u{1F50D}",class:"textInput",placeholder:"Deutsche Bedeutung...",required:""},null,512),[[ja,n.value]]),R_]),T("div",L_,[P_,$i(T("input",{"onUpdate:modelValue":o[1]||(o[1]=a=>s.value=a),type:"text",id:"inputSchwedisch",name:"\u{1F50D}",class:"textInput",placeholder:"Schwedische Bedeutung...",required:""},null,512),[[ja,s.value]]),F_]),V_],32)],64))}});const $_=At(B_,[["__scopeId","data-v-a69dc302"]]),zc=t=>(yn("data-v-cc84b558"),t=t(),vn(),t),U_=zc(()=>T("h1",{class:"notHomeH1"},"Vokabelliste",-1)),q_={class:"textInputDiv"},j_={class:"vocabularyList"},K_=zc(()=>T("div",{class:"vocabularyListHeadline"},[T("span",null,"Deutsch"),T("span",null,"Schwedisch")],-1)),H_=zc(()=>T("hr",null,null,-1)),G_={class:"vocabularyListWrap"},z_={class:"vocabularyListGrid"},W_={class:"span"},Q_={class:"span"},Y_=Dt({__name:"VokabellisteSuche",setup(t){const e=ue(""),n=$n(()=>Oe.value.filter(s=>s.german.value.toLowerCase().includes(e.value.toLowerCase())||s.swedish.value.toLowerCase().includes(e.value.toLowerCase())));return ue(""),ue(""),(s,r)=>(ie(),ke(ve,null,[U_,T("div",q_,[$i(T("input",{type:"text",id:"inputVok",class:"textInput",placeholder:"\u{1F50D} Vokabel suchen...",required:"","onUpdate:modelValue":r[0]||(r[0]=i=>e.value=i)},null,512),[[ja,e.value]])]),T("div",j_,[K_,H_,T("div",G_,[T("div",z_,[(ie(!0),ke(ve,null,Vu(j(n),i=>(ie(),ke(ve,{key:i.german.value},[T("span",W_,$e(`${i.german.value}`),1),T("span",Q_,$e(`${i.swedish.value}`),1)],64))),128))])])]),T("button",{class:"addVocabularyButton",onClick:r[1]||(r[1]=i=>j(Un)("vokabellisteHinzuf\xFCgen"))}," + ")],64))}});const X_=At(Y_,[["__scopeId","data-v-cc84b558"]]),Wt=t=>(yn("data-v-571e13ce"),t=t(),vn(),t),J_=Wt(()=>T("h1",{class:"notHomeH1"},"Statistik",-1)),Z_=Wt(()=>T("h2",null,"Beantwortete Vokabeln:",-1)),ex={class:"asked"},tx=Wt(()=>T("h3",null,"Insgesamt",-1)),nx=Wt(()=>T("h3",null,"Deutsch",-1)),sx=Wt(()=>T("h3",null,"Schwedisch",-1)),rx=Wt(()=>T("h2",null,"Verh\xE4ltnis richtig zu falsch:",-1)),ix={class:"ratio"},ox={class:"right"},ax=Wt(()=>T("h3",null,"Insgesamt",-1)),ux={class:"wrong"},cx={class:"right"},lx=Wt(()=>T("h3",null,"Deutsch",-1)),hx={class:"wrong"},dx={class:"right"},fx=Wt(()=>T("h3",null,"Schwedisch",-1)),px={class:"wrong"},mx={class:"reset"},gx=Dt({__name:"Statistik",setup(t){const e=$n(()=>Oe.value.reduce((o,a)=>o+a.german.timesAsked,0)),n=$n(()=>Oe.value.reduce((o,a)=>o+a.swedish.timesAsked,0)),s=$n(()=>Oe.value.reduce((o,a)=>o+a.german.timesCorrect,0)),r=$n(()=>Oe.value.reduce((o,a)=>o+a.swedish.timesCorrect,0));async function i(){await FT()}return(o,a)=>(ie(),ke(ve,null,[J_,Z_,T("div",ex,[tx,T("h3",null,$e(j(e)+j(n)),1),nx,T("h3",null,$e(j(e)),1),sx,T("h3",null,$e(j(n)),1)]),rx,T("div",ix,[T("h3",ox,$e(j(s)+j(r)),1),ax,T("h3",ux,$e(j(e)-j(s)+(j(n)-j(r))),1),T("h3",cx,$e(j(s)),1),lx,T("h3",hx,$e(j(e)-j(s)),1),T("h3",dx,$e(j(r)),1),fx,T("h3",px,$e(j(n)-j(r)),1)]),T("div",mx,[T("button",{class:"resetButton",onClick:a[0]||(a[0]=u=>i())},"Statistik zur\xFCcksetzen")])],64))}});const yx=At(gx,[["__scopeId","data-v-571e13ce"]]),vx=Dt({__name:"App",setup(t){return(async()=>await Kc())(),(e,n)=>(ie(),ke(ve,null,[j(tn).route!=="home"?(ie(),yt(qT,{key:0})):vt("",!0),j(tn).route==="home"?(ie(),yt(zT,{key:1})):vt("",!0),j(tn).route==="trainingStart"?(ie(),yt(A_,{key:2})):vt("",!0),j(tn).route==="teststart"?(ie(),yt(p_,{key:3})):vt("",!0),j(tn).route==="vokabellisteHinzuf\xFCgen"?(ie(),yt($_,{key:4})):vt("",!0),j(tn).route==="vokabellisteSuche"?(ie(),yt(X_,{key:5})):vt("",!0),j(tn).route==="statistik"?(ie(),yt(yx,{key:6})):vt("",!0)],64))}});var wx="firebase",bx="9.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cs(wx,bx,"app");Object.defineProperty(Array.prototype,"shuffle",{value:function(){let t=[...this];for(let e=0;e<t.length-1;e++){let n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}});const Ix={apiKey:"AIzaSyBCYo7DrxX840sDbRKv0jJYg7LwLIf9imQ",authDomain:"vokabeltrainer-43fe7.firebaseapp.com",projectId:"vokabeltrainer-43fe7",storageBucket:"vokabeltrainer-43fe7.appspot.com",messagingSenderId:"281835588906",appId:"1:281835588906:web:303aa72d9836e4a63e6253"};Jw(Ix);Ov(vx).mount("#app");
